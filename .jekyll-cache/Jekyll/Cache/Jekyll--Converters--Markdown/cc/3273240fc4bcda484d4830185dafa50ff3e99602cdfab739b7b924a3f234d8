I"R®<h2 id="ê³¼ëŒ€ì í•©ì„-ê°ì†Œì‹œí‚¤ëŠ”-ë°©ë²•-ê·œì œregularization">ê³¼ëŒ€ì í•©ì„ ê°ì†Œì‹œí‚¤ëŠ” ë°©ë²•: ê·œì œ(Regularization)</h2>

<ul>
  <li>
    <dl>
      <dt>ì£¼ì–´ì§„ í•™ìŠµëª¨ë¸ì˜ ê³¼ëŒ€ì í•©ì„ ê°ì†Œì‹œí‚¤ëŠ” ë°©ë²•</dt>
      <dd>
        <p>ëª¨ë¸ì˜ ë³µì¡ë„ë¥¼ ì¤„ì´ëŠ” ê²ƒ(ë‹¤í•­íšŒê·€ì˜ ê²½ìš° ë‹¤í•­ì‹ ì°¨ìˆ˜ë¥¼ ê°ì†Œ)</p>
      </dd>
    </dl>
  </li>
  <li>
    <p>ì„ í˜•íšŒê·€ ëª¨ë¸ì—ì„œëŠ” ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ë¥¼ ì œí•œí•¨ìœ¼ë¡œì¨ ê·œì œë¥¼ ê°€í•´ ê³¼ëŒ€ì í•©ì„ ê°ì†Œì‹œí‚¬ ìˆ˜ ìˆìŒ</p>
  </li>
  <li>ì†ì‹¤í•¨ìˆ˜ RSS$(\theta)$ì— ê·œì œí•­(regularization term)ì„ ì¶”ê°€í•œ ì†ì‹¤í•¨ìˆ˜ $J(\theta)$ê°€ ìµœì†Œê°€ ë˜ëŠ” ëª¨ë¸ íŒŒë¼ë¯¸í„° $\theta$ë¥¼ êµ¬í•¨ : ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ê°€ ê°€ëŠ¥í•œ í•œ ì‘ê²Œ ìœ ì§€ë˜ë©´ì„œ í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì´ ë°ì´í„°ì— ë§ì¶”ë„ë¡ í•™ìŠµ</li>
</ul>

\[J(\theta)= RSS(\theta)+\alpha(||\mathbf w||_p)^p (\alpha &gt;0)
=\text{RSS}(\theta ) + \alpha\ \sum_{i=1}^n |\theta_i|^p 
\cdots\cdots (1)\]

<p>(ë‹¨, ëª¨ë¸ íŒŒë¼ë¯¸í„° ${\theta}=(\theta_0,\theta_1,\cdots,\theta_n)^{\rm T}$ì—ì„œ $\theta_0$ëŠ” ì ˆí¸, $\mathbf w=(\theta_1,\cdots,\theta_n)^{\rm T}$ëŠ” ê°€ì¤‘ì¹˜)</p>

<blockquote>
  <ul>
    <li>
      <p>ê·œì œí•­ì€ í•™ìŠµí•˜ëŠ” ë™ì•ˆì—ë§Œ ë¹„ìš©í•¨ìˆ˜ì— ì¶”ê°€ë˜ê³ , ì„±ëŠ¥ì„ í‰ê°€í•  ë•ŒëŠ” MSEë¡œë§Œ í‰ê°€</p>
    </li>
    <li>
      <p>$\alpha$ëŠ” ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ë¥¼ ì–¼ë§ˆë‚˜ ê·œì œí•  ì§€ ì¡°ì ˆí•˜ëŠ” í•˜ì´í¼íŒŒë¼ë¯¸í„°</p>

      <blockquote>
        <ul>
          <li>$\alpha$=0ëŠ” ê·œì œê°€ ì—†ëŠ” ì„ í˜•íšŒê·€</li>
          <li>$\alpha$ê°€ ì•„ì£¼ í¬ë©´ ëª¨ë“  ê°€ì¤‘ì¹˜ê°€ ê±°ì˜ 0ì— ê°€ê¹Œì›Œì§€ê³ , ê²°êµ­ ë°ì´í„°ì˜ í‰ê· ì„ ì§€ë‚˜ëŠ” ìˆ˜í‰ì„ ì— ê°€ê¹Œì›Œì§</li>
        </ul>
      </blockquote>
    </li>
    <li>
      <p>ê·œì œê°€ ìˆëŠ” ëª¨ë¸ì€ ë°ì´í„°ì˜ ìŠ¤ì¼€ì¼ë§ì´ ê¼­ í•„ìš”í•¨.</p>
    </li>
  </ul>
</blockquote>

<ul>
  <li>
    <p>p=2ì¼ ë•Œ, ì¦‰, íŒ¨ë„í‹°ë¡œ $\ell_2$ ë…¸ë¦„(norm)ì„ ì‚¬ìš©í•  ë•Œ ë¦¿ì§€íšŒê·€ (Ridge Regression)</p>
  </li>
  <li>
    <p>p=1ì¼ ë•Œ, ì¦‰, íŒ¨ë„í‹°ë¡œ $\ell_1$ ë…¸ë¦„(norm)ì„ ì‚¬ìš©í•  ë•Œ ë¼ì˜íšŒê·€ (Lasso Regression)</p>
  </li>
  <li>
    <p>ì—˜ë¼ìŠ¤í‹±ë„·(elastic net): ê·œì œí•­ì„ ë¦¿ì§€íšŒê·€ì˜ ê·œì œí•­ê³¼ ë¼ì˜íšŒê·€ì˜ ê·œì œí•­ì— ëŒ€í•œ ë‚´ë¶„ì ìœ¼ë¡œ ì •ì˜. ì¦‰, $0\le r \le 1$ì— ëŒ€í•´ ë‹¤ìŒê³¼ ê°™ì´ ì†ì‹¤í•¨ìˆ˜ë¥¼ ì •ì˜
\(J( \theta)=\text{RSS}(\theta ) + r(\alpha||\mathbf w||_1 )+(1-r)({\alpha} ||\mathbf w||_2^2)\)</p>
  </li>
</ul>

<p><br /></p>

<h2 id="ë¦¿ì§€-íšŒê·€ridge-regression">ë¦¿ì§€ íšŒê·€(Ridge Regression)</h2>

<ul>
  <li>
    <p>ë¦¿ì§€ íšŒê·€ë¥¼ í•™ìŠµí•˜ê¸° ìœ„í•´ ì •ê·œë°©ì •ì‹ì„ ì´ìš©í•  ìˆ˜ë„ ìˆê³  ê²½ì‚¬í•˜ê°•ë²•ì„ ì´ìš©í•  ìˆ˜ë„ ìˆìŒ</p>
  </li>
  <li>
    <p>ë¦¿ì§€íšŒê·€ì— ëŒ€í•œ ì •ê·œë°©ì •ì‹
\(J(\theta)= RSS(\theta)+\alpha(||\mathbf w||_2)^2 (\alpha &gt;0)
=\text{RSS}(\theta ) + \alpha\ \sum_{i=1}^n |\theta_i|^2\)</p>

    <blockquote>
      <ul>
        <li>
          <p>ìœ„ì˜ ê²½ìš° ì†ì‹¤í•¨ìˆ˜ $J(\theta)$ëŠ” ì•„ë˜ë¡œ ë³¼ë¡í•œ í•¨ìˆ˜(convex function)ì´ ë˜ë¯€ë¡œ $\nabla_{\theta}J(\theta)=\mathbf 0$ì´ ë˜ëŠ” $\theta$ì—ì„œ ìµœì†Œê°€ ëœë‹¤.</p>

          <p>(ë‹¨, (n+1) X (n+1) í–‰ë ¬ $\mathbf A$ëŠ” $A_{11}=0$ì´ê³  $A_{ii}=1\ (1\le i \le n)$ì¸ ëŒ€ê°í–‰ë ¬)</p>
        </li>
        <li>
          <p>$(\mathbf X^{\rm T}\mathbf X+\alpha \mathbf A)\theta = \mathbf X^{\rm T}\mathbf y$ë¡œë¶€í„° $\hat{\theta} = (\mathbf X^{\rm T}\mathbf X +\alpha \mathbf A)^{-1}\mathbf X^{\rm T}\mathbf y$</p>
        </li>
        <li>
          <p>ìœ„ ì‹ì€ í™•ì¥ëœ $m$ê°œì˜ íŠ¹ì„±ë²¡í„° $\mathbf x=(x_0,x_1,\cdots,x_n)^{\rm T}=(1,x_1,\cdots,x_n)^{\rm T}$ë¡œë¶€í„° ìƒì„±ëœ $m\times (n+1)$ í–‰ë ¬ $\mathbf X$ì— ëŒ€í•œ ì‹</p>
        </li>
        <li>
          <p>$x_0=1$ì„ ì¶”ê°€í•˜ì§€ ì•Šì€ mê°œì˜ íŠ¹ì„±ë²¡í„° $\mathbf x$ë¡œë¶€í„° ìƒì„±ëœ $m\times n$ í–‰ë ¬ $\mathbf X$ì™€ í¸í–¥(ì ˆí¸) $\theta_0$ë¥¼ ì œì™¸í•œ ê°€ì¤‘ì¹˜ë¡œë§Œ ì´ë£¨ì–´ì§„ íŒŒë¼ë¯¸í„° $\mathbf w=(\theta_1,\cdots,\theta_n)^{\rm T}$ì— ëŒ€í•œ ì •ê·œë°©ì •ì‹ì€ $\hat {\mathbf w}=(\mathbf X^{\rm T}\mathbf X +\alpha \mathbf I_n)^{-1}\mathbf X^{\rm T}\mathbf y$</p>
        </li>
      </ul>
    </blockquote>
  </li>
</ul>

<blockquote>
  <ul>
    <li>ê·œì œê°€ ì—†ëŠ” ì„ í˜•íšŒê·€ ëª¨ë¸ì—ì„œ ì„¤ëª…í–ˆë“¯ì´ í–‰ë ¬ì— ëŒ€í•œ íŠ¹ì‡ê°’ ë¶„í•´ë¥¼ ì´ìš©í•˜ê±°ë‚˜ ì´ë ˆìŠ¤í‚¤ ë¶„í•´(cholesky decomposition)ì„ ì´ìš©í•˜ì—¬ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ë¹ ë¦„</li>
    <li>ì´ë ˆìŠ¤í‚¤ ë¶„í•´: ì–‘ì˜ ì •ë¶€í˜¸(positive definite)ì¸ ëŒ€ì¹­í–‰ë ¬ $\mathbf A$ë¥¼ í•˜ì‚¼ê°í–‰ë ¬ $\mathbf L$ì„ ì´ìš©í•˜ì—¬ $\mathbf A=\mathbf L\mathbf L^{\rm T}$ì™€ ê°™ì´ ë¶„í•´í•˜ëŠ” ê²ƒ (<a href="https://en.wikipedia.org/wiki/Cholesky_decomposition">ì°¸ê³ ë§í¬</a>)</li>
    <li>sklearn.linear_modelëª¨ë“ˆì˜ Rigdeë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ê¸° ê°ì²´ë¥¼ ìƒì„± (<a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html?highlight=ridge#sklearn.linear_model.Ridge">API</a>): <code class="language-plaintext highlighter-rouge">Ridge</code>ê°ì²´ì˜ ì…ë ¥ ì˜µì…˜ ì¤‘ <code class="language-plaintext highlighter-rouge">solver</code>ì˜ ê¸°ë³¸ê°’ì€ â€˜autoâ€™ì´ê³  â€˜svdâ€™, â€˜choleskyâ€™ ë“±ì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤.</li>
  </ul>
</blockquote>

<ul>
  <li>
    <p>ë¦¿ì§€ íšŒê·€ì— ëŒ€í•œ í™•ë¥ ì  ê²½ì‚¬í•˜ê°•ë²•</p>

    <blockquote>
      <ul>
        <li>sklearn.linear_model ëª¨ë“ˆì˜ SGDRegressorì—ì„œ ì…ë ¥ë³€ìˆ˜ <code class="language-plaintext highlighter-rouge">penalty</code>ë¥¼ â€œl2â€ë¡œ ì§€ì •í•˜ì—¬ ì˜ˆì¸¡ê¸° ê°ì²´ë¥¼ ìƒì„±</li>
        <li>sklearn.linear_model ëª¨ë“ˆì˜ Ridgeì—ì„œ ì…ë ¥ë³€ìˆ˜ <code class="language-plaintext highlighter-rouge">solver</code>ë¥¼ â€œsagâ€ ë˜ëŠ” â€œsagaâ€ë¡œ ì§€ì •í•˜ì—¬ ì˜ˆì¸¡ê¸° ê°ì²´ë¥¼ ìƒì„±</li>
      </ul>
    </blockquote>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ë¦¿ì§€íšŒê·€ python ì˜ˆì‹œ
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDRegressor</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span> 

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">X</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> 
<span class="n">y</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">X</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">X_new</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y_new</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">X_new</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_model_pre</span><span class="p">(</span><span class="n">model_class</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="o">**</span><span class="n">model_kargs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">style</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="p">(</span><span class="s">"b-"</span><span class="p">,</span> <span class="s">"g-"</span><span class="p">,</span> <span class="s">"r-"</span><span class="p">)):</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">model_class</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">model_kargs</span><span class="p">)</span> <span class="k">if</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">LinearRegression</span><span class="p">()</span>
        
        <span class="n">poly_features</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c1">#X0 ì œì™¸
</span>        <span class="n">std_scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
            
        <span class="n">X_poly</span> <span class="o">=</span> <span class="n">poly_features</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">X_poly_scaled</span> <span class="o">=</span> <span class="n">std_scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_poly</span><span class="p">)</span>
        <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_poly_scaled</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        
        <span class="n">y_new_regul</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">std_scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">poly_features</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_new</span><span class="p">)))</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="n">y_new_regul</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s">"$\alpha = {}$"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
        
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">"b."</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span><span class="n">y_new</span><span class="p">,</span> <span class="s">"m."</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="mf">0.3</span><span class="o">*</span><span class="n">X_new</span><span class="p">,</span> <span class="s">"m--"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">"upper left"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"$x_1$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plot_model_pre</span><span class="p">(</span><span class="n">Ridge</span><span class="p">,</span> <span class="n">alphas</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">),</span> <span class="n">solver</span><span class="o">=</span><span class="s">"cholesky"</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"$y$"</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/img/posts/ML8/ridge.png" alt="ridge regression" /></p>

<p><br /></p>

<h3 id="pipeline-í´ë˜ìŠ¤-í™œìš©">Pipeline í´ë˜ìŠ¤ í™œìš©</h3>

<ul>
  <li>ì•ì˜ ì½”ë“œì—ì„œ ë³´ë“¯ì´ ì£¼ì–´ì§„ ì†ì„±ìœ¼ë¡œë¶€í„° ë‹¤í•­ì‹ íŠ¹ì„±ë²¡í„°ë¡œ ë³€í™˜í•˜ê³  scailingì„ ì ìš©í•œ ë‹¤ìŒ ì˜ˆì¸¡ê¸°ì˜ ì…ë ¥ìœ¼ë¡œ ì „ë‹¬í•˜ëŠ” ì¼ë ¨ì˜ ê³¼ì •ì€ ì •í™•í•˜ê³  ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë˜ì–´ì•¼ í•¨.</li>
  <li>ì—°ì†ëœ ë³€í™˜ì„ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬í•˜ë„ë¡ ë„ì™€ì£¼ëŠ” sklearn.pipeline ëª¨ë“ˆì˜ Pipeline í´ë˜ìŠ¤ë¥¼ ì´ìš©í•˜ë©´ í¸ë¦¬í•¨ (<a href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html?highlight=pipeline#sklearn.pipeline.Pipeline">API</a>)</li>
  <li>Pipelineì€ ì—°ì†ëœ ë‹¨ê³„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì´ë¦„/ë³€í™˜ê¸°(ì¶”ì •ê¸°) ìŒì˜ ëª©ë¡ì„ ì…ë ¥ìœ¼ë¡œ ë°›ëŠ”ë°, ë§ˆì§€ë§‰ ë‹¨ê³„ì—ëŠ” <code class="language-plaintext highlighter-rouge">ë³€í™˜ê¸°</code>ì™€ <code class="language-plaintext highlighter-rouge">ì¶”ì •ê¸°</code>ë¥¼ ëª¨ë‘ ì‚¬ìš©í•  ìˆ˜ ìˆê³ , ê·¸ ì™¸ì—ëŠ” ë³€í™˜ê¸°ë§Œ ê°€ëŠ¥</li>
  <li>ì´ë¦„ì€ ë‚˜ì¤‘ì— í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ì¡°ì •í•  ë•Œ ì´ìš©</li>
  <li>Pipelineì˜ <code class="language-plaintext highlighter-rouge">fit()</code> ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ëª¨ë“  ë³€í™˜ê¸°ì˜ <code class="language-plaintext highlighter-rouge">fit_transform()</code>ë©”ì†Œë“œë¥¼ ìˆœì„œëŒ€ë¡œ í˜¸ì¶œí•˜ë©´ì„œ í•´ë‹¹ ë‹¨ê³„ì˜ ì¶œë ¥ì„ ë‹¤ìŒ ë‹¨ê³„ì˜ ì…ë ¥ìœ¼ë¡œ ì „ë‹¬í•˜ê³ , ë§ˆì§€ë§‰ ë‹¨ê³„ì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">fit()</code> ë©”ì†Œë“œë§Œ í˜¸ì¶œí•¨</li>
  <li>Pipelineì˜ ê°ì²´ëŠ” ë§ˆì§€ë§‰ ì¶”ì •ê¸°ì™€ ë™ì¼í•œ ë©”ì†Œë“œë¥¼ ì œê³µí•¨</li>
</ul>

<h3 id="pipeline-í´ë˜ìŠ¤-ì‹¤ìŠµ">Pipeline í´ë˜ìŠ¤ ì‹¤ìŠµ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span> <span class="c1">#Pipeline ë¶ˆëŸ¬ì˜¤ê¸°
</span>
<span class="k">def</span> <span class="nf">plot_model</span><span class="p">(</span><span class="n">model_class</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="o">**</span><span class="n">model_kargs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">style</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="p">(</span><span class="s">"b-"</span><span class="p">,</span> <span class="s">"g-"</span><span class="p">,</span> <span class="s">"r-"</span><span class="p">)):</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">model_class</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">model_kargs</span><span class="p">)</span> <span class="k">if</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">LinearRegression</span><span class="p">()</span>
        
        <span class="n">model</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
                    <span class="p">(</span><span class="s">"poly_features"</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="bp">False</span><span class="p">)),</span>
                    <span class="p">(</span><span class="s">"std_scaler"</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
                    <span class="p">(</span><span class="s">"regul_reg"</span><span class="p">,</span> <span class="n">model</span><span class="p">),</span> 
                <span class="p">])</span> <span class="c1">#ì•ì˜ ì½”ë“œì™€ ê°™ì€ ì½”ë“œì´ë‹¤. Pipeline ì´ìš©í•´ì„œ ì‘ì„±í•  ìˆ˜ ìˆë‹¤. 
</span>        <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">y_new_regul</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="n">y_new_regul</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s">"$\alpha = {}$"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
        
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">"b."</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span><span class="n">y_new</span><span class="p">,</span> <span class="s">"m."</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="mf">0.3</span><span class="o">*</span><span class="n">X_new</span><span class="p">,</span> <span class="s">"m--"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">"upper left"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"$x_1$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plot_model</span><span class="p">(</span><span class="n">Ridge</span><span class="p">,</span> <span class="n">alphas</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"$y$"</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">rcdefaults</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p>ìœ„ì™€ ê°™ì€ ê·¸ë˜í”„ê°€ ê·¸ë ¤ì§„ë‹¤.</p>

<p><br /></p>

<h3 id="ë¦¿ì§€-íšŒê·€ì—ì„œ-ê·œì œ-ì •ë„ë¥¼-ì¡°ì ˆí•˜ëŠ”-í•˜ì´í¼íŒŒë¼ë¯¸í„°">ë¦¿ì§€ íšŒê·€ì—ì„œ ê·œì œ ì •ë„ë¥¼ ì¡°ì ˆí•˜ëŠ” í•˜ì´í¼íŒŒë¼ë¯¸í„°</h3>

<ul>
  <li>
    <p>í•˜ì´í¼ íŒŒë¼ë¯¸í„° $\alpha$ ì˜ ì¡°ì •: êµì°¨ê²€ì¦ì„ í†µí•´</p>
  </li>
  <li>
    <p>sklearn.linear_model ëª¨ë“ˆì˜ RidgeCV í´ë˜ìŠ¤ë¥¼ ì´ìš©í•˜ë©´ ìµœì ì˜ $\alpha$ì— ëŒ€í•œ Ridge ì¶”ì •ê¸°ë¥¼ ì‰½ê²Œ ì–»ì„ ìˆ˜ ìˆìŒ (<a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.RidgeCV.html#sklearn.linear_model.RidgeCV">API</a>)</p>
  </li>
  <li>
    <p>ì„±ëŠ¥í‰ê°€ ê¸°ì¤€ì€ ì…ë ¥ë³€ìˆ˜ <code class="language-plaintext highlighter-rouge">scoring</code>ì— ë¬¸ìì—´ë¡œ ì „ë‹¬</p>

    <blockquote>
      <ul>
        <li>sklearnì—ì„œ scoreëŠ” í° ê°’ì´ ì¢‹ì€ ê²ƒìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆìœ¼ë¯€ë¡œ MSEë¡œ í‰ê°€í•˜ë ¤ë©´ â€˜neg_mean_squared_errorâ€™, R2ë¡œ í‰ê°€í•˜ë ¤ë©´ â€˜r2â€™ë¥¼ ì „ë‹¬</li>
        <li>ê·¸ ì™¸ scoringì— ì „ë‹¬í•  ìˆ˜ ìˆëŠ” ë¬¸ìì—´ê³¼ ëŒ€ì‘ë˜ëŠ” <code class="language-plaintext highlighter-rouge">sklearn.metrics</code> ëª¨ë“ˆì˜ í•¨ìˆ˜ëŠ” ë‹¤ìŒ ë§í¬ì˜ 3.3.1.2ë¥¼ ì°¸ê³  (<a href="https://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter">API</a>)</li>
      </ul>
    </blockquote>

    <ul>
      <li>$\alpha$ ì¡°ì • ì˜ˆì‹œ</li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">my_tr</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
                <span class="p">(</span><span class="s">"poly_features"</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="bp">False</span><span class="p">)),</span> 
                <span class="p">(</span><span class="s">"std_scaler"</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">())])</span>
<span class="n">X_tr</span> <span class="o">=</span> <span class="n">my_tr</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">RidgeCV</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1e2</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">],</span> <span class="n">scoring</span><span class="o">=</span><span class="s">"r2"</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">clf</span><span class="p">.</span><span class="n">alpha_</span>  <span class="c1">#0.1
</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">scoring</span><span class="o">=</span><span class="s">"r2"</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">clf</span><span class="p">.</span><span class="n">alpha_</span>  <span class="c1">#0.5
</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span> <span class="n">scoring</span><span class="o">=</span><span class="s">"r2"</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">clf</span><span class="p">.</span><span class="n">alpha_</span> <span class="c1">#0.3
</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">],</span> <span class="n">scoring</span><span class="o">=</span><span class="s">"r2"</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">clf</span><span class="p">.</span><span class="n">alpha_</span> <span class="c1">#0.3 #ê³„ì† ë²”ìœ„ë¥¼ ì¤„ì—¬ ë‚˜ê°„ë‹¤.
</span>

<span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">my_tr</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_new</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
<span class="c1">#array([[1.0350755 ],
</span>       <span class="p">[</span><span class="mf">1.04196859</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.04887989</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.05580933</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.06275684</span><span class="p">]])</span>

<span class="n">clf</span><span class="p">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">clf</span><span class="p">.</span><span class="n">intercept_</span> <span class="c1">#ê°€ì¤‘ì¹˜ ,í¸í–¥
</span>
<span class="c1">#(array([[ 2.04383040e-01,  2.75877253e-02, -2.34940881e-03,
</span>         <span class="o">-</span><span class="mf">8.88173617e-03</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.55326984e-03</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.38695956e-03</span><span class="p">,</span>
          <span class="mf">1.88318873e-05</span><span class="p">,</span>  <span class="mf">8.98776960e-03</span><span class="p">,</span>  <span class="mf">1.97985145e-02</span><span class="p">,</span>
          <span class="mf">3.17796667e-02</span><span class="p">]]),</span>
<span class="c1">#array([1.38465065]))
</span>

<span class="n">clf</span><span class="p">.</span><span class="n">best_score_</span> <span class="c1">#ì œì¼ ì¢‹ì€ ìŠ¤ì½”ì–´
#0.8660278843491014
</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plot_model</span><span class="p">(</span><span class="n">Ridge</span><span class="p">,</span> <span class="n">alphas</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"$y$"</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># alpha ê°’ì— ë”°ë¥¸ ê·¸ë˜í”„ 
</span></code></pre></div></div>

<p><img src="/img/posts/ML8/ridge2.png" alt="ridge regression" /></p>

<p><br /></p>

<h2 id="ë¼ì˜-íšŒê·€-lasso-regression">ë¼ì˜ íšŒê·€ (Lasso regression)</h2>

<ul>
  <li>
    <p>ë¼ì˜íšŒê·€ì˜ ê²½ìš°ì— ë¦¿ì§€íšŒê·€ì˜ ê²½ìš°ì™€ ë‹¬ë¦¬ ì†ì‹¤í•¨ìˆ˜ê°€ ìµœì†Œê°€ ë˜ëŠ” $\theta$ë¥¼ í•´ì„ì ìœ¼ë¡œ êµ¬í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ê²½ì‚¬í•˜ê°•ë²• ë˜ëŠ” ì¢Œí‘œë³„í•˜ê°•ë²•(coordinate descent)ë¥¼ ì´ìš©</p>

    <blockquote>
      <ul>
        <li>ë¼ì˜íšŒê·€ì˜ ì†ì‹¤í•¨ìˆ˜ëŠ” $\theta_i=0$ $(i=1,\cdots,n)$ì—ì„œ ë¯¸ë¶„ ê°€ëŠ¥í•˜ì§€ ì•Šì§€ë§Œ, ê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„° ëŒ€ì‹  ì„œë¸Œê·¸ë˜ë””ì–¸íŠ¸(subgradient) ë²¡í„°ë¥¼ ì´ìš©í•˜ë©´ ê²½ì‚¬í•˜ê°•ë²•ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.</li>
        <li>$f:\mathbb R^n\to \mathbb R$ì˜ $ \theta=\theta_0$ì—ì„œì˜ ì„œë¸Œê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„° $\mathbf v\in \mathbb R^n$ëŠ” ë‹¤ìŒ ì¡°ê±´ì„ ë§Œì¡±ì‹œí‚¤ëŠ” ì„ì˜ì˜ ë²¡í„°ë¥¼ ì˜ë¯¸í•œë‹¤.</li>
      </ul>
    </blockquote>

\[f(\theta)\ge f(\theta_0)+\mathbf v^{\rm T}(\theta-\theta_0)\text{ for all }\theta\in \mathbb R^n\]

    <blockquote>
      <ul>
        <li>
\[\text{ì˜ˆë¥¼ ë“¤ì–´} f(\theta)=||\theta||_1=\sum_{i=1}^n|\theta_i|\text{ì— ëŒ€í•´} (\text{sign}(\theta_1),\cdots,\text{sign}(\theta_n))^{\rm T}\text{ëŠ”  ì„œë¸Œê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„° ì¤‘ í•˜ë‚˜ê°€ ëœë‹¤}\]
        </li>
        <li>
          <p>ë‹¨,
\(\text{sign}(\theta_i)=\begin{cases} 1 &amp;\text{ if }\theta_i&gt;0 \\ 0 &amp;\text{ if }\theta_i=0\\ -1 &amp; \text{ if }\theta_i&lt;0\end{cases}\)</p>
        </li>
        <li>
          <p>ë¯¸ë¶„ê°€ëŠ¥í•œ ì ì—ì„œì˜ ì„œë¸Œê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„°ëŠ” ê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„° ë¿ì´ë‹¤.</p>
        </li>
        <li>í•¨ìˆ˜ê°€ ìµœì†Œê°€ ë˜ëŠ” ì ì—ì„œì˜ ì„œë¸Œê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„° ì¤‘ì—ëŠ”  0ì´ í•­ìƒ í¬í•¨ë¨</li>
      </ul>
    </blockquote>
  </li>
  <li>
    <p>ì¢Œí‘œë³„í•˜ê°•ë²•(Coordinate Desecnt): ì•„ë˜ë¡œ ë³¼ë¡í•œ í•¨ìˆ˜ $f$ê°€ ëª¨ë“  ì ì—ì„œ ë¯¸ë¶„ê°€ëŠ¥í•˜ë©´, $\theta=\mathbf a=(a_1,\cdots,a_n)$ì—ì„œ $f$ê°€ ìµœì†Œê°€ ëœë‹¤ëŠ” ê²ƒì€ ë‹¤ìŒ í•¨ìˆ˜ $f_i(t)$ê°€ ëª¨ë‘ $t=a_i$ì—ì„œ ìµœì†Œê°€ ëœë‹¤ëŠ” ê²ƒê³¼ ë™ì¹˜ì´ë‹¤.</p>

\[\begin{align}
f_1(t)=f(t,a_2,a_3,&amp;\cdots,a_n)\\
f_2(t)=f(a_1,t,a_3,&amp;\cdots,a_n)\\ \vdots\\
f_n(t)=f(a_1,\cdots,&amp;a_{n-1},t)
\end{align}\]
  </li>
  <li>
    <p>ì•„ë˜ë¡œ ë³¼ë¡í•œ í•¨ìˆ˜ fê°€ ëª¨ë“  ì ì—ì„œ ë¯¸ë¶„ê°€ëŠ¥í•˜ì§€ ì•Šì€ ê²½ìš°ì—ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ìœ„ ê²°ê³¼ê°€ ì„±ë¦½í•˜ì§€ ì•ŠìŒ</p>
  </li>
  <li>
    <p>í•˜ì§€ë§Œ, í•¨ìˆ˜ $f$ê°€ ë‹¤ìŒê³¼ ê°™ì´ ì•„ë˜ë¡œ ë³¼ë¡í•œ í•¨ìˆ˜ $g,\ h_i$ë“¤ì˜ í•© $f(\theta)=g(\theta)+\sum_{i=1}^n h_i(\theta_i)$</p>

    <p>ì´ê³  $g$ê°€ ëª¨ë“  ì ì—ì„œ ë¯¸ë¶„ê°€ëŠ¥í•œ í•¨ìˆ˜ì¸ ê²½ìš°ì—ëŠ” $f$ê°€ $\theta=\mathbf a$ì—ì„œ ìµœì†Œë¼ëŠ” ê²ƒê³¼ ê° ì¢Œí‘œì¶•ì— ëŒ€í•´ ìµœì†Œë¼ëŠ” ê²ƒì´ ë™ì¹˜ì´ë‹¤. $\cdots\cdots$ (3)</p>

    <details>
    <summary>ì™œëƒí•˜ë©´!(í´ë¦­)</summary>
    <div>
        <p>\(\begin{align}
\f(\theta)-f(\mathbf a) = (\theta)-g(\mathbf a)+\sum_{i=1}^n (h_i(\theta_i)-h_i(a_i)) \\
\ge \nabla_{\theta}g(\mathbf a)(\theta -\mathbf a)+\sum_{i=1}^n (h_i(\theta_i)-h_i(a_i))\\
= \sum_{i=1}^n \left(\dfrac{\partial g}{\partial\theta_i}(\mathbf a)(\theta_i-a_i)+h_i(\theta_i)-		h_i(a_i)\right)\ge 0
\end{align}\)
ìœ„ ë¶€ë“±ì‹ì˜ ë§ˆì§€ë§‰ì€ fê°€ $\theta=\mathbf a$ì—ì„œ ê° ì¢Œí‘œì¶•ì— ìµœì†Œë¼ëŠ” ê²ƒìœ¼ë¡œë¶€í„° ê° $i=1,\cdots,n$ì— ëŒ€í•´ $-\dfrac{\partial g}{\partial \theta_i}(\mathbf a)$ê°€ $\theta_i=a_i$ì—ì„œ $h_i$ì˜ ì„œë¸Œê·¸ë˜ë””ì–¸íŠ¸ê°€ ë˜ì–´ 		\(h_i(\theta_i)\ge h_i(a_i)-\dfrac{\partial g}{\partial \theta_i}(\mathbf a)(\theta_i-a_i)\)
ì´ ì„±ë¦½í•˜ê¸° ë•Œë¬¸</p>

      </div></details>
  </li>
  <li>
    <p>ìœ„ (3)ì˜ ìƒí™©ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ë°˜ë³µì ìœ¼ë¡œ ê° ì¢Œí‘œì¶•ì„ ë”°ë¼ ì›€ì§ì´ë©° í•¨ìˆ˜ì˜ ìµœì†Ÿê°’ì„ ì°¾ëŠ” ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì„ <strong>ì¢Œí‘œë³„í•˜ê°•ë²•</strong>ì´ë¼ê³  í•¨</p>
  </li>
  <li>
    <p>$\theta^{(0)}$ë¥¼ ì„ì˜ë¡œ ì„ íƒí•œ í›„ ë‹¤ìŒê³¼ ê°™ì´ $\theta^{(k)}$ë¡œë¶€í„° $\theta^{(k+1)}$ë¡œ ì—…ë°ì´íŠ¸ 
\(\begin{align}
\theta_1^{(k+1)} \in\ \text{argmin}_t &amp;f(t,\theta_2^{(k)},\theta_3^{(k)}\cdots,\theta_n^{(k)}) \\   \theta_2^{(k+1)} \in\ \text{argmin}_t &amp;f(\theta_1^{(k+1)},t,\theta_3^{(k)},\cdots,\theta_n^{(k)}) \\   
\vdots \\   
\theta_n^{(k+1)} \in\ \text{argmin}_t &amp;f(\theta_1^{(k+1)},\cdots,\theta_{n-1}^{(k+1)},t)
\end{align}\)</p>
  </li>
  <li>
    <p>ìœ„ì˜ ë°˜ë³µê³¼ì •ì—ì„œ ê° ì¢Œí‘œì¶• ë³„ë¡œ ìµœì†Œê°€ ë˜ëŠ” Î¸ië¥¼ êµ¬í•  ë•Œ, (ì„œë¸Œê·¸ë˜ë””ì–¸íŠ¸ë¥¼ ì´ìš©í•œ) ê²½ì‚¬í•˜ê°•ë²•ì„ ì ìš©í•  ìˆ˜ ìˆìŒ</p>

    <p><br /></p>
  </li>
  <li>
    <p>ë¼ì˜íšŒê·€ëŠ” ë¦¿ì§€íšŒê·€ì— ë¹„í•´ ëœ ì¤‘ìš”í•œ íŠ¹ì„±ì˜ ê°€ì¤‘ì¹˜ë¥¼ ì œê±°í•˜ëŠ” ê²½í–¥ì´ ìˆìŒ: ëœ ì¤‘ìš”í•œ íŠ¹ì„±ì˜ ê°€ì¤‘ì¹˜ê°€ 1ì´ ë¨, ì¤‘ìš”í•œ íŠ¹ì„±ë§Œ ì„ íƒí•˜ëŠ” íš¨ê³¼</p>
  </li>
</ul>

<p><img src="/img/posts/ML8/l1_l2.png" alt="l1 and l2" /></p>

<blockquote>
  <ul>
    <li>ë‘ ê²½ìš° ëª¨ë‘ $\theta_1=2, \theta_2=0.5$ë¡œ ì´ˆê¸°í™”í•˜ê³  ê²½ì‚¬í•˜ê°•ë²•ì„ ì ìš©í•˜ì—¬ ê° í•¨ìˆ˜ê°€ ìµœì†Œê°€ ë˜ëŠ” $\theta$ë¥¼ êµ¬í•˜ë©´ $\ell_1$ì˜ ê²½ìš°ì—ëŠ” ì„œë¸Œê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„°ê°€ $(\text{sign}(\theta_1),\text{sign}(\theta_2))^{\rm T}$ì´ë¯€ë¡œ $\theta_2$ê°€ ë¨¼ì € 0ì´ ë˜ê³ , $\theta_1$ì´ 0ì´ ë  ë•Œê¹Œì§€ $\theta_1$ ì¶•ì„ ë”°ë¼ ì´ë™.</li>
    <li>$\ell_2$ì˜ ê²½ìš°ì—ëŠ” ê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„°ê°€ $2(\theta_1,\theta_2)^{\rm T}$ì´ë¯€ë¡œ ì›ì ê¹Œì§€ ì§ì„ ì„ ë”°ë¼ ì´ë™</li>
    <li>ê²½ì‚¬í•˜ê°•ë²•ì˜ ê³ ì •ëœ í•™ìŠµë¥ ì— ëŒ€í•´ $\ell_2$ì˜ ê²½ìš°, ì›ì ì— ê°€ê¹Œì›Œì§ˆ ìˆ˜ë¡ ì—…ë°ì´íŠ¸ë˜ëŠ” ì •ë„ê°€ ì¤„ì–´ë“¤ë©´ì„œ ìˆ˜ë ´. $\ell_1$ì˜ ê²½ìš°ì—ëŠ” í•™ìŠµë¥ ì„ ìŠ¤ì¼€ì¥´ë§ í•˜ì§€ ì•Šìœ¼ë©´ ì§„ë™ (ë”°ë¼ì„œ, ìˆ˜ë ´ì„ ì‹œí‚¤ë ¤ë©´ ì ì§„ì ìœ¼ë¡œ í•™ìŠµë¥ ì„ ê°ì†Œì‹œì¼œì•¼ í•¨)</li>
    <li>ë¼ì˜íšŒê·€ëŠ” sklearn.linear_model ëª¨ë“ˆì˜ Lasso í´ë˜ìŠ¤(<a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Lasso.html?highlight=lasso#sklearn.linear_model.Lasso">API</a>) ë˜ëŠ” SGDRegressor(penalty=â€l1â€)ì„ ì´ìš©</li>
  </ul>
</blockquote>

<ul>
  <li>ë¼ì˜íšŒê·€ì—ì„œ ê·œì œë¥¼ ì¡°ì ˆí•˜ëŠ” í•˜ì´í¼íŒŒë¼ë¯¸í„° $\alpha$ë¥¼ ì¡°ì •í•˜ëŠ” ê²ƒì€ ë¦¿ì§€íšŒê·€ì˜ ê²½ìš°ì²˜ëŸ¼ êµì°¨ê²€ì¦ì„ ì´ìš©</li>
  <li>ë¼ì˜íšŒê·€ì— ëŒ€í•œ êµì°¨ê²€ì¦ì„ ì‰½ê²Œ í•˜ëŠ” ë°©ë²•ì€ LassoCV(<a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LassoCV.html#sklearn.linear_model.LassoCV">API</a>)</li>
</ul>

<p><br /></p>

<h2 id="ì—˜ë¼ìŠ¤í‹±ë„·elastic-net">ì—˜ë¼ìŠ¤í‹±ë„·(Elastic Net)</h2>

<ul>
  <li>
    <p>ì¼ë°˜ì ìœ¼ë¡œ ê·œì œê°€ ì—†ëŠ” ì„ í˜•íšŒê·€ë³´ë‹¤ëŠ” ë¦¿ì§€íšŒê·€ë¥¼ ì ìš©í•˜ì§€ë§Œ, ì“°ì´ëŠ” íŠ¹ì„±ì´ ëª‡ ê°œë¿ì´ë¼ê³  ì˜ì‹¬ë  ë•ŒëŠ” ë¼ì˜íšŒê·€ ë˜ëŠ” ì—˜ë¼ìŠ¤í‹±ë„·ì„ ì ìš©</p>
  </li>
  <li>
    <p>íŠ¹ì„± ìˆ˜ê°€ ìƒ˜í”Œ ìˆ˜ë³´ë‹¤ ë§ê±°ë‚˜ íŠ¹ì„± ëª‡ ê°œê°€ ê°•í•˜ê²Œ ì—°ê´€ë˜ì–´ ìˆì„ ë•Œ ë¼ì˜íšŒê·€ê°€ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆëŠ”ë°, ì´ëŸ´ ë•Œ ì—˜ë¼ìŠ¤í‹±ë„·ì„ ì£¼ë¡œ ì‚¬ìš©</p>
  </li>
  <li>
    <p>sklearn.linear_model ëª¨ë“ˆì˜ ElasticNet í´ë˜ìŠ¤ (<a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNet.html?highlight=elasticnet#sklearn.linear_model.ElasticNet">API</a>) ë˜ëŠ” SGDRegressor(penalty=â€elasticnetâ€)ì„ ì´ìš©</p>

    <blockquote>
      <ul>
        <li>ì—˜ë¼ìŠ¤í‹±ë„·ì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ëŠ” ê·œì œë¥¼ ì¡°ì ˆí•˜ëŠ” Î±ì— í•´ë‹¹ë˜ëŠ” ì…ë ¥ë³€ìˆ˜ <code class="language-plaintext highlighter-rouge">alpha</code>ì™€ â„“1 í˜ë„í‹°ì™€ â„“2 íŒ¨ë„í‹°ë¥¼ ê²°í•©í•˜ëŠ” ë¹„ìœ¨ì„ ê²°ì •í•˜ëŠ” rì— í•´ë‹¹ë˜ëŠ” ì…ë ¥ë³€ìˆ˜ <code class="language-plaintext highlighter-rouge">l1_ratio</code>ë¥¼ êµì°¨ê²€ì¦ì„ í†µí•´ ì„ íƒí•´ì•¼ í•¨</li>
      </ul>
    </blockquote>
  </li>
</ul>

<p><br /></p>

<h3 id="ê°ì²´ë¥¼-ìƒì„±í›„-í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼-ìˆ˜ì •í•˜ëŠ”-ë°©ë²•">ê°ì²´ë¥¼ ìƒì„±í›„ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ìˆ˜ì •í•˜ëŠ” ë°©ë²•</h3>

<ul>
  <li>SGDRegressor<code class="language-plaintext highlighter-rouge">, </code>Ridge<code class="language-plaintext highlighter-rouge">, </code>Lasso<code class="language-plaintext highlighter-rouge">, </code>ElasticNetì˜ ê°ì²´ë¥¼ ìƒì„±í•œ í›„ íŒŒë¼ë¯¸í„°ë¥¼ ìˆ˜ì •í•˜ê¸° ìœ„í•´ì„œëŠ” ìƒì„±ëœ ê°ì²´ì˜ set_params(**kwargs) ë©”ì†Œë“œë¥¼ ì´ìš©í•˜ë©´ ë¨.</li>
  <li>SGDRegressor<code class="language-plaintext highlighter-rouge">, </code>Ridge<code class="language-plaintext highlighter-rouge">, </code>Lasso<code class="language-plaintext highlighter-rouge">, </code>ElasticNetì˜ ê°ì²´ë¥¼ í•™ìŠµì‹œí‚¨ í›„(fit) ì„±ëŠ¥ì§€í‘œë¡œ <strong>$R^2$</strong>ì„ ê³„ì‚°í•˜ê¸° ìœ„í•´ì„œëŠ” í•™ìŠµëœ ê°ì²´ì˜ score(X, y) ë©”ì†Œë“œë¥¼ ì´ìš©í•˜ë©´ ë¨.</li>
  <li><code class="language-plaintext highlighter-rouge">Ridge</code>ë‚˜ <code class="language-plaintext highlighter-rouge">Lasso</code>ì˜ ê²½ìš°ì²˜ëŸ¼ <code class="language-plaintext highlighter-rouge">ElasticNetCV</code>ë¥¼ ì´ìš©í•˜ì—¬ ê·œì œë¥¼ ì¡°ì ˆí•˜ëŠ” â€˜alphaâ€™ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ê²€ì¦ ë°ì´í„°ì…‹ìœ¼ë¡œ ì„ íƒí•  ìˆ˜ ìˆìŒ(<a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.ElasticNetCV.html?highlight=elasticnet#sklearn.linear_model.ElasticNetCV">API</a>)</li>
</ul>

<p><br /></p>

<h2 id="ì¡°ê¸°-ì¢…ë£Œearly-stopping">ì¡°ê¸° ì¢…ë£Œ(Early Stopping)</h2>

<ul>
  <li>
    <p>ê²½ì‚¬í•˜ê°•ë²•ê³¼ ê°™ì´ ë°˜ë³µì ì¸ í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì„ ê·œì œí•˜ëŠ” ë˜ ë‹¤ë¥¸ ë°©ì‹ì€ ê²€ì¦ì—ëŸ¬ê°€ ìµœì†Ÿê°’(ê²€ì¦ ì„±ëŠ¥ì´ ìµœëŒ“ê°’)ì— ë„ë‹¬í•˜ë©´ ë°”ë¡œ í›ˆë ¨ì„ ì¤‘ì§€ì‹œí‚¤ëŠ” ê²ƒìœ¼ë¡œ <strong>ì¡°ê¸° ì¢…ë£Œ</strong>ë¼ê³  í•¨</p>
  </li>
  <li>
    <p>ë³´í†µ í•™ìŠµ ì—í¬í¬ê°€ ì§„í–‰ë¨ì— ì•Œê³ ë¦¬ì¦˜ì´ ì ì°¨ í•™ìŠµë˜ì–´ í›ˆë ¨ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì˜¤ì°¨ì™€ ê²€ì¦ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì˜¤ì°¨ê°€ ëª¨ë‘ ì¤„ì–´ë“¤ë‹¤ê°€, ê²€ì¦ ì˜¤ì°¨ëŠ” ë‹¤ì‹œ ìƒìŠ¹í•˜ê¸° ì‹œì‘í•¨ (ê³¼ëŒ€ì í•©ì´ ë˜ê¸° ì‹œì‘)</p>
  </li>
  <li>
    <p>ì¡°ê¸°ì¢…ë£ŒëŠ” ê²€ì¦ ì˜¤ì°¨ê°€ ìµœì†Œì— ë„ë‹¬í•˜ëŠ” ì¦‰ì‹œ í•™ìŠµì„ ë©ˆì¶”ëŠ” ê²ƒ</p>
  </li>
  <li>
    <p>í™•ë¥ ì  ê²½ì‚¬í•˜ê°•ë²•ì´ë‚˜ ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬í•˜ê°•ë²•ê³¼ ê°™ì´ ë¶ˆê·œì¹™í•˜ê²Œ ì›€ì§ì´ë©° ìˆ˜ë ´í•´ê°€ëŠ” ê²½ìš°ëŠ” ê²€ì¦ ì˜¤ì°¨ê°€ ìµœì†Ÿê°’ì— ë„ë‹¬í–ˆëŠ”ì§€ë¥¼ í™•ì¸í•˜ê¸° ì‰½ì§€ ì•ŠìŒ</p>

    <blockquote>
      <ul>
        <li>ê²€ì¦ ì˜¤ì°¨ê°€ ì¼ì • ì‹œê°„ ë™ì•ˆ í˜„ì¬ê¹Œì§€ì˜ ìµœì†Ÿê°’ë³´ë‹¤ í´ ë•Œ, í•™ìŠµì„ ë©ˆì¶”ê³  ê²€ì¦ ì—ëŸ¬ê°€ ìµœì†Œì˜€ì„ ë•Œì˜ ëª¨ë¸ íŒŒë¼ë¯¸í„°ë¡œ ë˜ëŒë¦¬ëŠ” ê²ƒìœ¼ë¡œ ê·¹ë³µ</li>
      </ul>
    </blockquote>
  </li>
  <li>
    <p>ì†ì‹¤í•¨ìˆ˜ $f$ê°€ ìµœì†Œê°€ ë˜ëŠ”ì§€ë¥¼ í™•ì¸í•˜ëŠ” ë°©ë²•</p>
  </li>
</ul>

\[|f(\theta^{(k+1)})-f(\theta^{(k)})|&lt; \epsilon \\
||\nabla_{\theta}f(\theta)||&lt;\epsilon\]

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">###ì‹¤ìŠµ
</span></code></pre></div></div>

<p><br /></p>

<p>Reference: ê¸°ê³„í•™ìŠµ_í•˜ê¸¸ì°¬ êµìˆ˜ë‹˜ ìˆ˜ì—…ì„ ë“£ê³  ê³µë¶€í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p>

:ET