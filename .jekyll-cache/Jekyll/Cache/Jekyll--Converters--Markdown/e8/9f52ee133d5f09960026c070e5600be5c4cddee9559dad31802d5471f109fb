I"²+<h2 id="ê²½ì‚¬-í•˜ê°•ë²•-ì‹¤ìŠµ">ê²½ì‚¬ í•˜ê°•ë²• ì‹¤ìŠµ</h2>

<ul>
  <li>
    <p>$Y=4+3X+\epsilon$ ($0\le X \le 2$)ë¥¼ ë”°ë¥´ëŠ” ìƒ˜í”Œ 100ê°œë¥¼ ìƒì„±í•œ í›„ ì„ í˜•íšŒê·€ë¥¼ ì ìš©</p>
  </li>
  <li>
    <p>SVDë¥¼ ì´ìš©í•œ ì„ í˜•íšŒê·€ì¸ LinearRegression, SGDë¥¼ ì´ìš©í•œ ì„ í˜•íšŒê·€ì¸ SGDRegressor, ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•, ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•ì„ ë¹„êµ ì‹¤ìŠµ</p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë°ì´í„° ìƒ˜í”Œ ìƒì„± 
</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span> 
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDRegressor</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span> 
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="c1">#ëœë¤ì‹œë“œ ê³ ì •
</span>
<span class="n">X</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#0~1ì˜ ê· ì¼ë¶„í¬ í‘œì¤€ì •ê·œë¶„í¬ ë‚œìˆ˜ë¥¼ matrix array(m,n) ìƒì„±
</span><span class="n">y</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">X</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#í‰ê· 0, í‘œì¤€í¸ì°¨1ì˜ ê°€ìš°ì‹œì•ˆ í‘œì¤€ì •ê·œë¶„í¬ ë‚œìˆ˜ë¥¼ matrix array(m,n) ìƒì„±
</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="s">'b.'</span><span class="p">)</span> <span class="c1">#íŒŒë€ìƒ‰ìœ¼ë¡œ ì‚°ì ë„ ê·¸ë¦¬ê¸°
</span><span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"$x_1$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"$y$"</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span> <span class="c1">#plt.axis([xmin,xmax,ymin,ymax]) 
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ê° íŠ¹ì„±ë²¡í„°ì˜ ì²« ë²ˆì§¸ ì¢Œí‘œì— biasì— ëŒ€ì‘ë˜ëŠ” 1ì„ ì¶”ê°€í•˜ì—¬ Xbë¡œ ìˆ˜ì • 
# ì—¬ëŸ¬ ê°€ì§€ ê²½ì‚¬ í•˜ê°•ë²•ì„ ì§ì ‘ êµ¬í˜„í•´ ë³¼ ë•Œ ì‚¬ìš©
</span>
<span class="n">Xb</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">X</span><span class="p">))</span>  <span class="c1">##ë°°ì—´ì„ ì—´ë¡œ ë§Œë“¤ì–´ì„œ ë¶™ì´ê¸°
</span>
<span class="n">X_new</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">Xb_new</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">X_new</span><span class="p">))</span>
</code></pre></div></div>

<h3 id="linearregression">LinearRegression</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n_reg_svd</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span> 
<span class="n">lin_reg_svd</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">theta_svd</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">lin_reg_svd</span><span class="p">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">lin_reg_svd</span><span class="p">.</span><span class="n">coef_</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="c1">#intercept_: í¸í–¥, coef_: ê°€ì¤‘ì¹˜
</span><span class="n">theta_svd</span> 

<span class="c1">#array([[3.8115615 ],
</span>       <span class="p">[</span><span class="mf">3.23892352</span><span class="p">]])</span>
       
<span class="n">y_predict_svd</span> <span class="o">=</span> <span class="n">lin_reg_svd</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
<span class="n">y_predict_svd</span>

<span class="c1">#array([[ 3.8115615 ],
</span>       <span class="p">[</span><span class="mf">10.28940854</span><span class="p">]])</span>
    
<span class="c1"># ëª¨ë¸ì˜ ì˜ˆì¸¡ì„ ê·¸ë˜í”„ì— ë‚˜íƒ€ë‚´ê¸° 
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">'b.'</span><span class="p">)</span> <span class="c1">#íŒŒë€ìƒ‰ ì ìœ¼ë¡œ ì‚°ì ë„
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="n">y_predict_svd</span><span class="p">,</span> <span class="s">'r-'</span><span class="p">)</span> <span class="c1">#ë¹¨ê°„ìƒ‰ ì„ ìœ¼ë¡œ íšŒê·€ì§ì„  ê·¸ë¦¬ê¸°
</span><span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"$x_1$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1">#xì¢Œí‘œì¶•
</span><span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"$y$"</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1">#yì¢Œí‘œì¶•
</span><span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span> 
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Linear regression with SVD"</span><span class="p">)</span> <span class="c1">#ì œëª©
</span></code></pre></div></div>

<h3 id="ë°°ì¹˜-ê²½ì‚¬-í•˜ê°•ë²•-1">ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²• 1</h3>

<ul>
  <li>ê·¸ë˜ë””ì–¸íŠ¸ë¥¼ êµ¬í•˜ëŠ” ì‹ â€” (2)</li>
</ul>

\[(\nabla_{\boldsymbol{\theta}} L(\boldsymbol{\theta})) = \dfrac 2 m \mathbf X^{\rm T}(\mathbf X\boldsymbol{\theta}-\mathbf y)=\mathbf 0\]

<ul>
  <li>${\theta}$ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ì‹ â€” (3)</li>
</ul>

\[{\theta}^{(t+1)}:= \boldsymbol{\theta}^{(t)}-\alpha \nabla_L({\theta}^{(t)})\ (t\ge 0)\]

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eta</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># í•™ìŠµë¥  
</span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># epoch ìˆ˜ 
</span><span class="n">m</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># ìƒ˜í”Œìˆ˜ 
</span>
<span class="n">theta_bgd</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># ë¬´ì‘ìœ„ë¡œ theta ì´ˆê¹ƒê°’ ì„¤ì • 
</span>
<span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">):</span>
    <span class="n">gradients</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">m</span> <span class="o">*</span> <span class="n">Xb</span><span class="p">.</span><span class="n">T</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Xb</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">theta_bgd</span><span class="p">)</span> <span class="o">-</span><span class="n">y</span><span class="p">)</span>   <span class="c1"># ì„¤ëª…ì˜ ì‹ (2) êµ¬í˜„
</span>    <span class="n">theta_bgd</span> <span class="o">=</span> <span class="n">theta_bgd</span> <span class="o">-</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">gradients</span>                <span class="c1"># ì„¤ëª…ì˜ ì‹ (3) êµ¬í˜„ 
</span></code></pre></div></div>

:ET