I"ç„<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>  <span class="c1">#íŒë‹¤ìŠ¤
</span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span> <span class="c1">#ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸
</span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span> <span class="c1">#ì˜ì‚¬ê²°ì • ë‚˜ë¬´ ëª¨ë¸
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
</span>
<span class="n">train</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'../input/titanic/train.csv'</span><span class="p">)</span> <span class="c1">#ëª¨ë¸ í•™ìŠµ
</span><span class="n">test</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'../input/titanic/test.csv'</span><span class="p">)</span> <span class="c1">#ëª¨ë¸ ì‹œí—˜ì§€
</span><span class="n">submission</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'../input/titanic/gender_submission.csv'</span><span class="p">)</span> <span class="c1">#ë‹µì•ˆì§€
</span></code></pre></div></div>

<h2 id="eda">EDA</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
<p>PassengerId: íƒ‘ìŠ¹ê°ì˜ ê³ ìœ  ì•„ì´ë””/ Survival: ìƒì¡´ìœ ë¬´(0: ì‚¬ë§, 1: ìƒì¡´)/ Pclass: ë“±ì‹¤ì˜ ë“±ê¸‰/</p>

<p>Name:ì´ë¦„/ Sex: ì„±ë³„/ Age: ë‚˜ì´/ Sibsp: í•¨ê»˜ íƒ‘ìŠ¹í•œ í˜•ì œìë§¤, ì•„ë‚´, ë‚¨í¸ì˜ ìˆ˜/</p>

<p>Parch: í•¨ê»˜ íƒ‘ìŠ¹í•œ ë¶€ëª¨, ìì‹ì˜ ìˆ˜/ Ticket: í‹°ì¼“ë²ˆí˜¸/ Fare: í‹°ì¼“ì˜ ìš”ê¸ˆ/</p>

<p>Cabin: ê°ì‹¤ë²ˆí˜¸/ Embarked: ë°°ì— íƒ‘ìŠ¹í•œ ìœ„ì¹˜(C = Cherbourg, Q = Queenstown, S = Southampton)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>892</td>
      <td>3</td>
      <td>Kelly, Mr. James</td>
      <td>male</td>
      <td>34.5</td>
      <td>0</td>
      <td>0</td>
      <td>330911</td>
      <td>7.8292</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>1</th>
      <td>893</td>
      <td>3</td>
      <td>Wilkes, Mrs. James (Ellen Needs)</td>
      <td>female</td>
      <td>47.0</td>
      <td>1</td>
      <td>0</td>
      <td>363272</td>
      <td>7.0000</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>2</th>
      <td>894</td>
      <td>2</td>
      <td>Myles, Mr. Thomas Francis</td>
      <td>male</td>
      <td>62.0</td>
      <td>0</td>
      <td>0</td>
      <td>240276</td>
      <td>9.6875</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>3</th>
      <td>895</td>
      <td>3</td>
      <td>Wirz, Mr. Albert</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>315154</td>
      <td>8.6625</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>896</td>
      <td>3</td>
      <td>Hirvonen, Mrs. Alexander (Helga E Lindqvist)</td>
      <td>female</td>
      <td>22.0</td>
      <td>1</td>
      <td>1</td>
      <td>3101298</td>
      <td>12.2875</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">submission</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>  <span class="c1">#ì—¬ì„± 1 ë‚¨ì„± 0
</span></code></pre></div></div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>892</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>893</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>894</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>895</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>896</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>í›ˆë ¨ ë°ì´í„°, í…ŒìŠ¤íŠ¸ ë°ì´í„° íŒŒì•…</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#ì†ì„±ì„ ë‚˜íƒ€ë‚´ëŠ” shape ë©”ì†Œë“œëŠ” ()ì“°ì§€ ì•ŠëŠ”ë‹¤. 
</span><span class="k">print</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1">#ê° íŒŒì¼ì˜ ë°ì´í„° í¬ê¸° íŒŒì•…
</span><span class="k">print</span><span class="p">(</span><span class="n">submission</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(891, 12)
(418, 11)
(418, 2)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">info</span><span class="p">()</span> <span class="c1">#ê¸°ë³¸ì ì´ê³  ì „ì²´ì ì¸ ë°ì´í„° íŒŒì•…
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  891 non-null    int64  
 1   Survived     891 non-null    int64  
 2   Pclass       891 non-null    int64  
 3   Name         891 non-null    object 
 4   Sex          891 non-null    object 
 5   Age          714 non-null    float64
 6   SibSp        891 non-null    int64  
 7   Parch        891 non-null    int64  
 8   Ticket       891 non-null    object 
 9   Fare         891 non-null    float64
 10  Cabin        204 non-null    object 
 11  Embarked     889 non-null    object 
dtypes: float64(2), int64(5), object(5)
memory usage: 83.7+ KB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 418 entries, 0 to 417
Data columns (total 11 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  418 non-null    int64  
 1   Pclass       418 non-null    int64  
 2   Name         418 non-null    object 
 3   Sex          418 non-null    object 
 4   Age          332 non-null    float64
 5   SibSp        418 non-null    int64  
 6   Parch        418 non-null    int64  
 7   Ticket       418 non-null    object 
 8   Fare         417 non-null    float64
 9   Cabin        91 non-null     object 
 10  Embarked     418 non-null    object 
dtypes: float64(2), int64(4), object(5)
memory usage: 36.0+ KB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">describe</span><span class="p">())</span> <span class="c1">#ê° ë°ì´í„°ì˜ ê¸°ìˆ  í†µê³„ëŸ‰ í™•ì¸
</span><span class="k">print</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">describe</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>       PassengerId    Survived      Pclass         Age       SibSp  \
count   891.000000  891.000000  891.000000  714.000000  891.000000   
mean    446.000000    0.383838    2.308642   29.699118    0.523008   
std     257.353842    0.486592    0.836071   14.526497    1.102743   
min       1.000000    0.000000    1.000000    0.420000    0.000000   
25%     223.500000    0.000000    2.000000   20.125000    0.000000   
50%     446.000000    0.000000    3.000000   28.000000    0.000000   
75%     668.500000    1.000000    3.000000   38.000000    1.000000   
max     891.000000    1.000000    3.000000   80.000000    8.000000   

            Parch        Fare  
count  891.000000  891.000000  
mean     0.381594   32.204208  
std      0.806057   49.693429  
min      0.000000    0.000000  
25%      0.000000    7.910400  
50%      0.000000   14.454200  
75%      0.000000   31.000000  
max      6.000000  512.329200  
       PassengerId      Pclass         Age       SibSp       Parch        Fare
count   418.000000  418.000000  332.000000  418.000000  418.000000  417.000000
mean   1100.500000    2.265550   30.272590    0.447368    0.392344   35.627188
std     120.810458    0.841838   14.181209    0.896760    0.981429   55.907576
min     892.000000    1.000000    0.170000    0.000000    0.000000    0.000000
25%     996.250000    1.000000   21.000000    0.000000    0.000000    7.895800
50%    1100.500000    3.000000   27.000000    0.000000    0.000000   14.454200
75%    1204.750000    3.000000   39.000000    1.000000    0.000000   31.500000
max    1309.000000    3.000000   76.000000    8.000000    9.000000  512.329200
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span> <span class="c1">#ë°°ì— íƒ‘ìŠ¹í•œ ìœ„ì¹˜
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>S    644
C    168
Q     77
Name: Embarked, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">].</span><span class="n">unique</span><span class="p">()</span> <span class="c1">#unique ë©”ì†Œë“œëŠ” ì‹œë¦¬ì¦ˆë¡œ ì ‘ê·¼
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array(['S', 'C', 'Q', nan], dtype=object) #ë‚˜ì˜¤ëŠ” ìˆœì„œëŒ€ë¡œ ë‚˜ì˜´
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'Sex'</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>431.028662</td>
      <td>0.742038</td>
      <td>2.159236</td>
      <td>27.915709</td>
      <td>0.694268</td>
      <td>0.649682</td>
      <td>44.479818</td>
    </tr>
    <tr>
      <th>male</th>
      <td>454.147314</td>
      <td>0.188908</td>
      <td>2.389948</td>
      <td>30.726645</td>
      <td>0.429809</td>
      <td>0.235702</td>
      <td>25.523893</td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'Pclass'</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
    </tr>
    <tr>
      <th>Pclass</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>461.597222</td>
      <td>0.629630</td>
      <td>38.233441</td>
      <td>0.416667</td>
      <td>0.356481</td>
      <td>84.154687</td>
    </tr>
    <tr>
      <th>2</th>
      <td>445.956522</td>
      <td>0.472826</td>
      <td>29.877630</td>
      <td>0.402174</td>
      <td>0.380435</td>
      <td>20.662183</td>
    </tr>
    <tr>
      <th>3</th>
      <td>439.154786</td>
      <td>0.242363</td>
      <td>25.140620</td>
      <td>0.615071</td>
      <td>0.393075</td>
      <td>13.675550</td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ì‹œê°í™”
#pd.Series.plot(kind='bar')
</span>
<span class="n">train</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'Pclass'</span><span class="p">).</span><span class="n">mean</span><span class="p">()[</span><span class="s">'Survived'</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1">#rot=0 xì¶• ëª…ì¹­ íšŒì „ ìˆ˜ì •/ rot=45ëŠ” ë¹„ìŠ¤ë“¬íˆ(ê°ë„)
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;AxesSubplot:xlabel='Pclass'&gt;
</code></pre></div></div>

<p>â€‹    <img src="/img/posts/titanic/titanic_14_1.png" alt="í´ë˜ìŠ¤ë³„ ìƒì¡´ìœ¨" />
â€‹</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'hist'</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1">#bins ë„ìˆ˜ë¥¼ ë” ì˜ê²Œ ë‚˜ëˆ” gridë¡œ ë³´ì¡°ì„ ê¹Œì§€ ì¶”ê°€
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;AxesSubplot:ylabel='Frequency'&gt;
</code></pre></div></div>

<p><img src="/img/posts/ML/titanic/titanic_15_1.png" alt="ë‚˜ì´ë³„ ìƒì¡´ì ìˆ˜" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'Age'</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">'Fare'</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">'scatter'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;AxesSubplot:xlabel='Age', ylabel='Fare'&gt;
</code></pre></div></div>

<p><img src="/img/posts/titanic/titanic_16_1.png" alt="ìš”ê¸ˆê³¼ ë‚˜ì´ ì‚°ì ë„ ë¶„í¬" /></p>

<h2 id="ë°ì´í„°-ì „ì²˜ë¦¬">ë°ì´í„° ì „ì²˜ë¦¬</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ê²°ì¸¡ê°’ íŒŒì•…
</span><span class="n">train</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PassengerId      0
Survived         0
Pclass           0
Name             0
Sex              0
Age            177
SibSp            0
Parch            0
Ticket           0
Fare             0
Cabin          687
Embarked         2
dtype: int64
</code></pre></div></div>

<ul>
  <li>ë‚˜ì´ ê²°ì¸¡ê°’ í•´ê²°</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">median</span><span class="p">()</span> <span class="c1">#ì¤‘ì•™ê°’ìœ¼ë¡œ ëŒ€ì²´
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>28.0
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span><span class="c1">#ì´ê²ƒë§Œ ì“°ë©´ ì €ì¥ì´ ì•ˆë¨! ì¼ì‹œì ìœ¼ë¡œ ë‚˜íƒ€ë‚´ì£¼ê¸°ë§Œ í•œë‹¤. 
</span><span class="n">train</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="c1">#train['Age'] ì— ë‹¤ì‹œ ì €ì¥
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span> <span class="c1">#Age í™•ì¸
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PassengerId      0
Survived         0
Pclass           0
Name             0
Sex              0
Age              0
SibSp            0
Parch            0
Ticket           0
Fare             0
Cabin          687
Embarked         2
dtype: int64
</code></pre></div></div>

<ul>
  <li>ì¢Œì„ ë“±ê¸‰ ê²°ì¸¡ê°’</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>S    644
C    168
Q     77
Name: Embarked, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">]</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="s">'S'</span><span class="p">)</span> <span class="c1">#ì œì¼ ë§ì€ ê°’ì¸ Së¡œ ì±„ì›Œì£¼ê² ë‹¤.
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span> <span class="c1">#Embarked í™•ì¸
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PassengerId      0
Survived         0
Pclass           0
Name             0
Sex              0
Age              0
SibSp            0
Parch            0
Ticket           0
Fare             0
Cabin          687
Embarked         0
dtype: int64
</code></pre></div></div>

<ul>
  <li>ê°ì‹¤ë²ˆí˜¸ëŠ” ìœ ì˜ë¯¸í•œ ë³€ìˆ˜ê°€ ì•„ë‹ˆë¼ íŒë‹¨, ì „ì²˜ë¦¬ ê³¼ì •ì—ì„œ ì œì™¸í•˜ê² ë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#pd.Series.map() #ì‹œë¦¬ì¦ˆ ë‚´ ê°’ì„ ë³€í™˜í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜
#ë‚¨ìëŠ” 0, ì—¬ìëŠ” 1ë¡œ ê°’ ë³€ê²½
</span><span class="n">train</span><span class="p">[</span><span class="s">'Sex'</span><span class="p">]</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s">'Sex'</span><span class="p">].</span><span class="nb">map</span><span class="p">({</span><span class="s">'male'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">'female'</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'Sex'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0      0
1      1
2      1
3      1
4      0
      ..
886    0
887    1
888    1
889    0
890    0
Name: Sex, Length: 891, dtype: int64
</code></pre></div></div>

<h2 id="ëª¨ë¸ë§">ëª¨ë¸ë§</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#X -&gt; MODEL -&gt; y
#ë³€ìˆ˜ëŠ” ì„±ë³„ê³¼ ì¢Œì„ ë“±ê¸‰ìœ¼ë¡œ ì •í–ˆë‹¤. 
</span><span class="n">X_train</span><span class="o">=</span><span class="n">train</span><span class="p">[[</span><span class="s">'Sex'</span><span class="p">,</span><span class="s">'Pclass'</span><span class="p">]]</span>
<span class="n">y_train</span><span class="o">=</span><span class="n">train</span><span class="p">[</span><span class="s">'Survived'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">[</span><span class="s">'Sex'</span><span class="p">]</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="s">'Sex'</span><span class="p">].</span><span class="nb">map</span><span class="p">({</span><span class="s">'male'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">'female'</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">X_test</span><span class="o">=</span><span class="n">test</span><span class="p">[[</span><span class="s">'Sex'</span><span class="p">,</span><span class="s">'Pclass'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_test</span>
</code></pre></div></div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sex</th>
      <th>Pclass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>413</th>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>414</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>415</th>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>416</th>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>417</th>
      <td>0</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>418 rows Ã— 2 columns</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lr</span><span class="o">=</span><span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">dt</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lr</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LogisticRegression()
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dt</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DecisionTreeClassifier()
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lr_pred</span><span class="o">=</span><span class="n">lr</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dt_pred</span><span class="o">=</span><span class="n">dt</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span> 
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">submission</span><span class="p">[</span><span class="s">'Survived'</span><span class="p">]</span><span class="o">=</span><span class="n">lr_pred</span>
<span class="n">submission</span>
</code></pre></div></div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>892</td>
      <td>0.102021</td>
    </tr>
    <tr>
      <th>1</th>
      <td>893</td>
      <td>0.593544</td>
    </tr>
    <tr>
      <th>2</th>
      <td>894</td>
      <td>0.224759</td>
    </tr>
    <tr>
      <th>3</th>
      <td>895</td>
      <td>0.102021</td>
    </tr>
    <tr>
      <th>4</th>
      <td>896</td>
      <td>0.593544</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>413</th>
      <td>1305</td>
      <td>0.102021</td>
    </tr>
    <tr>
      <th>414</th>
      <td>1306</td>
      <td>0.904848</td>
    </tr>
    <tr>
      <th>415</th>
      <td>1307</td>
      <td>0.102021</td>
    </tr>
    <tr>
      <th>416</th>
      <td>1308</td>
      <td>0.102021</td>
    </tr>
    <tr>
      <th>417</th>
      <td>1309</td>
      <td>0.102021</td>
    </tr>
  </tbody>
</table>
<p>418 rows Ã— 2 columns</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">submission</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'logistic_regression_pred.csv'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c1">#False ì•ˆí•˜ë©´ í–‰ì„ ë‚˜íƒ€ë‚´ëŠ” ì¸ë±ìŠ¤ê°€ ê°™ì´ ì €ì¥ë¨
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">submission</span><span class="p">[</span><span class="s">'Survived'</span><span class="p">]</span><span class="o">=</span><span class="n">dt_pred</span>
<span class="n">submission</span>
</code></pre></div></div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>892</td>
      <td>0.135447</td>
    </tr>
    <tr>
      <th>1</th>
      <td>893</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>894</td>
      <td>0.157407</td>
    </tr>
    <tr>
      <th>3</th>
      <td>895</td>
      <td>0.135447</td>
    </tr>
    <tr>
      <th>4</th>
      <td>896</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>413</th>
      <td>1305</td>
      <td>0.135447</td>
    </tr>
    <tr>
      <th>414</th>
      <td>1306</td>
      <td>0.968085</td>
    </tr>
    <tr>
      <th>415</th>
      <td>1307</td>
      <td>0.135447</td>
    </tr>
    <tr>
      <th>416</th>
      <td>1308</td>
      <td>0.135447</td>
    </tr>
    <tr>
      <th>417</th>
      <td>1309</td>
      <td>0.135447</td>
    </tr>
  </tbody>
</table>
<p>418 rows Ã— 2 columns</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">submission</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'decision_tree_pred.csv'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="c1">#ì •ë‹µì§€ ì œì¶œ
</span></code></pre></div></div>

<ul>
  <li>ë¡œì§€ìŠ¤í‹±, ê²°ì •íŠ¸ë¦¬ëª¨í˜•ì„ ì´ìš©í•´ ì œì¶œí•´ë´¤ìœ¼ë‚˜ ë¹„ìŠ·í•œ ì ìˆ˜ê°€ ë‚˜ì™”ê³  ì¶”í›„ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨í˜•ì— ë³€ìˆ˜ë¥¼ ì¶”ê°€í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì ‘ê·¼í–ˆë‹¤.</li>
  <li>ì˜¬ë°”ë¥¸ ë³€ìˆ˜ë¥¼ ì„ íƒí•˜ëŠ” ë²•ì„ ì¡°ê¸ˆ ë” ê³ ë ¤í•´ë³´ì•„ì•¼ í•  ê²ƒ ê°™ë‹¤.</li>
</ul>

<p>Reference:</p>

<ul>
  <li>ë°ì´ì½˜ì˜ íƒ€ì´íƒ€ë‹‰ ìƒì¡´ì ì˜ˆì¸¡í•˜ê¸° ì‹¤ìŠµ</li>
  <li>Kaggleì˜ íƒ€ì´íƒ€ë‹‰ ìƒì¡´ì ì˜ˆì¸¡ ë°ì´í„° ìë£Œ</li>
</ul>
:ET