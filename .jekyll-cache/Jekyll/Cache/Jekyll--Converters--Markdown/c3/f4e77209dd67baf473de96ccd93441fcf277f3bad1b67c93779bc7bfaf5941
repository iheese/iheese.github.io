I"Ğf<h2 id="ë°ì´í„°-ì •ì œ-ì „ì²˜ë¦¬">ë°ì´í„° ì •ì œ, ì „ì²˜ë¦¬</h2>

<p>: í›ˆë ¨ë°ì´í„°ì— ì—ëŸ¬, ì´ìƒì¹˜(outlier) ë“±ì´ ìˆìœ¼ë©´ ê¸°ê³„í•™ìŠµ ì‹œìŠ¤í…œì´ ë‚´ì¬ëœ íŒ¨í„´ì„ ì°¾ê¸° í˜ë“¤ê¸° ë•Œë¬¸ì— ì ì ˆí•œ ì‘ì—…ì´ í•„ìš”</p>

<ul>
  <li>ì¼ë¶€ ìƒ˜í”Œì— íŠ¹ì„± ëª‡ ê°œê°€ ë¹ ì ¸ìˆìœ¼ë©´, ì´ íŠ¹ì„±ì„ ë¬´ì‹œí•  ì§€, ì´ ìƒ˜í”Œì„ ë¬´ì‹œí•  ì§€, ë¹ ì§„ ê°’ì„ (í‰ê· ê°’ ë“±ìœ¼ë¡œ) ì±„ì›Œ ë„£ì„ì§€ë¥¼ ê²°ì •. ê²½ìš°ì— ë”°ë¼ì„œëŠ” ì´ë“¤ì„ ì œê±°í•œ ëª¨ë¸ê³¼ ì ì ˆí•˜ê²Œ ì±„ì›Œë„£ì€ ëª¨ë¸ì„ ê°ê° í›ˆë ¨ì‹œì¼œ ë¹„êµ</li>
</ul>

<blockquote>
  <p>isnull() ë©”ì†Œë“œ: ë¹ ì§„ ìƒ˜í”Œ í™•ì¸</p>

  <p>fillna() ë©”ì†Œë“œ: ë¹ ì§„ ìƒ˜í”Œ ì±„ìš°ê¸° ; inplace=True ë°”ë¡œ ë³€ìˆ˜ ëŒ€ì²´</p>

  <p>dropna() ë©”ì†Œë“œ: ë¹ ì§„ ìƒ˜í”Œ ì‚­ì œ</p>
</blockquote>

<ul>
  <li>
    <p>ì¼ë¶€ ìƒ˜í”Œì´ ì´ìƒì¹˜ë¼ëŠ” ê²ƒì´ ëª…í™•í•˜ë©´ ì œê±°, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ìˆ˜ì • (ë°ì´í„°ì— ëŒ€í•œ ì‚¬ì „ ì§€ì‹ì´ í•„ìš”)</p>
  </li>
  <li>
    <p>í‘œë³¸ì— ëŒ€í•œ ë‹¤ì–‘í•œ í†µê³„ëŸ‰(í‘œë³¸ì˜ ëª‡ ëª‡ íŠ¹ì„±ì„ ìˆ˜ì¹˜í™”í•œ ê²ƒ)ì„ ì´ìš©í•˜ì—¬ íŒë‹¨:</p>

    <blockquote>
      <p>í‘œë³¸í‰ê· , í‘œë³¸ë¶„ì‚°, ìµœì†Ÿê°’, ìµœëŒ“ê°’, ì¤‘ì•™ê°’, í‘œë³¸ ë¶„ìœ„ìˆ˜(quantile) ë“±</p>

      <p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.quantile.html?highlight=quantile#pandas.DataFrame.quantile">Pandasì˜ ë¶„ìœ„ìˆ˜ API</a></p>
    </blockquote>

    <blockquote>
      <ul>
        <li>boxplot</li>
      </ul>

      <p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.plot.box.html?highlight=box#pandas.DataFrame.plot.box">Pandasì˜ DataFrameì— ëŒ€í•œ <code class="language-plaintext highlighter-rouge">plot.box()</code> API</a></p>

      <p><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.boxplot.html#pandas.DataFrame.boxplot">Pandasì˜ DataFrameì— ëŒ€í•œ <code class="language-plaintext highlighter-rouge">boxplot()</code> API</a> : ë” ë§ì€ íŒŒë¼ë¯¸í„°ë¥¼ ê°€ì§€ê³  ìˆë‹¤.</p>
    </blockquote>
  </li>
</ul>

<h2 id="ë°ì´í„°-ì‹¤ìŠµ-with-pimaindiansdiabetescsv">ë°ì´í„° ì‹¤ìŠµ with PimaIndiansDiabetes.csv</h2>

<p>PimaIndiansDiabetes.csv: Pima Indian(ë¯¸êµ­ í† ì°© ì¸ë””ì–¸ ë¶€ì¡±) 768ëª…ì˜ ì„±ì¸ ì—¬ì„±ì˜ ì˜ë£Œ ì •ë³´ì™€ ë‹¹ë‡¨ë³‘ ì—¬ë¶€ê°€ ë‹´ê¸´ ë°ì´í„°ì…‹</p>

<p>â€‹																																								-ì¶œì²˜: kaggle</p>

<h3 id="ë°ì´í„°-ì •ì œ">ë°ì´í„° ì •ì œ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">'</span><span class="s">./datasets/PimaIndiansDiabetes.csv</span><span class="sh">'</span><span class="p">)</span> <span class="c1">#csv ë°ì´í„° ì½ê¸°
</span><span class="n">data_subset</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="sh">'</span><span class="s">Blood Glucose</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">BMI</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Class</span><span class="sh">'</span><span class="p">]]</span> <span class="c1">#í˜ˆë‹¹, BMI, ë‹¹ë‡¨ë³‘ ì—¬ë¶€(1,0) ë°ì´í„°ë§Œ ì¶”ì¶œ
</span>
<span class="n">data_subset</span><span class="p">.</span><span class="nf">quantile</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.75</span><span class="p">])</span>
<span class="n">data_subset</span><span class="p">[[</span><span class="sh">'</span><span class="s">Blood Glucose</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">BMI</span><span class="sh">'</span><span class="p">]].</span><span class="n">plot</span><span class="p">.</span><span class="nf">box</span><span class="p">()</span> <span class="c1"># quantileê°’, ìƒìê·¸ë¦¼ì„ í†µí•´ ì´ìƒì¹˜ íŒŒì•… ë° ë°ì´í„° íƒìƒ‰
</span>
</code></pre></div></div>

<p><img src="/img/posts/ML/ML5/ML5_plotbox.png" alt="plotbox" /></p>

<ul>
  <li>í˜ˆë‹¹ê³¼ BMI  ëª¨ë‘ 0 ê·¼ì²˜ì—ì„œ ì´ìƒì¹˜ ë°œê²¬Â» ìµœì†Ÿê°’ì„ ì´ìš©í•´ ê°’ í™•ì¸</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="n">data_subset</span><span class="p">.</span><span class="nf">min</span><span class="p">())</span> <span class="c1">#ëª¨ë‘ ìµœì†Ÿê°’ì´ 0ìœ¼ë¡œ ë‚˜ì˜´
</span></code></pre></div></div>

<ul>
  <li>ë‘ ë³€ìˆ˜ ëª¨ë‘ ë‹¹ë‡¨ë³‘ ì§„ë‹¨ê³¼ ê´€ë ¨ì„±ì´ ìˆìœ¼ë¯€ë¡œ í•˜ë‚˜ë¼ë„ 0ì´ë©´ ìƒ˜í”Œ ì‚­ì œ, ë‘ ë³€ìˆ˜ ëª¨ë‘ 0ì˜ ê°’ì„ ê°€ì§ˆ ìˆ˜ëŠ” ì—†ë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bg_mask</span> <span class="o">=</span> <span class="n">data_subset</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sh">"</span><span class="s">Blood Glucose</span><span class="sh">"</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span>
<span class="n">bmi_mask</span> <span class="o">=</span> <span class="n">data_subset</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sh">"</span><span class="s">BMI</span><span class="sh">"</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span>
<span class="n">clean_data_subset</span> <span class="o">=</span> <span class="n">data_subset</span><span class="p">[</span><span class="n">bg_mask</span> <span class="o">&amp;</span> <span class="n">bmi_mask</span><span class="p">]</span>
</code></pre></div></div>

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td>X_train0,X_train1ì˜ ê° ì—´ì— ëŒ€í•´ íˆìŠ¤í† ê·¸ë¨ì„ ê·¸ë ¤ p(x1</td>
          <td>0),p(x1</td>
          <td>1),p(x2</td>
          <td>0),p(x2</td>
          <td>1)ì„ ì¶”ì •</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">clean_data_subset</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="sh">'</span><span class="s">Blood Glucose</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">BMI</span><span class="sh">'</span><span class="p">]]</span> <span class="c1"># íŠ¹ì„±ë²¡í„° ì§€ì •
</span><span class="n">y</span> <span class="o">=</span> <span class="n">clean_data_subset</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="sh">'</span><span class="s">Class</span><span class="sh">'</span><span class="p">]</span> <span class="c1">#ë ˆì´ë¸” ì§€ì •
</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> 
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1">#ë°ì´í„°ì…‹ í›ˆë ¨ìš©ê³¼ í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ë‚˜ëˆ„ê¸°
</span>
<span class="n">X_train0</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">y_train</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span> 
<span class="n">X_train1</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">y_train</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="n">m0</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_train</span><span class="o">==</span><span class="mi">0</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span>
<span class="n">m1</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_train</span><span class="o">==</span><span class="mi">1</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span> <span class="c1">#classë³„ ê°¯ìˆ˜
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">hist</span><span class="p">(</span><span class="n">X_train0</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sh">'</span><span class="s">Blood Glucose</span><span class="sh">'</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="sh">'</span><span class="s">fd</span><span class="sh">'</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">X_train0</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sh">'</span><span class="s">Blood Glucose</span><span class="sh">'</span><span class="p">].</span><span class="n">plot</span><span class="p">.</span><span class="nf">density</span><span class="p">()</span> <span class="c1">#p(x1|0)
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">hist</span><span class="p">(</span><span class="n">X_train0</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sh">'</span><span class="s">BMI</span><span class="sh">'</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="sh">'</span><span class="s">fd</span><span class="sh">'</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">X_train0</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sh">'</span><span class="s">BMI</span><span class="sh">'</span><span class="p">].</span><span class="n">plot</span><span class="p">.</span><span class="nf">density</span><span class="p">()</span>   <span class="c1">#p(x2|0)
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">hist</span><span class="p">(</span><span class="n">X_train1</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sh">'</span><span class="s">Blood Glucose</span><span class="sh">'</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="sh">'</span><span class="s">fd</span><span class="sh">'</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">X_train1</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sh">'</span><span class="s">Blood Glucose</span><span class="sh">'</span><span class="p">].</span><span class="n">plot</span><span class="p">.</span><span class="nf">density</span><span class="p">()</span>  <span class="c1">#p(x1|1)
</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">hist</span><span class="p">(</span><span class="n">X_train1</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sh">'</span><span class="s">BMI</span><span class="sh">'</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="sh">'</span><span class="s">fd</span><span class="sh">'</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">X_train1</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span><span class="sh">'</span><span class="s">BMI</span><span class="sh">'</span><span class="p">].</span><span class="n">plot</span><span class="p">.</span><span class="nf">density</span><span class="p">()</span> <span class="c1">#p(x2|1)
</span>
<span class="c1"># bins='fd' ëŠ” Freeman-Diaconis ruleì— ì˜í•´ ê°€ì¥ ë¶„í¬ë¥¼ ì˜ ë³´ì—¬ì£¼ëŠ” binì˜ ê°¯ìˆ˜ë¥¼ ê²°ì •í•œë‹¤. 
# X ë³€ìˆ˜ì™€ y ë ˆì´ë¸”ì— ë”°ë¼ ë¶„í¬ê°€ íˆìŠ¤í† ê·¸ë¨ì´ ì–´ë–»ê²Œ ê·¸ë ¤ì§€ëŠ”ì§€ íŒŒì•…í•œë‹¤. 
</span>
</code></pre></div></div>

<ul>
  <li>ìœ„ íˆìŠ¤í† ê·¸ë¨ì„ ë³´ê³  ì™„ë²½í•˜ê²Œ ê°™ì§„ ì•Šì§€ë§Œ ì •ê·œë¶„í¬ë¼ê³  ê°€ì •í•˜ê³  í™•ë¥ í•¨ìˆ˜ë¥¼ ê³„ì‚°í•´ë³´ì</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fit_distribution</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">col_idx</span><span class="p">):</span>
    <span class="c1">#ì •ê·œë¶„í¬ì˜ í‰ê· ê³¼ í‘œì¤€í¸ì°¨ë¥¼ ì¶”ì • S
</span>    <span class="n">mu</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="n">col_idx</span><span class="p">].</span><span class="nf">mean</span><span class="p">()</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="n">col_idx</span><span class="p">].</span><span class="nf">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#pd.Series.std(ddof=0)ì€ í‘œì¤€í¸ì°¨/ 
</span>    								 <span class="c1">#pd.Series.std(ddof=1)ì€ í‘œë³¸í‘œì¤€í¸ì°¨(default)    
</span>    
    <span class="c1"># í™•ë¥ ë¶„í¬ êµ¬í•˜ê¸° 
</span>    <span class="n">dist</span> <span class="o">=</span> <span class="nf">norm</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dist</span>

<span class="n">X_train0</span> <span class="o">=</span> <span class="n">X_train0</span><span class="p">.</span><span class="nf">to_numpy</span><span class="p">()</span> <span class="c1">#í›ˆë ¨ë°ì´í„°ë¥¼ Numpy arrayë¡œ ë°”ê¾¼ë‹¤. 
</span><span class="n">X_train1</span> <span class="o">=</span> <span class="n">X_train1</span><span class="p">.</span><span class="nf">to_numpy</span><span class="p">()</span>

<span class="n">distX1y0</span> <span class="o">=</span> <span class="nf">fit_distribution</span><span class="p">(</span><span class="n">X_train0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">#'Blood Glucose'
</span><span class="n">distX2y0</span> <span class="o">=</span> <span class="nf">fit_distribution</span><span class="p">(</span><span class="n">X_train0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#'BMI'
</span><span class="n">distX1y1</span> <span class="o">=</span> <span class="nf">fit_distribution</span><span class="p">(</span><span class="n">X_train1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">#'Blood Glucose'
</span><span class="n">distX2y1</span> <span class="o">=</span> <span class="nf">fit_distribution</span><span class="p">(</span><span class="n">X_train1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#'BMI'
</span>
<span class="n">prior0</span> <span class="o">=</span> <span class="n">m0</span><span class="o">/</span><span class="p">(</span><span class="n">m0</span><span class="o">+</span><span class="n">m1</span><span class="p">)</span>
<span class="n">prior1</span> <span class="o">=</span> <span class="n">m1</span><span class="o">/</span><span class="p">(</span><span class="n">m0</span><span class="o">+</span><span class="n">m1</span><span class="p">)</span> <span class="c1">#ì‚¬ì „í™•ë¥ 
</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">P(y=1)=</span><span class="si">{</span><span class="n">prior1</span><span class="si">:</span><span class="p">.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s">, P(y=0)=</span><span class="si">{</span><span class="n">prior0</span><span class="si">:</span><span class="p">.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span> <span class="c1">#P(y=1)=0.361, P(y=0)=0.639
</span>
<span class="c1">#p(x,0)=p(0)p(x1|0)p(x2|0) ì™€  p(x,1)=p(1)p(x1|1)p(x2|1) ì„ ê³„ì‚°
</span><span class="k">def</span> <span class="nf">joint_prob</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">distX0</span><span class="p">,</span> <span class="n">distX1</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">prior</span> <span class="o">*</span> <span class="n">distX0</span><span class="p">.</span><span class="nf">pdf</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">distX1</span><span class="p">.</span><span class="nf">pdf</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> 

<span class="c1"># í›ˆë ¨ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì˜ˆì¸¡ 
</span><span class="n">train_prob0</span> <span class="o">=</span> <span class="nf">joint_prob</span><span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="nf">to_numpy</span><span class="p">(),</span> <span class="n">prior0</span><span class="p">,</span> <span class="n">distX1y0</span><span class="p">,</span><span class="n">distX2y0</span><span class="p">)</span>
<span class="n">train_prob1</span> <span class="o">=</span> <span class="nf">joint_prob</span><span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="nf">to_numpy</span><span class="p">(),</span> <span class="n">prior1</span><span class="p">,</span> <span class="n">distX1y1</span><span class="p">,</span><span class="n">distX2y1</span><span class="p">)</span>

<span class="n">train_prediction</span> <span class="o">=</span> <span class="p">(</span><span class="n">train_prob1</span><span class="o">&gt;</span><span class="n">train_prob0</span><span class="p">).</span><span class="nf">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># ì •í™•ë„ ê³„ì‚°
</span><span class="n">train_acc</span> <span class="o">=</span> <span class="p">(</span><span class="n">train_prediction</span> <span class="o">==</span> <span class="n">y_train</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span><span class="o">/</span><span class="nf">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">í›ˆë ¨ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì •í™•ë„=</span><span class="si">{</span><span class="n">train_acc</span> <span class="o">*</span> <span class="mi">100</span> <span class="si">:</span> <span class="p">.</span><span class="mi">1</span><span class="n">f</span><span class="si">}</span><span class="s">%</span><span class="sh">"</span><span class="p">)</span>
<span class="c1">#í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì •í™•ë„= 77.5%
</span>
<span class="c1"># í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì˜ˆì¸¡ 
</span><span class="n">test_prob0</span> <span class="o">=</span> <span class="nf">joint_prob</span><span class="p">(</span><span class="n">X_test</span><span class="p">.</span><span class="nf">to_numpy</span><span class="p">(),</span> <span class="n">prior0</span><span class="p">,</span> <span class="n">distX1y0</span><span class="p">,</span><span class="n">distX2y0</span><span class="p">)</span>
<span class="n">test_prob1</span> <span class="o">=</span> <span class="nf">joint_prob</span><span class="p">(</span><span class="n">X_test</span><span class="p">.</span><span class="nf">to_numpy</span><span class="p">(),</span> <span class="n">prior1</span><span class="p">,</span> <span class="n">distX1y1</span><span class="p">,</span><span class="n">distX2y1</span><span class="p">)</span>

<span class="n">test_prediction</span> <span class="o">=</span> <span class="p">(</span><span class="n">test_prob1</span><span class="o">&gt;</span><span class="n">test_prob0</span><span class="p">).</span><span class="nf">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># ì •í™•ë„ ê³„ì‚°
</span><span class="n">test_acc</span> <span class="o">=</span> <span class="p">(</span><span class="n">test_prediction</span> <span class="o">==</span> <span class="n">y_test</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span><span class="o">/</span><span class="nf">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì •í™•ë„=</span><span class="si">{</span><span class="n">test_acc</span> <span class="o">*</span> <span class="mi">100</span> <span class="si">:</span> <span class="p">.</span><span class="mi">1</span><span class="n">f</span><span class="si">}</span><span class="s">%</span><span class="sh">"</span><span class="p">)</span>

<span class="c1">#í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì •í™•ë„= 77.5%
</span></code></pre></div></div>

<p><br /></p>

<h3 id="scikit-learnì˜-ë‚˜ì´ë¸Œ-ë² ì´ì¦ˆ-ë¶„ë¥˜ê¸°-ì‚¬ìš©í•˜ê¸°">Scikit-learnì˜ ë‚˜ì´ë¸Œ ë² ì´ì¦ˆ ë¶„ë¥˜ê¸° ì‚¬ìš©í•˜ê¸°</h3>

<ul>
  <li>sklearn.naive_bayes moduleì˜ GaussianNBê°€ $p(X|y)$ ë¥¼ ì •ê·œë¶„í¬ë¡œ ê°€ì •í•˜ëŠ” ë‚˜ì´ë¸Œ ë² ì´ì¦ˆ ë¶„ë¥˜ê¸°</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span> <span class="c1">#GaussianNB ë¶„ë¥˜ê¸° ë¶ˆëŸ¬ì˜¤ê¸°
</span>
<span class="n">classifierGNB</span> <span class="o">=</span> <span class="nc">GaussianNB</span><span class="p">()</span>
<span class="n">classifierGNB</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span> <span class="c1">#í›ˆë ¨
</span>
<span class="n">train_acc</span> <span class="o">=</span> <span class="n">classifierGNB</span><span class="p">.</span><span class="nf">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span> <span class="c1">#í›ˆë ¨ì…‹ì˜ ì •í™•ë„
</span><span class="n">test_acc</span> <span class="o">=</span> <span class="n">classifierGNB</span><span class="p">.</span><span class="nf">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span> <span class="c1">#í…ŒìŠ¤íŠ¸ì…‹ì˜ ì •í™•ë„
</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Prediction Accuracy for Train Data set:</span><span class="si">{</span><span class="n">train_acc</span> <span class="si">:</span><span class="p">.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="se">\n</span><span class="s">Prediction Accuracy for Test Data set:</span><span class="si">{</span><span class="n">test_acc</span> <span class="si">:</span><span class="p">.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="c1">#Prediction Accuracy for Train Data set:0.757
#Prediction Accuracy for Test Data set:0.775
</span>
<span class="n">classifierGNB</span><span class="p">.</span><span class="nf">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
<span class="c1">#array([[0.5866136 , 0.4133864 ],[0.32890518, 0.67109482],[0.55879185, 0.44120815],[0.93848913, 0.06151087],[0.89546209, 0.10453791]])
</span></code></pre></div></div>

<h3 id="ë¶„ë¥˜ë¬¸ì œì—-ëŒ€í•œ-í•™ìŠµëª¨ë¸ì˜-ì„±ëŠ¥-í‰ê°€-ê¸°ì¤€">ë¶„ë¥˜ë¬¸ì œì— ëŒ€í•œ í•™ìŠµëª¨ë¸ì˜ ì„±ëŠ¥ í‰ê°€ ê¸°ì¤€</h3>

<ul>
  <li>
    <p>í•™ìŠµëª¨ë¸ ì„±ëŠ¥í‰ê°€ ê¸°ì¤€ìœ¼ë¡œ ì •í™•ë„ë¥¼ ì´ìš©í–ˆì§€ë§Œ ê²½ìš°ì— ë”°ë¼ ë‹¤ë¥¸ ê¸°ì¤€ì´ ì˜ë¯¸ë¥¼ ê°€ì§„ë‹¤.</p>

    <blockquote>
      <p>ì˜ˆ) ì„ìƒìë£Œë¥¼ ì´ìš©í•˜ì—¬ í™˜ìê°€ íŠ¹ì • í¬ê·€ ì•”ì— ê±¸ë ¸ëŠ”ì§€(ì–‘ì„±: ë ˆì´ë¸”1 ,ìŒì„±: ë ˆì´ë¸”2)ë¥¼ ë¶„ë¥˜í•˜ëŠ” í•™ìŠµ ëª¨ë¸ì˜ ê²½ìš° ì •í™•ë„ëŠ” ì¢‹ì€ ëª¨ë¸ì˜ ì¸¡ë„ë¡œ ì í•©í•˜ì§€ ì•ŠìŒ</p>

      <p>100ëª… ì¤‘ í•œ ëª…ì´ ì•”ì— ê±¸ë¦° ê²½ìš°, ëª¨ë“  í™˜ìê°€ ìŒì„±ì´ë¼ê³  íŒë³„í•˜ëŠ” í•™ìŠµëª¨ë¸ì˜ ê²½ìš° ì •í™•ë„ëŠ” 99%ì§€ë§Œ ì“¸ëª¨ì—†ëŠ” í•™ìŠµëª¨ë¸ì„</p>
    </blockquote>
  </li>
  <li>
    <p>ë¶„ë¥˜ê¸°ì˜ ì„±ëŠ¥ì„ í‰ê°€í•˜ëŠ” ì¢‹ì€ ë°©ë²•ì€ ì˜¤ì°¨í–‰ë ¬(Confusion matrix) ë˜í•œ ì´ë¥¼ ìš”ì•½í•œ ì§€í‘œë¥¼ ì‚´í´ë³´ëŠ” ê²ƒì´ë‹¤.</p>
  </li>
</ul>

<p>Reference:</p>

<ul>
  <li>
    <p>ê¸°ê³„í•™ìŠµ_í•˜ê¸¸ì°¬ êµìˆ˜ë‹˜ ìˆ˜ì—…ì„ ë°”íƒ•ìœ¼ë¡œ ê³µë¶€í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><a href="https://bkshin.tistory.com/entry/%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D-1%EB%82%98%EC%9D%B4%EB%B8%8C-%EB%B2%A0%EC%9D%B4%EC%A6%88-%EB%B6%84%EB%A5%98-Naive-Bayes-Classification">ê·€í‰ì´ ì„œì¬ë‹˜ì˜ ë‚˜ì´ë¸Œ ë² ì´ì¦ˆ ë¶„ë¥˜</a></p>
  </li>
  <li>
    <p><a href="https://blogyong.tistory.com/33">Generative modelê³¼ Discriminate model, BLOG_ìš©ì´</a></p>
  </li>
</ul>

:ET