I"›„<h2 id="ê²½ì‚¬-í•˜ê°•ë²•-ì‹¤ìŠµ">ê²½ì‚¬ í•˜ê°•ë²• ì‹¤ìŠµ</h2>

<ul>
  <li>
    <p>$Y=4+3X+\epsilon$ ($0\le X \le 2$)ë¥¼ ë”°ë¥´ëŠ” ìƒ˜í”Œ 100ê°œë¥¼ ìƒì„±í•œ í›„ ì„ í˜•íšŒê·€ë¥¼ ì ìš©</p>
  </li>
  <li>
    <p>SVDë¥¼ ì´ìš©í•œ ì„ í˜•íšŒê·€ì¸ LinearRegression, SGDë¥¼ ì´ìš©í•œ ì„ í˜•íšŒê·€ì¸ SGDRegressor, ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•, ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•ì„ ë¹„êµ ì‹¤ìŠµ</p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë°ì´í„° ìƒ˜í”Œ ìƒì„± 
</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span> 
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDRegressor</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span> 
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="c1">#ëœë¤ì‹œë“œ ê³ ì •
</span>
<span class="n">X</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#0~1ì˜ ê· ì¼ë¶„í¬ í‘œì¤€ì •ê·œë¶„í¬ ë‚œìˆ˜ë¥¼ matrix array(m,n) ìƒì„±
</span><span class="n">y</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">X</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#í‰ê· 0, í‘œì¤€í¸ì°¨1ì˜ ê°€ìš°ì‹œì•ˆ í‘œì¤€ì •ê·œë¶„í¬ ë‚œìˆ˜ë¥¼ matrix array(m,n) ìƒì„±
</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="s">'b.'</span><span class="p">)</span> <span class="c1">#íŒŒë€ìƒ‰ìœ¼ë¡œ ì‚°ì ë„ ê·¸ë¦¬ê¸°
</span><span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"$x_1$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"$y$"</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span> <span class="c1">#plt.axis([xmin,xmax,ymin,ymax]) 
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ê° íŠ¹ì„±ë²¡í„°ì˜ ì²« ë²ˆì§¸ ì¢Œí‘œì— biasì— ëŒ€ì‘ë˜ëŠ” 1ì„ ì¶”ê°€í•˜ì—¬ Xbë¡œ ìˆ˜ì • 
# ì—¬ëŸ¬ ê°€ì§€ ê²½ì‚¬ í•˜ê°•ë²•ì„ ì§ì ‘ êµ¬í˜„í•´ ë³¼ ë•Œ ì‚¬ìš©
</span>
<span class="n">Xb</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">X</span><span class="p">))</span>  <span class="c1">##ë°°ì—´ì„ ì—´ë¡œ ë§Œë“¤ì–´ì„œ ë¶™ì´ê¸°
</span>
<span class="n">X_new</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">Xb_new</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">X_new</span><span class="p">))</span>
</code></pre></div></div>

<h3 id="linearregression">LinearRegression</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n_reg_svd</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span> 
<span class="n">lin_reg_svd</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">theta_svd</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">lin_reg_svd</span><span class="p">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">lin_reg_svd</span><span class="p">.</span><span class="n">coef_</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="c1">#intercept_: í¸í–¥, coef_: ê°€ì¤‘ì¹˜
</span><span class="n">theta_svd</span> 

<span class="c1">#array([[3.8115615 ],
</span>       <span class="p">[</span><span class="mf">3.23892352</span><span class="p">]])</span>
       
<span class="n">y_predict_svd</span> <span class="o">=</span> <span class="n">lin_reg_svd</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
<span class="n">y_predict_svd</span>

<span class="c1">#array([[ 3.8115615 ],
</span>       <span class="p">[</span><span class="mf">10.28940854</span><span class="p">]])</span>
    
<span class="c1"># ëª¨ë¸ì˜ ì˜ˆì¸¡ì„ ê·¸ë˜í”„ì— ë‚˜íƒ€ë‚´ê¸° 
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">'b.'</span><span class="p">)</span> <span class="c1">#íŒŒë€ìƒ‰ ì ìœ¼ë¡œ ì‚°ì ë„
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="n">y_predict_svd</span><span class="p">,</span> <span class="s">'r-'</span><span class="p">)</span> <span class="c1">#ë¹¨ê°„ìƒ‰ ì„ ìœ¼ë¡œ íšŒê·€ì§ì„  ê·¸ë¦¬ê¸°
</span><span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"$x_1$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1">#xì¢Œí‘œì¶•
</span><span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"$y$"</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1">#yì¢Œí‘œì¶•
</span><span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span> 
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Linear regression with SVD"</span><span class="p">)</span> <span class="c1">#ì œëª©
</span></code></pre></div></div>

<h3 id="ë°°ì¹˜-ê²½ì‚¬-í•˜ê°•ë²•_-ì§ì ‘-êµ¬í˜„">ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•_ ì§ì ‘ êµ¬í˜„</h3>

<ul>
  <li>ê·¸ë˜ë””ì–¸íŠ¸ë¥¼ êµ¬í•˜ëŠ” ì‹ â€” (2)</li>
</ul>

\[(\nabla_ L({\theta})) = \dfrac 2 m \mathbf X^{\rm T}(\mathbf X{\theta}-\mathbf y)=\mathbf 0\]

<ul>
  <li>${\theta}$ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ì‹ â€” (3)</li>
</ul>

\[{\theta}^{(t+1)}:= {\theta}^{(t)}-\alpha \nabla_L({\theta}^{(t)})\ (t\ge 0)\]

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eta</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># í•™ìŠµë¥  
</span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># epoch ìˆ˜ 
</span><span class="n">m</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># ìƒ˜í”Œìˆ˜ 
</span>
<span class="n">theta_bgd</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># ë¬´ì‘ìœ„ë¡œ theta ì´ˆê¹ƒê°’ ì„¤ì • 
</span>
<span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">):</span>
    <span class="n">gradients</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">m</span> <span class="o">*</span> <span class="n">Xb</span><span class="p">.</span><span class="n">T</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Xb</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">theta_bgd</span><span class="p">)</span> <span class="o">-</span><span class="n">y</span><span class="p">)</span>   <span class="c1"># ì„¤ëª…ì˜ ì‹ (2) êµ¬í˜„
</span>    <span class="n">theta_bgd</span> <span class="o">=</span> <span class="n">theta_bgd</span> <span class="o">-</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">gradients</span>                <span class="c1"># ì„¤ëª…ì˜ ì‹ (3) êµ¬í˜„ 
</span>    
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"theta_bgd:</span><span class="se">\n</span><span class="s"> </span><span class="si">{</span><span class="n">theta_bgd</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"theta_svd:</span><span class="se">\n</span><span class="s"> </span><span class="si">{</span><span class="n">theta_svd</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="c1">#theta_bgd:
</span> <span class="p">[[</span><span class="mf">3.8115615</span> <span class="p">]</span>
 <span class="p">[</span><span class="mf">3.23892352</span><span class="p">]]</span>

<span class="c1">#theta_svd:
</span> <span class="p">[[</span><span class="mf">3.8115615</span> <span class="p">]</span>
 <span class="p">[</span><span class="mf">3.23892352</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_predict_bgd</span> <span class="o">=</span> <span class="n">Xb_new</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">theta_bgd</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">'b.'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="n">y_predict_bgd</span><span class="p">,</span> <span class="s">'r-'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"$x_1$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"$y$"</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">"Linear regression with BGD (learning rate=</span><span class="si">{</span><span class="n">eta</span><span class="si">}</span><span class="s">)"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="í™•ë¥ ì -ê²½ì‚¬-í•˜ê°•ë²•_-ì§ì ‘-êµ¬í˜„">í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•_ ì§ì ‘ êµ¬í˜„</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">theta_sgd_path</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">t0</span><span class="p">,</span> <span class="n">t1</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span>  <span class="c1"># í•™ìŠµ ìŠ¤ì¼€ì¤„ í•˜ì´í¼íŒŒë¼ë¯¸í„° 
</span><span class="n">m</span> <span class="o">=</span> <span class="mi">100</span>         <span class="c1"># ìƒ˜í”Œ ìˆ˜ 
</span>
<span class="k">def</span> <span class="nf">learning_schedule</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="c1">#í•™ìŠµë¥  ì„¤ì •
</span>    <span class="k">return</span> <span class="n">t0</span><span class="o">/</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="n">t1</span><span class="p">)</span>

<span class="n">theta_sgd</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># theta ë¬´ì‘ìœ„ ì´ˆê¸°í™” 
</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">random_idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="c1">#0~m-1 ì‚¬ì´ ì •ìˆ˜ í•˜ë‚˜ ë°˜í™˜, sizeë¡œ ë°˜í™˜ ê°¯ìˆ˜ ì„¤ì • ê°€ëŠ¥
</span>        <span class="n">tx</span> <span class="o">=</span> <span class="n">Xb</span><span class="p">[</span><span class="n">random_idx</span><span class="p">:</span><span class="n">random_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ty</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">random_idx</span><span class="p">:</span><span class="n">random_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#ëœë¤í•˜ê²Œ í•œ ì  ì„ íƒ
</span>        <span class="n">gradients</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tx</span><span class="p">.</span><span class="n">T</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tx</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">theta_sgd</span><span class="p">)</span> <span class="o">-</span> <span class="n">ty</span><span class="p">)</span>
        <span class="n">eta</span> <span class="o">=</span> <span class="n">learning_schedule</span><span class="p">(</span><span class="n">epoch</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">theta_sgd</span> <span class="o">=</span> <span class="n">theta_sgd</span> <span class="o">-</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">gradients</span>
        <span class="n">theta_sgd_path</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta_sgd</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="í™•ë¥ ì -ê²½ì‚¬-í•˜ê°•ë²•-ê·¸ë¦¼ìœ¼ë¡œ-í•™ìŠµ-ê³¼ì •-íŒŒì•…í•˜ê¸°">í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²• ê·¸ë¦¼ìœ¼ë¡œ í•™ìŠµ ê³¼ì • íŒŒì•…í•˜ê¸°</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">theta_sgd</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># ëœë¤ ì´ˆê¸°í™”
</span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">):</span>
    <span class="n">y_predict_sgd</span> <span class="o">=</span> <span class="n">Xb_new</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">theta_sgd</span><span class="p">)</span>            
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>        
        <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="n">y_predict_sgd</span><span class="p">,</span> <span class="s">"m-"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="n">y_predict_sgd</span><span class="p">,</span> <span class="s">"g-"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
    <span class="n">random_idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">Xb</span><span class="p">[</span><span class="n">random_idx</span><span class="p">:</span><span class="n">random_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ty</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">random_idx</span><span class="p">:</span><span class="n">random_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">gradients</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tx</span><span class="p">.</span><span class="n">T</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tx</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">theta_sgd</span><span class="p">)</span> <span class="o">-</span> <span class="n">ty</span><span class="p">)</span>
    <span class="n">eta</span> <span class="o">=</span> <span class="n">learning_schedule</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">theta_sgd</span> <span class="o">=</span> <span class="n">theta_sgd</span> <span class="o">-</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">gradients</span>
    
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">"b."</span><span class="p">)</span>                                 
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"$x_1$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>                      
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"$y$"</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>           
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>     
</code></pre></div></div>

<h3 id="í™•ë¥ ì -ê²½ì‚¬-í•˜ê°•ë²•_-sklearnlinear_model-ëª¨ë“ˆì˜-sgdregressor-í™œìš©">í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•_ sklearn.linear_model ëª¨ë“ˆì˜ SGDRegressor í™œìš©</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sgd_reg</span> <span class="o">=</span> <span class="n">SGDRegressor</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">eta0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">sgd_reg</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">.</span><span class="n">ravel</span><span class="p">())</span> <span class="c1"># 2ì°¨ì› ë°°ì—´ yë¥¼ 1ì°¨ì› ë°°ì—´ë¡œ
</span>
<span class="n">sgd_reg</span><span class="p">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">sgd_reg</span><span class="p">.</span><span class="n">coef_</span>
<span class="c1">#(array([3.75972497]), array([3.16465032]))
</span></code></pre></div></div>

<h3 id="ë¯¸ë‹ˆë°°ì¹˜-ê²½ì‚¬-í•˜ê°•ë²•_ì§ì ‘-êµ¬í˜„">ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•_ì§ì ‘ êµ¬í˜„</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">theta_mgd_path</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">minibatch_size</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">theta_mgd</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># ëœë¤ ì´ˆê¸°í™”
</span>
<span class="n">t0</span><span class="p">,</span> <span class="n">t1</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">1000</span>
<span class="k">def</span> <span class="nf">learning_schedule</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">t0</span> <span class="o">/</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">t1</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">):</span>
    <span class="n">shuffled_indices</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">Xb_shuffled</span> <span class="o">=</span> <span class="n">Xb</span><span class="p">[</span><span class="n">shuffled_indices</span><span class="p">]</span>
    <span class="n">y_shuffled</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">shuffled_indices</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">minibatch_size</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">tx</span> <span class="o">=</span> <span class="n">Xb_shuffled</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">minibatch_size</span><span class="p">]</span>
        <span class="n">ty</span> <span class="o">=</span> <span class="n">y_shuffled</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">minibatch_size</span><span class="p">]</span>
        <span class="n">gradients</span> <span class="o">=</span> <span class="mi">2</span><span class="o">/</span><span class="n">minibatch_size</span> <span class="o">*</span> <span class="n">tx</span><span class="p">.</span><span class="n">T</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tx</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">theta_mgd</span><span class="p">)</span> <span class="o">-</span> <span class="n">ty</span><span class="p">)</span>
        <span class="n">eta</span> <span class="o">=</span> <span class="n">learning_schedule</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">theta_mgd</span> <span class="o">=</span> <span class="n">theta_mgd</span> <span class="o">-</span> <span class="n">eta</span> <span class="o">*</span> <span class="n">gradients</span>
        <span class="n">theta_mgd_path</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta_mgd</span><span class="p">)</span>
        
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"theta_mgd:</span><span class="se">\n</span><span class="s"> </span><span class="si">{</span><span class="n">theta_mgd</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="c1">#theta_mgd:
</span> <span class="p">[[</span><span class="mf">3.80536591</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">3.25424808</span><span class="p">]]</span>
</code></pre></div></div>

<h3 id="ì¼ë°˜í™”-ì˜¤ì°¨ì—-ëŒ€í•œ-í¸í–¥-ë¶„ì‚°-ë¶„í•´">ì¼ë°˜í™” ì˜¤ì°¨ì— ëŒ€í•œ í¸í–¥-ë¶„ì‚° ë¶„í•´</h3>

<ul>
  <li>
    <p>ë™ì¼í•œ í•™ìŠµëª¨ë¸ì´ë¼ë„ ì„œë¡œ ë‹¤ë¥¸ í›ˆë ¨ ë°ì´í„°ì…‹ì„ í†µí•´ í•™ìŠµí•œ ê²°ê³¼ëŠ” ë‹¤ë¥¼ ìˆ˜ ìˆìŒ (í›ˆë ¨ ìƒ˜í”Œì´ ê°™ì€ ë¶„í¬ì—ì„œ ìƒ˜í”Œë§ ëœ ê²½ìš°ë¼ë„ ë§ˆì°¬ê°€ì§€)</p>
  </li>
  <li>
    <p>ê²€ì¦ ë°ì´í„°ì…‹ì„ í†µí•´ í•™ìŠµëª¨ë¸ì˜ ì¼ë°˜í™” ì„±ëŠ¥ì„ ì˜ˆì¸¡í•  ë•Œ, ì™œ ì´ëŸ° ì„±ëŠ¥ì„ ì–»ê²Œ ë˜ì—ˆëŠ”ì§€ë¥¼ ë¶„ì„í•˜ê¸° ìœ„í•´ì„œ <strong>í¸í–¥-ë¶„ì‚° ë¶„í•´(bias-variance decomposition)</strong>ë¥¼ ì´í•´í•˜ëŠ” ê²ƒì´ í•„ìš”í•¨</p>
  </li>
  <li>
    <p>íšŒê·€ë¬¸ì œì—ì„œ ë°ì´í„°ì…‹ $D$ì˜ ìƒ˜í”Œ $\mathbf x$ì— ëŒ€ì‘ë˜ëŠ” ì‹¤ì œ ë ˆì´ë¸”ì„ $y_{\text{r}}$, ì •ë‹µ ë ˆì´ë¸”ì„ $y_{D}$, $D$ì˜ í›ˆë ¨ ë°ì´í„°ì…‹ì— ì˜í•´ í•™ìŠµëœ ëª¨ë¸ì˜ ì˜ˆì¸¡ ë ˆì´ë¸”ì„ $f(\mathbf x;D)$ë¼ê³  ë‚˜íƒ€ë‚´ì. (ì£¼ì–´ì§„ ë°ì´í„°ì…‹ì˜ ì¼ë¶€ëŠ” í›ˆë ¨ ë°ì´í„°ì…‹, ë‚˜ë¨¸ì§€ëŠ” í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹)</p>

\[ì¦‰, y_{D}= y_{\text{r}}+\text{noise}\]
  </li>
</ul>

<p>&gt; * ë°ì´í„° ìƒ˜í”Œë¡œ ì£¼ì–´ì§€ëŠ” ê²ƒì€ $(\mathbf x,y_{D})$ì´ê³  í¸ì˜ìƒ $\text{E}(y_{D})=y_{r}$ì´ë¼ ê°€ì • (ì´ë•Œ, ê¸°ëŒ“ê°’ì€ ì„œë¡œ ë‹¤ë¥¸ ë°ì´í„°ì…‹ì— ëŒ€í•œ í‰ê· )</p>

<p>&gt; * ê²€ì¦(ë˜ëŠ” í…ŒìŠ¤íŠ¸) ìƒ˜í”Œ $\mathbf x$ì— ëŒ€í•´, ë˜‘ê°™ì€ ìƒ˜í”Œ ìˆ˜ì˜ ì„œë¡œ ë‹¤ë¥¸ í›ˆë ¨ ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì–»ì–´ì§„ ë¶„ì‚° $ \text{E}<em>D ((f(\mathbf x;  D)-y</em>{D})^2)$ìœ¼ë¡œ í•™ìŠµ ëª¨ë¸ $f$ì— ëŒ€í•œ ì¼ë°˜í™”ëœ ì˜¤ì°¨ë¥¼ ì´í•´í•´ë³´ì.</p>

<ul>
  <li>$\bar f(\mathbf x)=\text{E}_D(f(\mathbf x;D))$ë¼ í•  ë•Œ,</li>
</ul>

\[\text{E}_D((f(\mathbf x;D)-y_D)^2) =\text{E}_D((f(\mathbf x;D)-\bar f(\mathbf x))^2)+(\bar f(\mathbf x)-y_{\text{r}})^2+\text{E}_D((y_{\text{r}}-y_D)^2)\]

<p>ìœ„ ì‹ê³¼ ê°™ì´ ì¼ë°˜í™”ëœ ì˜¤ì°¨ë¥¼ ë¶„í•´í•˜ëŠ” ê²ƒì„ í¸í–¥-ë¶„ì‚°(-ë…¸ì´ì¦ˆ) ë¶„í•´ë¼ê³  í•¨.</p>

<ul>
  <li>
    <p>ë¶„í•´ì‹ì˜ ì²«ë²ˆì§¸ëŠ” ìƒ˜í”Œ xì— ëŒ€í•œ í•™ìŠµ ëª¨ë¸ $f$ ì˜ ì˜ˆì¸¡ì— ëŒ€í•œ <strong>ë¶„ì‚°</strong></p>
  </li>
  <li>
    <p>ë‘ë²ˆì§¸ëŠ” ìƒ˜í”Œ xì— ëŒ€í•œ í•™ìŠµ ëª¨ë¸ $f$ ì˜ ì˜ˆì¸¡ì— ëŒ€í•œ <strong>í¸í–¥</strong></p>
  </li>
  <li>
    <p>ì„¸ë²ˆì§¸ëŠ” <strong>ë…¸ì´ì¦ˆ</strong></p>

    <blockquote>
      <ul>
        <li>ë¶„ì‚°ì€ í¬ê¸°ê°€ ê°™ì€ í›ˆë ¨ ë°ì´í„°ì…‹ì´ ë°”ë€” ë•Œ ë°œìƒí•˜ëŠ” ì„±ëŠ¥ì˜ ë³€í™”ë¥¼ ë‚˜íƒ€ëƒ„</li>
        <li>í¸í–¥ì€ í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì˜ ê¸°ëŒ€ ì˜ˆì¸¡ê°’ì´ ì‹¤ì œ ë°ì´í„°ì—ì„œ ë–¨ì–´ì§„ ì •ë„ë¥¼ ë‚˜íƒ€ë‚´ê³ , í•™ìŠµ ëª¨ë¸ì˜ ì í•© ëŠ¥ë ¥ì„ ë‚˜íƒ€ëƒ„</li>
        <li>ë…¸ì´ì¦ˆëŠ” ì–´ë–¤ í•™ìŠµ ëª¨ë¸ì„ ì‚¬ìš©í•˜ë”ë¼ë„ ê·¹ë³µí•  ìˆ˜ ì—†ëŠ” ì¼ë°˜í™”ì˜ ì˜¤ì°¨ì˜ í•˜ê³„ë¥¼ ëœ»í•¨. ì¦‰ í•™ìŠµì˜ ë³¸ì§ˆì  ì–´ë ¤ì›€ì„ ë‚˜íƒ€ëƒ„</li>
      </ul>
    </blockquote>
  </li>
  <li>
    <p>ì¼ë°˜ì ìœ¼ë¡œ í¸í–¥ê³¼ ë¶„ì‚°ì€ ìƒì¶© ê´€ê³„ì— ìˆìŒ(í¸í–¥ê³¼ ë¶„ì‚°ì˜ ë”œë ˆë§ˆ)</p>
  </li>
  <li>ê³¼ì†Œì í•© ì´ë©´ í¸í–¥ì´ í° ê²ƒ; ëª¨ë¸ì„ ì˜ëª» ì„¤ì •(ê°€ì •)í–ˆê¸° ë•Œë¬¸ì— í¸í–¥ì´ ì»¤ì§„ë‹¤.</li>
  <li>
    <p>ê³¼ëŒ€ì í•©ì´ë©´ ë¶„ì‚°ì´ í° ê²ƒ; í•™ìŠµ ëª¨ë¸ì˜ ë³µì¡ë„ê°€ í¬ë‹¤ëŠ” ì˜ë¯¸ì™€ ê°™ìœ¼ë¯€ë¡œ í° ë¶„ì‚°ì„ ê°€ì§„ë‹¤.</p>
  </li>
  <li>
    <p>ë…¸ì´ì¦ˆëŠ” ì¤„ì¼ ìˆ˜ ì—†ëŠ” ì˜¤ì°¨; ë°ì´í„° ì •ì œ, ì¡ìŒ ì œê±° ë“±ì˜ ê³¼ì •ì´ í•„ìš”í•˜ë‹¤.</p>
  </li>
  <li>í›ˆë ¨ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì˜¤ì°¨ì™€ ê²€ì¦ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì˜¤ì°¨ê°€ ëª¨ë‘ í¬ë©´ ê³¼ì†Œì í•©ë˜ì—ˆì„ ê°€ëŠ¥ì„±ì´ í¬ë©°, ì´ ê²½ìš° í•™ìŠµ ëª¨ë¸ì˜ ë³µì¡ë„ë¥¼ ë†’ì´ëŠ” ê²ƒì´ ë„ì›€ì´ ëœë‹¤.</li>
  <li>í›ˆë ¨ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì˜¤ì°¨ë³´ë‹¤ ê²€ì¦ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì˜¤ì°¨ê°€ í¬ë©´ ê³¼ëŒ€ì í•©ë˜ì—ˆì„ ê°€ëŠ¥ì„±ì´ í¬ë©°, ê·œì œë¥¼ ì ìš©í•˜ë©´ ë„ì›€ì´ ëœë‹¤.</li>
</ul>

<p>Reference: ê¸°ê³„í•™ìŠµ_í•˜ê¸¸ì°¬ êµìˆ˜ë‹˜ ìˆ˜ì—…ì„ ë°”íƒ•ìœ¼ë¡œ ê³µë¶€í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p>
:ET