I"»İ<h2 id="ë¡œì§€ìŠ¤í‹±-íšŒê·€logistic-regression-ì˜-í•™ìŠµ-ëª¨ë¸">ë¡œì§€ìŠ¤í‹± íšŒê·€(Logistic Regression) ì˜ í•™ìŠµ ëª¨ë¸</h2>

<ul>
  <li>
    <p>ë ˆì´ë¸”ì´ 1, 0ì¸ ë‘ ê°œì˜ í´ë˜ìŠ¤ì— ëŒ€í•œ ë¶„ë¥˜ë¬¸ì œì—ì„œ ìƒ˜í”Œì´ íŠ¹ì • í´ë˜ìŠ¤ì— ì†í•  í™•ë¥ ì„ ì¶”ì •í•˜ëŠ” ì§€ë„í•™ìŠµì˜ í•œ ê°€ì§€</p>
  </li>
  <li>
    <p>ì„ í˜•íšŒê·€ ëª¨ë¸ê³¼ ê°™ì´ ì…ë ¥ íŠ¹ì„±ì˜ ê°€ì¤‘ì¹˜ì˜ í•©(í¸í–¥ í¬í•¨) $\theta^{\rm T}\mathbf x = \theta_0+\theta_1 x_1+\cdots +\theta_nx_n$ì„ ê³„ì‚°í•œ ë‹¤ìŒ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜(sigmoid) $\sigma(t)=\dfrac{1}{1+\exp(-t)}$ë¥¼ ì·¨í•œ ê°’ $\sigma (\theta^{\rm T} \mathbf x)$ë¥¼ ${\rm P}(Y=1 \mid X= \mathbf x)$ ì— ëŒ€í•œ ì¶”ì •ê°’ $\hat p(\mathbf x)$ë¡œ ì¶”ì •í•˜ëŠ” ëª¨ë¸.</p>
  </li>
  <li>
    <p>ì¦‰, ëª¨ë¸ íŒŒë¼ë¯¸í„° ${\theta}=(\theta_0,\cdots,\theta_n)^{\rm T}$ì— ëŒ€í•œ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì„ $h_{\theta}$ë¼ í•  ë•Œ</p>

\[\hat p(\mathbf x) = h_{\theta}(\mathbf x)= \sigma({\theta}^{\rm T}\mathbf x)
=\dfrac{1}{1+\exp(-{\theta}^{\rm T}\mathbf x)}=\dfrac{1}{1+\exp(-(\theta_0+\theta_1x_1+\cdots+\theta_n x_n))} \cdots(1)\]
  </li>
  <li>
    <p>ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ ìƒê°í•˜ëŠ” ì´ìœ :</p>

    <blockquote>
      <ul>
        <li>í™•ë¥  $0&lt;p&lt;1$ì— ëŒ€í•´ ì˜¤ì¦ˆ(odds) $\dfrac{p}{1-p}$ëŠ” $(0,\infty)$ì‚¬ì´ì˜ ê°’ì„ ê°€ì§€ë¯€ë¡œ ë¡œê·¸-ì˜¤ì¦ˆ(log-odds) ë˜ëŠ” ë¡œì§“ì´ë¼ ë¶€ë¥´ëŠ” $\ln \left(\dfrac{p}{1-p}\right)$ëŠ” $(-\infty, \infty)$ ì‚¬ì´ì˜ ê°’ì„ ê°€ì§</li>
        <li>ì´ ë¡œì§“ì„ ì„ í˜•ëª¨ë¸ë¡œ ì¶”ì •í•˜ëŠ” ê²ƒì´ ë¡œì§€ìŠ¤í‹± íšŒê·€ëª¨ë¸. ì¦‰, $\ln (\dfrac{p}{1-p})=\theta^{\rm T}\mathbf x$ìœ¼ë¡œë¶€í„° $p$ë¥¼ êµ¬í•˜ë©´ ì‹(1)ì´ ë‚˜ì˜´</li>
      </ul>
    </blockquote>
  </li>
  <li>
    <p>ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì„ í†µí•œ ë ˆì´ë¸”ì˜ ì˜ˆì¸¡:</p>

    <blockquote>
      <ul>
        <li>ìƒ˜í”Œ $\mathbf x$ê°€ ì–‘ì„± í´ë˜ìŠ¤(y=1)ì— ì†í•  í™•ë¥  $\hat p(\mathbf x)=h_{\theta}(\mathbf x)$ë¥¼ ì¶”ì •í•œ í›„ ë‹¤ìŒê³¼ ê°™ì´ ì˜ˆì¸¡ $\hat y$ë¥¼ êµ¬í•¨ 
\(\hat y = \begin{cases} 0 &amp; \text{ if  }&amp; \hat p(\mathbf x)&lt;0.5\\ 1 &amp;\text{ if }&amp; \hat p(\mathbf x)\ge0.5
\end{cases}\)</li>
      </ul>
    </blockquote>
  </li>
  <li></li>
</ul>

<h3 id="ì‹œê·¸ëª¨ì´ë“œ-í•¨ìˆ˜-ê·¸ë ¤ë³´ê¸°">ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ ê·¸ë ¤ë³´ê¸°</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span> 
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>

<span class="n">xlist</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">ylist</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">xlist</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlist</span><span class="p">,</span><span class="n">ylist</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s">"$\sigma (t)=\dfrac{1}{1+\exp(-t)}$"</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],</span> <span class="s">'r--'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s">'r--'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="s">'r--'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="s">'r--'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">"upper left"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/img/posts/ML9/sigmoid.png" alt="sigmoid" /></p>

<p><br /></p>

<h2 id="ë¡œì§€ìŠ¤í‹±-íšŒê·€ëª¨ë¸ì˜-í•™ìŠµ">ë¡œì§€ìŠ¤í‹± íšŒê·€ëª¨ë¸ì˜ í•™ìŠµ</h2>

<ul>
  <li>
    <p>í›ˆë ¨ ë°ì´í„°ì…‹ ${(\mathbf x_i,y_i) \mid1\le i \le m}$ì´ ì£¼ì–´ì§ˆ ë•Œ, ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ë˜ëŠ” ë¡œì§€ìŠ¤í‹± íšŒê·€ì˜ ë¹„ìš©í•¨ìˆ˜(ë¡œê·¸ì†ì‹¤ í•¨ìˆ˜) 
\(J(\theta) = -\dfrac 1 m \sum_{i=1}^m
(y_i \ln p_i + (1-y_i)\ln (1-p_i)) \\
(ë‹¨, p_i= \sigma({\theta}^{\rm T}\mathbf x_i)) \cdots (2)\)</p>

    <p>ê°€ ìµœì†Œê°€ ë˜ëŠ” ëª¨ë¸ íŒŒë¼ë¯¸í„° $\theta$ë¥¼ êµ¬í•˜ëŠ” ê²ƒ</p>

    <blockquote>
      <ul>
        <li>$\text{P}(Y_i=1 \mid X=\mathbf x_i)=p_i$ì´ë¯€ë¡œ $\text{P}(Y_i=0 \mid X=\mathbf x_i)=1-p_i$ì´ê³  í›ˆë ¨ ë°ì´í„°ì…‹ì€ iid í™•ë¥ ë³€ìˆ˜ $(X_i,Y_i)$ $(1\le i \le m)$ì— ëŒ€í•œ ê°’ì´ë¯€ë¡œ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì— ëŒ€í•œ ë¹„ìš©í•¨ìˆ˜ê°€ ìµœì†Œê°€ ë˜ëŠ” $\theta$ë¥¼ êµ¬í•˜ëŠ” ê²ƒì€ $\theta$ì— ëŒ€í•œ ë¡œê·¸ìš°ë„í•¨ìˆ˜ $\ell(\theta)= \ln(\text{P}(y_1,\cdots,y_m \mid \mathbf x_1,\cdots,\mathbf x_m:{\theta}))$ê°€ ìµœëŒ€ê°€ ë˜ëŠ” $\theta$ë¥¼ êµ¬í•˜ëŠ” ê²ƒê³¼ ê°™ë‹¤.</li>
      </ul>
    </blockquote>

\[\begin{align}
J(\theta)=&amp;  -\dfrac 1 m \ln\left(\prod_{i=1}^m p_i^{y_i} (1-p_i)^{(1-y_i)}\right) \\
=&amp; -\dfrac 1 m \ln\left(\text{P}(Y_1=y_1,\cdots,Y_m=y_m|X_1=\mathbf x_1,\cdots,X_m=\mathbf x_m :\theta\right)
\end{align}\]

    <ul>
      <li>ë¹„ìš©í•¨ìˆ˜ $J(\theta)$ëŠ” $\theta$ì— ëŒ€í•´ ì•„ë˜ë¡œ ë³¼ë¡í•œ í•¨ìˆ˜ì´ë¯€ë¡œ ìµœì†Ÿê°’ì´ ì¡´ì¬í•¨ì„ ë³´ì¥í•  ìˆ˜ ìˆì§€ë§Œ, ì •ê·œë°©ì •ì‹ì²˜ëŸ¼ í•´ë¥¼ êµ¬í•˜ëŠ” ê³µì‹ì€ ì—†ìŒ</li>
    </ul>

    <blockquote>
      <ul>
        <li>
          <p>ê²½ì‚¬í•˜ê°•ë²• ë˜ëŠ” ë‹¤ë¥¸ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•˜ì—¬ í•´ì˜ ê·¼ì‚¿ê°’ì„ êµ¬í•¨ (<code class="language-plaintext highlighter-rouge">sklearn.linear_model</code> ëª¨ë“ˆì˜ <code class="language-plaintext highlighter-rouge">LogisticRegression</code>ì˜ <code class="language-plaintext highlighter-rouge">solver</code>ì°¸ê³ )</p>
        </li>
        <li>
          <p>ë°°ì¹˜ ê²½ì‚¬í•˜ê°•ë²•ì„ ì ìš©í•  ë•Œ ë¹„ìš©í•¨ìˆ˜ì— ëŒ€í•œ ê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„° $\nabla_{\theta}J(\theta)$ : ê° $i$ ($1\le i\le m)$ì— ëŒ€í•´  $\nabla_\theta J(\theta)$ì˜ $j$ë²ˆì§¸ ì„±ë¶„ì€ 
\(\dfrac{\partial}{\partial \theta_j} J(\theta)= \dfrac 1 m \sum_{i=1}^m 
(\sigma({\theta}^{\rm T}\mathbf x_i)-y_i)x_{ij},\\ \mathbf x_i=(1,x_{i1},\cdots,x_{in})\)</p>
        </li>
      </ul>
    </blockquote>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">sklearn.linear_model</code> ëª¨ë“ˆì˜ <code class="language-plaintext highlighter-rouge">LogisticRegression</code> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html?highlight=logisticregression#sklearn.linear_model.LogisticRegression">API</a> ë˜ëŠ” í™•ë¥ ì  ê²½ì‚¬í•˜ê°•ë²•ì„ ì´ìš©í•˜ëŠ” <code class="language-plaintext highlighter-rouge">sklearn.linear_model</code> ëª¨ë“ˆì˜ <code class="language-plaintext highlighter-rouge">SGDClassifier</code> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html?highlight=sgdclassifier#sklearn.linear_model.SGDClassifier">API</a>ë¥¼ ì‚¬ìš©(ì´ ê²½ìš° <code class="language-plaintext highlighter-rouge">loss="log"</code>ë¡œ ì„¤ì •í•´ì•¼ ë¡œì§€ìŠ¤í‹± íšŒê·€)</p>

        <blockquote>
          <ul>
            <li>
              <p>ë‹¤ë¥¸ ì„ í˜•íšŒê·€ ëª¨ë¸ì²˜ëŸ¼ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ë„ $\ell_1$, $\ell_2$ ê·œì œí•­ì„ ì‚¬ìš©í•˜ì—¬ ê·œì œí•  ìˆ˜ ìˆìœ¼ë©° <code class="language-plaintext highlighter-rouge">LogisticRegression</code>ì€ $\ell_2$ í˜ë„í‹°ë¥¼ ê¸°ë³¸ìœ¼ë¡œ í•¨ (<code class="language-plaintext highlighter-rouge">penalty="l2"</code>, <code class="language-plaintext highlighter-rouge">penalty="none"</code>ê³¼ ê°™ì´ ì‚¬ìš©)</p>
            </li>
            <li>
              <p>ê·œì œê°€ ìˆëŠ” <code class="language-plaintext highlighter-rouge">SGDClassifier(loss='log')</code> ëª¨ë¸ì˜ ê²½ìš° ì„ í˜•íšŒê·€ ëª¨ë¸(<code class="language-plaintext highlighter-rouge">SGDRegressor</code>)ì˜ ê²½ìš°ì²˜ëŸ¼ ê·œì œë¥¼ ì¡°ì ˆí•˜ëŠ” í•˜ì´í¼íŒŒë¼ë¯¸í„°ê°€ <code class="language-plaintext highlighter-rouge">alpha</code>ì´ì§€ë§Œ, <code class="language-plaintext highlighter-rouge">LogisticRegression</code>ì˜ ê²½ìš°ì—ëŠ” <code class="language-plaintext highlighter-rouge">alpha</code>ì˜ ì—­ìˆ˜ì— í•´ë‹¹í•˜ëŠ” <code class="language-plaintext highlighter-rouge">C</code>ê°€ ê·œì œë¥¼ ì¡°ì ˆí•˜ëŠ” í•˜ì´í¼íŒŒë¼ë¯¸í„°</p>
            </li>
          </ul>

          <blockquote>
            <ul>
              <li>Cì˜ ê¸°ë³¸ê°’ì€ 1, Cê°€ ì»¤ì§€ë©´ ê·œì œê°€ ì‘ì•„ì§€ê³ , Cê°€ ì‘ì•„ì§€ë©´ ê·œì œê°€ ì»¤ì§</li>
            </ul>
          </blockquote>
        </blockquote>
      </li>
      <li>
        <p>ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ë¡œ LogisticRegressionì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°</p>

        <blockquote>
          <ul>
            <li>
              <p>ìµœì í™”ì— ì‚¬ìš©ë˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì€ <code class="language-plaintext highlighter-rouge">solver</code>ë¥¼ í†µí•´ ì„ íƒí•  ìˆ˜ ìˆìœ¼ë©° ê¸°ë³¸ê°’ì€ <code class="language-plaintext highlighter-rouge">solver="lbfgs"</code> (ì„ íƒí•œ í˜ë„í‹° í•­ì— ëŒ€í•´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì— ì œí•œì´ ìˆìœ¼ë¯€ë¡œ ìì„¸í•œ ë‚´ìš©ì€ ìœ„ APIë¥¼ ì°¸ê³ )</p>

              <blockquote>
                <ul>
                  <li>ìµœì í™”: ìµœì†Œ, ìµœëŒ€ë¥¼ êµ¬í•˜ëŠ” ê²ƒ , ìµœëŒ€ë¥¼ êµ¬í•˜ëŠ” ê²ƒì— ìŒìˆ˜ë¥¼ ì·¨í•˜ë©´ ìµœì†Œë¥¼ êµ¬í•˜ëŠ” ê²ƒê³¼ ê°™ì•„ì§</li>
                </ul>
              </blockquote>
            </li>
            <li>
              <p>ì´ì§„ ë¶„ë¥˜ê°€ ì•„ë‹Œ ê²½ìš°, ì¦‰, í´ë˜ìŠ¤ì˜ ì¢…ë¥˜ê°€ $3$ì´ìƒì¼ ë•ŒëŠ” ì…ë ¥ë³€ìˆ˜ <code class="language-plaintext highlighter-rouge">multi_class</code>ë¥¼ <code class="language-plaintext highlighter-rouge">multi_class="multinomial"</code>ë¡œ ë‘ë©´ ë’¤ì— ì„¤ëª…í•  ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ì´ ë¨</p>

              <blockquote>
                <ul>
                  <li><code class="language-plaintext highlighter-rouge">multi_class="ovr"</code>ì´ë©´ ì¼ëŒ€ë‹¤ ì „ëµì„ ì‚¬ìš©</li>
                </ul>
              </blockquote>
            </li>
            <li>
              <p>í•™ìŠµ í›„ ì˜ˆì¸¡ì€ <code class="language-plaintext highlighter-rouge">predict</code> ë©”ì†Œë“œë¥¼ ì´ìš©í•˜ê³ , í™•ë¥ ê°’ì€ <code class="language-plaintext highlighter-rouge">predict_proba</code> ë©”ì†Œë“œë¥¼ ì´ìš©</p>
            </li>
          </ul>
        </blockquote>

        <ul>
          <li>
            <p>í•™ìŠµëœ ê°ì²´ì˜ <code class="language-plaintext highlighter-rouge">score</code> ë©”ì†Œë“œëŠ” ì •í™•ë„(accuracy)ë¥¼ ì‚¬ìš©</p>

            <p><br /></p>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="ë¡œì§€ìŠ¤í‹±-íšŒê·€-ì‹¤ìŠµ">ë¡œì§€ìŠ¤í‹± íšŒê·€ ì‹¤ìŠµ</h3>

<ul>
  <li>
    <p>ë°ì´í„°ì…‹: sklearnì˜ datasetsì— í¬í•¨ëœ iris dataset</p>

    <blockquote>
      <ul>
        <li>Setosa, Versicolor, Virginica ì„¸ í’ˆì¢…ì˜ ë¶“ê½ƒ 150ê°œì— ëŒ€í•œ ê½ƒì(petal), ê½ƒë°›ì¹¨(sepal)ì˜ ë„ˆë¹„ì™€ ê¸¸ì´ë¥¼ ë‹´ê³  ìˆëŠ” ë°ì´í„°ì…‹</li>
        <li><a href="http://archive.ics.uci.edu/ml/datasets/Iris/">UCI Machine Learning Repository</a></li>
      </ul>
    </blockquote>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë°ì´í„°ì…‹ ë¡œë“œ 
</span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">.</span><span class="n">load_iris</span><span class="p">()</span>
  
<span class="c1"># ë¡œë“œëœ ë°ì´í„°ì…‹ì€ ì¼ì¢…ì˜ dictionary í˜•íƒœ
</span><span class="n">iris</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span>
<span class="c1">#dict_keys(['data', 'target', 'frame', 'target_names', 'DESCR', 'feature_names', 'filename'])
</span>  
<span class="k">print</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="s">"DESCR"</span><span class="p">])</span> <span class="c1"># ë°ì´í„°ì— ëŒ€í•œ ì •ë³´
</span>  
<span class="n">iris</span><span class="p">[</span><span class="s">"feature_names"</span><span class="p">]</span> 
<span class="c1">#['sepal length (cm)', ê½ƒë°›ì¹¨ ê¸¸ì´
#'sepal width (cm)', ê½ƒë°›ì¹¨ ë„ˆë¹„
# 'petal length (cm)', ê½ƒì ê¸¸ì´
#'petal width (cm)'] ê½ƒì ë„ˆë¹„
</span>  
<span class="n">iris</span><span class="p">[</span><span class="s">"target_names"</span><span class="p">]</span>  
<span class="c1">#array(['setosa', 'versicolor', 'virginica'], dtype='&lt;U10')
</span>  
</code></pre></div>    </div>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ê½ƒìì˜ ë„ˆë¹„ë¥¼ ì´ìš©í•˜ì—¬ virginicaë¥¼ íŒë³„í•˜ëŠ” ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸
</span>  
<span class="c1"># ê½ƒìì˜ ë„ˆë¹„(petal)ì„ ì´ìš©í•˜ì—¬ virginicaì´ë©´ ë ˆì´ë¸” 1, ì•„ë‹ˆë©´ ë ˆì´ë¸” 0ì´ ë˜ë„ë¡ í•™ìŠµ 
</span><span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="p">[</span><span class="s">"data"</span><span class="p">][:,</span><span class="mi">3</span><span class="p">:]</span> 
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="s">"target"</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">int</span><span class="p">)</span> 
  
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
  
<span class="n">log_reg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s">"none"</span><span class="p">)</span>
<span class="n">log_reg</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
  
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="n">y_new_proba</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">"g-"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"Iris virginica"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_new</span><span class="p">,</span> <span class="n">y_new_proba</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s">"r--"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"Not Iris virginica"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">"upper left"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>    </div>

    <p><img src="/img/posts/ML9/irispetalwidth.png" alt="iris; petal width" /></p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X2</span> <span class="o">=</span> <span class="n">iris</span><span class="p">[</span><span class="s">"data"</span><span class="p">][:,</span> <span class="mi">2</span><span class="p">:]</span>  <span class="c1"># ê½ƒìì˜ ê¸¸ì´, ë„ˆë¹„ 
</span><span class="n">y2</span> <span class="o">=</span> <span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="s">"target"</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">int</span><span class="p">)</span>
  
<span class="n">log_reg2</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">log_reg2</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
  
<span class="c1"># ê·¸ë¦¼ì„ ê·¸ë¦¬ê¸° ìœ„í•œ ì‘ì—…
</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span>        
        <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">800</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="c1"># 800x1 í–‰ë ¬í™”
</span>        <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mi">400</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">)</span>
  
<span class="n">X2_new</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">x0</span><span class="p">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">x1</span><span class="p">.</span><span class="n">ravel</span><span class="p">()])</span>
  
<span class="n">y2_proba</span> <span class="o">=</span> <span class="n">log_reg2</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X2_new</span><span class="p">)</span>
  
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">[</span><span class="n">y2</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X2</span><span class="p">[</span><span class="n">y2</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">"rx"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X2</span><span class="p">[</span><span class="n">y2</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X2</span><span class="p">[</span><span class="n">y2</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">"go"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
  
<span class="n">zz</span> <span class="o">=</span> <span class="n">y2_proba</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">].</span><span class="n">reshape</span><span class="p">(</span><span class="n">x0</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">contour</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">RdYlGn</span><span class="p">)</span>
  
<span class="c1"># í™•ë¥ ì´ 0.5ì¸ ê²°ì • ê²½ê³„ ê³„ì‚°
</span><span class="n">left_right</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.9</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">boundary</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">log_reg2</span><span class="p">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">left_right</span> <span class="o">+</span> <span class="n">log_reg2</span><span class="p">.</span><span class="n">intercept_</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">log_reg2</span><span class="p">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
  
<span class="c1"># ë“±ìœ„ì„ ì— ëŒ€ì‘ë˜ëŠ” í™•ë¥ ê°’ í‘œì‹œ 
</span><span class="n">plt</span><span class="p">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">'%1.2f'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">left_right</span><span class="p">,</span> <span class="n">boundary</span><span class="p">,</span> <span class="s">"k--"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s">"Not Iris virginica"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"r"</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">"center"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="s">"Iris virginica"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"g"</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s">"center"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Petal length"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Petal width"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># plt.axis([2.9, 7, 0.8, 2.7])
</span><span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>    </div>

    <p><img src="/img/posts/ML9/petaltwoval.png" alt="iris; petal width" /></p>
  </li>
</ul>

<p><br /></p>

<h2 id="ì†Œí”„íŠ¸ë§¥ìŠ¤-íšŒê·€softmax-regressionì˜-í•™ìŠµ-ëª¨ë¸">ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€(Softmax Regression)ì˜ í•™ìŠµ ëª¨ë¸</h2>

<ul>
  <li>ë‹¤ì¤‘ í´ë˜ìŠ¤ì— ëŒ€í•œ ë¶„ë¥˜ ë¬¸ì œì—ì„œ ìƒ˜í”Œì´ íŠ¹ì • í´ë˜ìŠ¤ì— ì†í•  í™•ë¥ ì„ ì¶”ì •í•˜ëŠ” ì§€ë„í•™ìŠµì˜ í•œ ê°€ì§€</li>
</ul>

<blockquote>
  <ul>
    <li>
      <p>2ê°œì˜ í´ë˜ìŠ¤ì— ëŒ€í•œ ì´ì§„ ë¶„ë¥˜ê¸°ë¥¼ ì—¬ëŸ¬ ê°œ ì‚¬ìš©í•˜ì—¬ ë‹¤ì¤‘ ë¶„ë¥˜ë¬¸ì œì— ëŒ€í•œ ë¶„ë¥˜ê¸°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŒ</p>

      <blockquote>
        <ul>
          <li>
            <p>ì¼ëŒ€ë‹¤ ì „ëµ(OvR(One versus the Rest) ë˜ëŠ” OvA(One versus All) ì „ëµ)</p>

            <p>:í•œ ê°œì˜ í´ë˜ìŠ¤ë§Œ ì–‘ì„±, ë‚˜ë¨¸ì§€ëŠ” ìŒì„±ìœ¼ë¡œ ë¶„ë¥˜í•˜ëŠ” ì´ì§„ ë¶„ë¥˜ê¸°ë¥¼ í´ë˜ìŠ¤ì˜ ê°œìˆ˜ë§Œí¼ í•™ìŠµì‹œí‚¨ í›„, ì£¼ì–´ì§„ ìƒ˜í”Œì´ ê° ë¶„ë¥˜ê¸°ì— ëŒ€í•´ ì–‘ì„±ì´ ë  í™•ë¥ ê°’ì„ ê³„ì‚°í•˜ê³  ì´ í™•ë¥ ê°’ì´ ê°€ì¥ í° í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜í•˜ëŠ” ë°©ë²•</p>
          </li>
          <li>
            <p>ì¼ëŒ€ì¼ ì „ëµ(OvO(One versus One) ì „ëµ)</p>

            <p>:ì£¼ì–´ì§„ $K$ê°œì˜ í´ë˜ìŠ¤ ì¤‘ì—ì„œ $2$ê°œì˜ í´ë˜ìŠ¤ ì¡°í•©ë§ˆë‹¤ ì´ì§„ ë¶„ë¥˜ê¸°ë¥¼ í•™ìŠµì‹œì¼œ ì´ $K(K-1)/2$ê°œì˜ í•™ìŠµëœ ì´ì§„ë¶„ë¥˜ê¸° ë§Œë“¤ê³ , ì£¼ì–´ì§„ ìƒ˜í”Œì— ëŒ€í•´ $K(K-1)/2$ê°œì˜ ë¶„ë¥˜ê¸°ì— ëŒ€í•œ ë ˆì´ë¸”ì„ êµ¬í•´ì„œ ê°€ì¥ ë§ì´ ì–‘ì„±ìœ¼ë¡œ ë¶„ë¥˜ëœ í´ë˜ìŠ¤ë¥¼ ì„ íƒí•˜ëŠ” ë°©ë²•</p>
          </li>
        </ul>
      </blockquote>
    </li>
  </ul>
</blockquote>

<ul>
  <li>
    <h3 id="ì†Œí”„íŠ¸ë§¥ìŠ¤-íšŒê·€-ëª¨ë¸">ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸</h3>

    <blockquote>
      <ul>
        <li>
          <p>3ê°œ ì´ìƒì˜ í´ë˜ìŠ¤ ë¶„ë¥˜ ëª¨ë¸</p>
        </li>
        <li>
          <p>ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ ê³¼ì •</p>

          <blockquote>
            <ol>
              <li>A,B,C ë¼ë²¨ ë¶„ë¥˜ë¥¼ í•œë‹¤ê³  í•˜ë©´, ê°ê°ì˜ WX (ê°€ì¤‘ì¹˜ì™€ ì…ë ¥ê°’ì˜ íšŒê·€ì‹ì˜ ê³±,1X3)ê°€ 3ê°€ì§€ê°€ í•„ìš”í•˜ë‹¤. ì´ëŠ” ë„ˆë¬´ ë³µì¡í•˜ë¯€ë¡œ ê°€ì¤‘ì¹˜ë¥¼ í•˜ë‚˜ì˜ í–‰ë ¬(3X3)ë¡œ ë¬¶ì–´ì„œ  WXë¥¼  ì˜ˆì¸¡ê°’ì„ êµ¬í•œë‹¤.</li>
              <li>ì˜ˆì¸¡ê°’ì„ ì´í•©ì´ 1ì¸ í™•ë¥  ë¶„í¬ë¡œ ë°”ê¾¸ê¸° ìœ„í•´ ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ë¥¼ ì´ìš©</li>
              <li>êµì°¨ ì—”íŠ¸ë¡œí”¼ í•¨ìˆ˜ë¡œ ì›í•«ì¸ì½”ë”© (í•œ í´ë˜ìŠ¤ë§Œ 1ì„ ì£¼ê³  ë‚˜ë¨¸ì§€ëŠ” 0ìœ¼ë¡œ ì±„ìš°ëŠ” ê²ƒ)</li>
            </ol>
          </blockquote>
        </li>
        <li>
          <p><strong>ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ ìˆ˜ì‹ìœ¼ë¡œ ì´í•´í•˜ê¸°</strong></p>

          <p>í›ˆë ¨ ë°ì´í„°ì…‹ ${(\mathbf x_i,y_i) \mid 1\le i \le m}$ì´ ì£¼ì–´ì§ˆ ë•Œ (ë‹¨, ê°€ëŠ¥í•œ ë ˆì´ë¸”ì˜ ì¢…ë¥˜ëŠ” $K$ ê°€ì§€ì´ê³ , $\mathbf x_i=(1,x_{i1},\cdots,x_{in})^{\rm T}$)</p>

          <blockquote>
            <ul>
              <li>
                <p>(1) $K$ ê°œì˜ í´ë˜ìŠ¤ ê°ê°ì— ëŒ€í•´ ëª¨ë¸ íŒŒë¼ë¯¸í„° $\theta_k=(\theta_{k0},\theta_{k1},\cdots,\theta_{kn})^{\rm T}$ ($k=1,2,\cdots,K$)ë¥¼ ì´ìš©í•˜ì—¬ ìƒ˜í”Œ $\mathbf x$ì˜ í´ë˜ìŠ¤ $k$ì— ëŒ€í•œ ì ìˆ˜(score) $s_k(\mathbf x)=\theta_k^{\rm T}\mathbf x$ë¥¼ ê³„ì‚°í•˜ê³ ,</p>

                <p>ì´ë•Œ, ê° í´ë˜ìŠ¤ $k$ì— ëŒ€í•œ</p>
              </li>
            </ul>
          </blockquote>

          <blockquote>
            <blockquote>
              <ul>
                <li>ì ìˆ˜ë¥¼ ì„±ë¶„ìœ¼ë¡œ ê°–ëŠ” ë²¡í„°ë¥¼ $\mathbf s(\mathbf x)=(s_1(\mathbf x),\cdots,s_K(\mathbf x))^{\rm T}$ë¼ í•˜ê³ ,  $\theta_k$ë¥¼ í–‰ë²¡í„°ë¡œ ê°–ëŠ” $k\times (n+1)$ í–‰ë ¬ì„ $\mathbf \Theta = (\theta_{ij})$ë¼ê³  í•¨</li>
              </ul>
            </blockquote>
          </blockquote>

          <blockquote>
            <ul>
              <li>(2) $\mathbf t=(t_1,\cdots,t_K)^{\rm T}\in \mathbb R^K$ì— ëŒ€í•´ ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ $\sigma: \mathbb R^K\to [0,1]^K$ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•  ë•Œ</li>
            </ul>
          </blockquote>

          <blockquote>
\[\sigma(\mathbf t) = \left(\dfrac{\exp(t_1)}{\sum_{k=1}^K \exp(t_k)},\cdots,\dfrac{\exp(t_K)}{\sum_{k=1}^K \exp(t_k)}\right)^{\rm T}\]
          </blockquote>

          <blockquote>
            <blockquote>
              <ul>
                <li>$\sigma(\mathbf t)$ì˜ $i$ë²ˆì§¸ ì„±ë¶„ì„ $\sigma(\mathbf t)_i$ë¼ í•  ë•Œ</li>
              </ul>
            </blockquote>
          </blockquote>

          <blockquote>
\[\sigma(\mathbf t)_1+\cdots + \sigma(\mathbf t)_K=1\]
          </blockquote>

          <blockquote>
            <ul>
              <li>(3) í´ë˜ìŠ¤ $k$ì— ì†í•  í™•ë¥  $\hat p_k(\mathbf x)$ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì¶”ì • (ì˜¤í•´ì˜ ì†Œì§€ê°€ ì—†ì„ ë•ŒëŠ” $\hat p_k(\mathbf x)$ë¥¼ ê°„ë‹¨íˆ $\hat p_k$ë¡œ ë‚˜íƒ€ëƒ„)</li>
            </ul>
          </blockquote>

          <blockquote>
\[\hat{p}_k = \sigma(\mathbf s(\mathbf x))_k= \dfrac{\exp(s_k(\mathbf x))}{\sum_{i=1}^K \exp(s_i(\mathbf x))}\]

          </blockquote>

          <blockquote>
            <ul>
              <li>(4) ìƒ˜í”Œ $\mathbf x$ì— ëŒ€í•œ ë ˆì´ë¸”ì˜ ì˜ˆì¸¡ì€ ì¶”ì •í™•ë¥  $\hat{p}_k$ê°€ ìµœëŒ€ê°€ ë˜ëŠ” $k$ë¡œ ì˜ˆì¸¡ ì¦‰,
\(\hat y = \text{argmax}_k \hat{p}_k=\text{argmax}_k \sigma(\mathbf s(\mathbf x))_k=\text{argmax}_k s_k(\mathbf x) = \text{argmax}_k \theta_k^{\rm T}\mathbf x, \ (1\le k\le K)\)</li>
            </ul>
          </blockquote>

          <blockquote>
            <ul>
              <li>ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ë¶„ë¥˜ê¸°ëŠ” í•˜ë‚˜ì˜ ìƒ˜í”Œì— ëŒ€í•´ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë§Œ ì˜ˆì¸¡ (ì¦‰, í•˜ë‚˜ì˜ ì‚¬ì§„ì—ì„œ ì—¬ëŸ¬ ì‚¬ëŒì˜ ì–¼êµ´ì„ ì¸ì‹í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ë‹¤ì¤‘ ì¶œë ¥ ë¶„ë¥˜ê¸°ëŠ” ì•„ë‹˜)</li>
            </ul>
          </blockquote>
        </li>
      </ul>
    </blockquote>

    <h3 id="ì†Œí”„íŠ¸ë§¥ìŠ¤-íšŒê·€-ëª¨ë¸ì˜-í•™ìŠµ">ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ì˜ í•™ìŠµ</h3>

    <ul>
      <li>ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ì—ì„œ ë ˆì´ë¸”ì´ $k$ê°€ í™•ë¥ ì˜ ì¶”ì •ê°’ì€ $\hat p_k(\mathbf x)=\text{P}(Y=k \mid X=\mathbf x)$ì´ê³  í›ˆë ¨ ë°ì´í„°ì…‹ì´ iidë¡œë¶€í„° ì–»ì€ ìƒ˜í”Œì´ë¯€ë¡œ ë¡œê·¸ìš°ë„í•¨ìˆ˜</li>
    </ul>

    <blockquote>
\[\ln(\text{P}(y_1,\cdots,y_m\mid \mathbf x_1,\cdots,\mathbf x_m:\mathbf \Theta))=\sum_{i=1}^m \ln(\text{P}(Y=y_i \mid X=\mathbf x_i:\mathbf \Theta))\]

      <p>ê°€ ìµœëŒ€ê°€ ë˜ëŠ” ëª¨ë¸ íŒŒë¼ë¯¸í„° $\mathbf \Theta=(\theta_{ij})$ë¥¼ êµ¬í•˜ëŠ” ê²ƒì´ ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ì˜ í•™ìŠµ</p>
    </blockquote>

    <blockquote>
      <ul>
        <li>$i$ë²ˆì§¸ ìƒ˜í”Œì— ëŒ€í•œ ë ˆì´ë¸” $y_i\in {1,\cdots,K}$ë¥¼ <strong>ì›-í•«(one hot)</strong>ì¸ì½”ë”©ìœ¼ë¡œ í‘œí˜„í•˜ì—¬ ë ˆì´ë¸” ê°’ì— í•´ë‹¹í•˜ëŠ” í•œ ì„±ë¶„ë§Œ $1$ì´ê³  ë‚˜ë¨¸ì§€ ì„±ë¶„ì€ ëª¨ë‘ $0$ì¸ ë²¡í„° $(y_{i1},\cdots,y_{iK})^{\rm T}$ë¡œ ìƒê°í•˜ë©´ (ì¦‰, $K=4$ì´ê³  $y_i=2$ì¸ ê²½ìš° $y_i$ì˜ ì›-í•« ì¸ì½”ë”©ì€ $(0,1,0,0)^{\rm T}$)
\(\text{P}(Y=y_i|X=\mathbf x_i:\mathbf \Theta)=\prod_{k=1}^K \hat{p}_k(\mathbf x_i)^{y_{ik}}=\prod_{k=1}^K (\sigma(\mathbf \Theta\mathbf x_i)_k)^{y_{ik}}=\prod_{k=1}^K \left(\dfrac{\exp(\theta_k^{\rm T}\mathbf x_i)}{\sum_{k=1}^K \exp(\theta_k^{\rm T}\mathbf x_i)} \right)^{y_{ik}}\)</li>
      </ul>
    </blockquote>

    <ul>
      <li>ì¦‰, ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ì— ëŒ€í•œ ë¹„ìš©í•¨ìˆ˜ $J(\mathbf \Theta)$ëŠ” ìœ„ ë¡œê·¸ìš°ë„í•¨ìˆ˜ì˜ ë¶€í˜¸ë¥¼ ë°”ê¾¸ê³  ëª¨ë“  ìƒ˜í”Œì— ëŒ€í•œ í‰ê· ì„ êµ¬í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•¨</li>
    </ul>

    <blockquote>
\[J(\mathbf \Theta)=-\dfrac 1 m \sum_{i=1}^m\sum_{k=1}^K y_{ik}\ln(\hat{p}_k(\mathbf x_i))=-\dfrac 1 m \sum_{i=1}^m\sum_{k=1}^K y_{ik}\ln(\dfrac{\exp(\theta_k^{\rm T}\mathbf x_i)}{\sum_{k=1}^K \exp(\theta_k^{\rm T}\mathbf x_i)} )\]
    </blockquote>

    <ul>
      <li>ìœ„ì—ì„œ ì •ì˜í•œ ë¹„ìš©í•¨ìˆ˜ $J(\mathbf \Theta)$ë¥¼ <strong>í¬ë¡œìŠ¤ ì—”íŠ¸ë¡œí”¼(cross entropy)</strong> ë¹„ìš©í•¨ìˆ˜ë¼ê³  ë¶€ë¦„</li>
    </ul>

    <blockquote>
      <ul>
        <li>í¬ë¡œìŠ¤ ì—”íŠ¸ë¡œí”¼ëŠ” <strong>ì •ë³´ì´ë¡ </strong>ì—ì„œ ìœ ë˜í•œ ê²ƒìœ¼ë¡œ ë‘ ì´ì‚°í™•ë¥ ë¶„í¬ $p: P(X=k)=p_k\ (1\le k\le K)$ì™€ $q: P(X=k)=q_k\ (1\le k\le K)$ì— ëŒ€í•œ í¬ë¡œìŠ¤ ì—”íŠ¸ë¡œí”¼ëŠ” $H(p,q)=-\sum_{k=1}^K p_k \ln q_k$ë¡œ ì •ì˜ë¨</li>
        <li>ì¼ë°˜ì ìœ¼ë¡œ ë‘ ì´ì‚°í™•ë¥ ë¶„í¬ $p, \ q$ê°€ ì–´ëŠ ì •ë„ ë¹„ìŠ·í•œ ë¶„í¬ì¸ì§€ì— ëŒ€í•œ ì¸¡ë„ì¸ <strong>ì¿¨ë°±-ë¼ì´ë¸”ëŸ¬ ë°œì‚°(Kullback-Leibler divergence)</strong> $K(p | q)$ëŠ” $K(p | q)=H(p,q)-H(p,p)$ë¡œ ì •ì˜ë˜ê³  í•­ìƒ $K(p | q)\ge 0$ì´ ì„±ë¦½í•¨</li>
      </ul>
    </blockquote>

    <ul>
      <li>ë‹¤ìŒê³¼ ê°™ì´ ê³„ì‚°ë˜ëŠ” ê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„° $\nabla_{\mathbf \theta}J(\mathbf \Theta)$ë¥¼ ì´ìš©í•˜ì—¬ ê²½ì‚¬í•˜ê°•ë²• ë˜ëŠ” ë‹¤ë¥¸ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì„ ì´ìš©í•˜ì—¬ í¬ë¡œìŠ¤ ì—”íŠ¸ë¡œí”¼ ë¹„ìš©í•¨ìˆ˜ê°€ ìµœì†Œê°€ ë˜ëŠ” ëª¨ë¸ íŒŒë¼ë¯¸í„° $\mathbf \Theta$ë¥¼ êµ¬í•¨</li>
    </ul>

\[\nabla_{\theta_k}J(\mathbf \Theta) = \dfrac {1}{m}\sum_{i=1}^m (\hat{p}_{k}(\mathbf x_i)-y_{ik})\mathbf x_i=\dfrac 1 m\sum_{i=1}^m (\dfrac{\exp(\theta_k^{\rm T}\mathbf x_i)}{\sum_{k=1}^K \exp(\theta_k^{\rm T}\mathbf x_i)} -y_{ik})\mathbf x_i, (1\le k \le K)\]

    <blockquote>
      <ul>
        <li>ìœ„ ì‹ì„ ì´ìš©í•˜ì—¬ ê° íŒŒë¼ë¯¸í„° ë²¡í„° $\theta_k$ $(k=1,\cdots,K)$ë¥¼ ì—…ë°ì´íŠ¸ ì‹œí‚´</li>
      </ul>
    </blockquote>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">sklearn.linear_model</code> ëª¨ë“ˆì˜ <code class="language-plaintext highlighter-rouge">LogisticRegression</code>í´ë˜ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ë¶„ë¥˜ê¸° ê°ì²´ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ì„œëŠ” ì…ë ¥ë³€ìˆ˜ë¥¼ <code class="language-plaintext highlighter-rouge">multi_class="multinomial"</code>ë¡œ ì „ë‹¬í•˜ë©´ ë˜ê³ , ì‚¬ìš©ê°€ëŠ¥í•œ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì€ APIì˜ <code class="language-plaintext highlighter-rouge">solver</code>ì— ëŒ€í•œ ì„¤ëª…ì„ ì°¸ê³ </li>
    </ul>

    <blockquote>
      <ul>
        <li>ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ë¥¼ ìœ„í•œ <code class="language-plaintext highlighter-rouge">solver</code>ëŠ” ë‰´í„´ ì¼¤ë ˆ ê¸°ìš¸ê¸°ë²•ì„ êµ¬í˜„í•œ â€œnewton-cgâ€, í™•ë¥ ì  í‰ê·  ê²½ì‚¬í•˜ê°•ë²•ì„ êµ¬í˜„í•œ â€œsagâ€, â€œsagâ€ë¥¼ ê°œì„ í•œ â€œsagaâ€, ì œí•œëœ ë©”ëª¨ë¦¬ ê³µê°„ì—ì„œ ì˜ì‚¬ ë‰´í„´ ë°©ë²•ì˜ ì¼ì¢…ì„ êµ¬í˜„í•œ â€œlbfgsâ€ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ</li>
        <li>ì´ ì¤‘ $\ell_1$ ê·œì œê¹Œì§€ ì§€ì›í•˜ëŠ” ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì€ â€œsagaâ€</li>
        <li>ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ì„ ìœ„í•´ <code class="language-plaintext highlighter-rouge">LogisticRegression(multi_class="multinomial")</code>ë¡œ ìƒì„±ëœ ê°ì²´ë¥¼ í•™ìŠµì‹œí‚¨ í›„, <code class="language-plaintext highlighter-rouge">predict</code>, <code class="language-plaintext highlighter-rouge">predict_proba</code>, <code class="language-plaintext highlighter-rouge">score</code> ë“±ì˜ ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ë¡œì§€ìŠ¤í‹± íšŒê·€ì˜ ê²½ìš°ì™€ ê°™ìŒ</li>
      </ul>
    </blockquote>

    <h3 id="ì†Œí”„íŠ¸ë§¥ìŠ¤-íšŒê·€-ì‹¤ìŠµ">ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ì‹¤ìŠµ</h3>

    <ul>
      <li>
        <p>ì£¼ì˜í•  ì </p>

        <blockquote>
          <ul>
            <li>ë‹¤ìŒê³¼ ê°™ì´ ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ softmax_pre([$t_1,\cdots,t_n$])ì„ êµ¬í˜„í•˜ë©´ universal functionìœ¼ë¡œ ì™„ë²½í•˜ê²Œ êµ¬í˜„ëœ ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, $t_i$ ê°’ì´ $710$ì´ìƒì¸ ê²½ìš° $e^{710}$ê°€ ë„ˆë¬´ í° ìˆ˜(overflow)ê°€ ë˜ì–´ ì²˜ë¦¬í•  ìˆ˜ ì—†ëŠ” ìˆ˜ê°€ ë˜ë¯€ë¡œ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ì—†ë‹¤.</li>
            <li>ê°„ë‹¨í•œ ì§€ìˆ˜ë²•ì¹™ì„ ì´ìš©í•˜ì—¬ êµ¬í˜„í•˜ë©´ í•´ê²° ê°€ëŠ¥í•˜ë‹¤.</li>
          </ul>
        </blockquote>

        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">softmax_pre</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="c1"># xëŠ” ë„˜íŒŒì´ ë°°ì—´ 
</span>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span> <span class="c1"># ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ êµ¬í˜„
</span>    
<span class="c1"># overflowê°€ ìƒê¸°ì§€ ì•ŠëŠ” ê²½ìš° 
</span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">709</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">softmax_pre</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="mf">1e3</span> <span class="o">*</span> <span class="n">softmax_pre</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span>  <span class="c1">#e^710 ì´ìƒì´ ì•„ë‹ˆë¼ì„œ overflow ì•ˆìƒê¹€
</span>    
<span class="c1">#[1.00000000e+000 2.44396947e-307 6.64339780e-307 3.27084919e-265]
#[1. 0. 0. 0.]
</span>    
<span class="c1"># overflowê°€ ìƒê¸°ëŠ” ê²½ìš°
</span><span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">800</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">softmax_pre</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="mf">1e3</span> <span class="o">*</span> <span class="n">softmax_pre</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span>
    
<span class="c1">#[nan  0.  0.  0.]
#[nan  0.  0.  0.]
#&lt;ipython-input-50-814dc8c6b251&gt;:2: RuntimeWarning: overflow encountered in exp
</span> <span class="c1"># x = np.exp(x)
#&lt;ipython-input-50-814dc8c6b251&gt;:3: RuntimeWarning: invalid value encountered in true_divide
</span>  <span class="c1">#return x/x.sum()
</span></code></pre></div>        </div>

        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#overflow ìˆ˜ì •
#ì§€ìˆ˜ê°€ ì»¤ì§ˆìˆ˜ë¡ ê¸‰ê²©í•˜ê²Œ ì»¤ì§€ê¸° ë•Œë¬¸ì— overflow ë°œìƒí•œë‹¤. 
#ì›ì†Œì— ì–´ë–¤ ìˆ˜ë¥¼ ë”í•´ì„œ ì§€ìˆ˜í•¨ìˆ˜ë¥¼ ì·¨í•˜ë”ë¼ë„ ê²°ê³¼ê°’ì´ ê°™ë‹¤ëŠ” softmaxì˜ ì„±ì§ˆ ì´ìš©
</span>    
<span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> 
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1">#ìµœëŒ€ê°’ ëº´ì£¼ê³  ê³„ì‚°
</span>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
    
<span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="o">**</span><span class="mi">19</span><span class="p">,</span> <span class="mi">790</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">softmax</span><span class="p">(</span><span class="n">x3</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="mf">1e3</span> <span class="o">*</span> <span class="n">softmax</span><span class="p">(</span><span class="n">x3</span><span class="p">))</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span>
    
<span class="c1">#[1. 0. 0. 0.]
#[1. 0. 0. 0.]
</span></code></pre></div>        </div>

        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ê½ƒì ê¸¸ì´, ë„ˆë¹„ë¥¼ ì´ìš©í•œ ì†Œí”„íŠ¸ ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸
</span><span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="p">[</span><span class="s">"data"</span><span class="p">][:,</span> <span class="mi">2</span><span class="p">:]</span>  <span class="c1"># ê½ƒì ê¸¸ì´, ê½ƒì ë„ˆë¹„
</span><span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="p">[</span><span class="s">"target"</span><span class="p">]</span>
<span class="n">softmax_reg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">multi_class</span><span class="o">=</span><span class="s">"multinomial"</span><span class="p">,</span><span class="n">solver</span><span class="o">=</span><span class="s">"lbfgs"</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">softmax_reg</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="c1">#ì œí•œëœ ë©”ëª¨ë¦¬ ê³µê°„ì—ì„œ ì˜ì‚¬ ë‰´í„´ ë°©ë²•ì˜ ì¼ì¢…ì„ êµ¬í˜„í•œ "lbfgs"
</span>                                     
<span class="c1"># ê²°ì • ê²½ê³„ë¥¼ ê·¸ë¦¼ìœ¼ë¡œ ë‚˜íƒ€ë‚´ê¸° 
</span>    
<span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span>
        <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">500</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">200</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">)</span>
    
<span class="n">X_new</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">x0</span><span class="p">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">x1</span><span class="p">.</span><span class="n">ravel</span><span class="p">()])</span>
    
<span class="n">y_proba</span> <span class="o">=</span> <span class="n">softmax_reg</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
<span class="n">y_predict</span> <span class="o">=</span> <span class="n">softmax_reg</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
    
<span class="n">zz2</span> <span class="o">=</span> <span class="n">y_proba</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">].</span><span class="n">reshape</span><span class="p">(</span><span class="n">x0</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">zz1</span> <span class="o">=</span> <span class="n">y_proba</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">].</span><span class="n">reshape</span><span class="p">(</span><span class="n">x0</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
    
<span class="n">zz</span> <span class="o">=</span> <span class="n">y_predict</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x0</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
    
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">"go"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"Iris virginica"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">"rs"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"Iris versicolor"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">"bx"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"Iris setosa"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="n">custom_cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">([</span><span class="s">"blue"</span><span class="p">,</span> <span class="s">"red"</span><span class="p">,</span>  <span class="s">"green"</span><span class="p">])</span>
<span class="n">custom_cmap1</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">([</span><span class="s">"tomato"</span><span class="p">,</span> <span class="s">"red"</span><span class="p">,</span> <span class="s">"darkred"</span><span class="p">])</span>
<span class="n">custom_cmap2</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">([</span><span class="s">"teal"</span><span class="p">,</span> <span class="s">"green"</span><span class="p">,</span> <span class="s">"darkgreen"</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">custom_cmap</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">contour1</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">zz1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">custom_cmap1</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">contour2</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">zz2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">custom_cmap2</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contour1</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">'%1.2f'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contour2</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">'%1.2f'</span><span class="p">)</span>
    
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Petal length"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Petal width"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">"center left"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>        </div>

        <p><img src="/img/posts/ML9/softmax.png" alt="softmax" /></p>
      </li>
    </ul>
  </li>
</ul>

<p>Reference:</p>

<ul>
  <li>ê¸°ê³„í•™ìŠµ_í•˜ê¸¸ì°¬ êµìˆ˜ë‹˜ ìˆ˜ì—…ì„ ë“£ê³  ê³µë¶€í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</li>
  <li><a href="https://blog.naver.com/PostView.naver?blogId=tjgml1343&amp;logNo=222117714538&amp;parentCategoryNo=&amp;categoryNo=15&amp;viewDate=&amp;isShowPopularPosts=true&amp;from=search">ì†Œí”„íŠ¸ë§¥ìŠ¤ ì´í•´í•˜ê¸°_Cathy</a></li>
  <li><a href="https://wikidocs.net/35476">ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€(ë‹¤ì¤‘í´ë˜ìŠ¤ë¶„ë¥˜)_wiki docs</a></li>
</ul>

:ET