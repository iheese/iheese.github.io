---
layout: post
title: '기계학습'
subtitle: '수업 2주차'
date: 2021-09-08 11:30:00 +0900
categories: 'ML'
---

```python
import numpy as np
import pandas as pd
```

## object creation


```python
s=pd.Series([1,3,5,np.nan,6,8])
s
```




    0    1.0
    1    3.0
    2    5.0
    3    NaN
    4    6.0
    5    8.0
    dtype: float64  




```python
dates=pd.date_range("20130101",periods=6)
dates
```




    DatetimeIndex(['2013-01-01', '2013-01-02', '2013-01-03', '2013-01-04',
                   '2013-01-05', '2013-01-06'],
                  dtype='datetime64[ns]', freq='D')




```python
df= pd.DataFrame(np.random.randn(6,4),index=dates,columns=list("ABCD"))
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>-1.171673</td>
      <td>-1.282048</td>
      <td>-1.240960</td>
      <td>-1.382591</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>0.747014</td>
      <td>-0.098745</td>
      <td>-2.674977</td>
      <td>-0.766007</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>0.344874</td>
      <td>-1.071516</td>
      <td>0.138593</td>
      <td>0.563455</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>0.032506</td>
      <td>0.100209</td>
      <td>-0.258473</td>
      <td>-1.114725</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>0.141728</td>
      <td>2.327885</td>
      <td>1.172082</td>
      <td>1.085766</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>-1.335232</td>
      <td>-1.043389</td>
      <td>2.569405</td>
      <td>1.850168</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2= pd.DataFrame({"A":1.0,"B":pd.Timestamp("20130102"),
                   "C":pd.Series(1,index=list(range(4)),dtype="float32"),
                   "D":np.array([3]*4,dtype="int32"),
                   "E":pd.Categorical(["test","train","test","train"]),
                   "F":"foo",})
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>3</td>
      <td>test</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>3</td>
      <td>train</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>3</td>
      <td>test</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>2013-01-02</td>
      <td>1.0</td>
      <td>3</td>
      <td>train</td>
      <td>foo</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2.dtypes
```




    A           float64
    B    datetime64[ns]
    C           float32
    D             int32
    E          category
    F            object
    dtype: object




```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>-1.171673</td>
      <td>-1.282048</td>
      <td>-1.240960</td>
      <td>-1.382591</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>0.747014</td>
      <td>-0.098745</td>
      <td>-2.674977</td>
      <td>-0.766007</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>0.344874</td>
      <td>-1.071516</td>
      <td>0.138593</td>
      <td>0.563455</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>0.032506</td>
      <td>0.100209</td>
      <td>-0.258473</td>
      <td>-1.114725</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>0.141728</td>
      <td>2.327885</td>
      <td>1.172082</td>
      <td>1.085766</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.tail()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-02</th>
      <td>0.747014</td>
      <td>-0.098745</td>
      <td>-2.674977</td>
      <td>-0.766007</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>0.344874</td>
      <td>-1.071516</td>
      <td>0.138593</td>
      <td>0.563455</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>0.032506</td>
      <td>0.100209</td>
      <td>-0.258473</td>
      <td>-1.114725</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>0.141728</td>
      <td>2.327885</td>
      <td>1.172082</td>
      <td>1.085766</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>-1.335232</td>
      <td>-1.043389</td>
      <td>2.569405</td>
      <td>1.850168</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.index
```




    DatetimeIndex(['2013-01-01', '2013-01-02', '2013-01-03', '2013-01-04',
                   '2013-01-05', '2013-01-06'],
                  dtype='datetime64[ns]', freq='D')




```python
df.columns
```




    Index(['A', 'B', 'C', 'D'], dtype='object')




```python
df.to_numpy()
```




    array([[ 1.59342018,  2.65239188,  0.49500638, -0.73513749],
           [ 0.56375966, -2.66504831,  0.37451522, -1.10341922],
           [-0.2827687 ,  1.07071856, -0.50046244, -0.48868478],
           [-1.66030333, -0.08691766,  0.55157115, -0.26135908],
           [-0.40783401, -0.83482756, -1.80988001, -1.30816714],
           [ 0.22261522, -1.87903334,  2.08030501, -0.16128424]])




```python
df2.to_numpy()
```




    array([[1.0, Timestamp('2013-01-02 00:00:00'), 1.0, 3, 'test', 'foo'],
           [1.0, Timestamp('2013-01-02 00:00:00'), 1.0, 3, 'train', 'foo'],
           [1.0, Timestamp('2013-01-02 00:00:00'), 1.0, 3, 'test', 'foo'],
           [1.0, Timestamp('2013-01-02 00:00:00'), 1.0, 3, 'train', 'foo']],
          dtype=object)




```python
df.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>6.000000</td>
      <td>6.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.004815</td>
      <td>-0.290453</td>
      <td>0.198509</td>
      <td>-0.676342</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.087118</td>
      <td>1.950035</td>
      <td>1.288944</td>
      <td>0.459949</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.660303</td>
      <td>-2.665048</td>
      <td>-1.809880</td>
      <td>-1.308167</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.376568</td>
      <td>-1.617982</td>
      <td>-0.281718</td>
      <td>-1.011349</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-0.030077</td>
      <td>-0.460873</td>
      <td>0.434761</td>
      <td>-0.611911</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.478474</td>
      <td>0.781310</td>
      <td>0.537430</td>
      <td>-0.318191</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.593420</td>
      <td>2.652392</td>
      <td>2.080305</td>
      <td>-0.161284</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2013-01-01</th>
      <th>2013-01-02</th>
      <th>2013-01-03</th>
      <th>2013-01-04</th>
      <th>2013-01-05</th>
      <th>2013-01-06</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>1.593420</td>
      <td>0.563760</td>
      <td>-0.282769</td>
      <td>-1.660303</td>
      <td>-0.407834</td>
      <td>0.222615</td>
    </tr>
    <tr>
      <th>B</th>
      <td>2.652392</td>
      <td>-2.665048</td>
      <td>1.070719</td>
      <td>-0.086918</td>
      <td>-0.834828</td>
      <td>-1.879033</td>
    </tr>
    <tr>
      <th>C</th>
      <td>0.495006</td>
      <td>0.374515</td>
      <td>-0.500462</td>
      <td>0.551571</td>
      <td>-1.809880</td>
      <td>2.080305</td>
    </tr>
    <tr>
      <th>D</th>
      <td>-0.735137</td>
      <td>-1.103419</td>
      <td>-0.488685</td>
      <td>-0.261359</td>
      <td>-1.308167</td>
      <td>-0.161284</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sort_values(by='B') 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-02</th>
      <td>0.563760</td>
      <td>-2.665048</td>
      <td>0.374515</td>
      <td>-1.103419</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>0.222615</td>
      <td>-1.879033</td>
      <td>2.080305</td>
      <td>-0.161284</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-0.407834</td>
      <td>-0.834828</td>
      <td>-1.809880</td>
      <td>-1.308167</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>-1.660303</td>
      <td>-0.086918</td>
      <td>0.551571</td>
      <td>-0.261359</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-0.282769</td>
      <td>1.070719</td>
      <td>-0.500462</td>
      <td>-0.488685</td>
    </tr>
    <tr>
      <th>2013-01-01</th>
      <td>1.593420</td>
      <td>2.652392</td>
      <td>0.495006</td>
      <td>-0.735137</td>
    </tr>
  </tbody>
</table>
</div>



## Selection


```python
df['A'] #Getting
```




    2013-01-01    1.593420
    2013-01-02    0.563760
    2013-01-03   -0.282769
    2013-01-04   -1.660303
    2013-01-05   -0.407834
    2013-01-06    0.222615
    Freq: D, Name: A, dtype: float64




```python
df[0:3] #slice the rows
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>1.593420</td>
      <td>2.652392</td>
      <td>0.495006</td>
      <td>-0.735137</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>0.563760</td>
      <td>-2.665048</td>
      <td>0.374515</td>
      <td>-1.103419</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-0.282769</td>
      <td>1.070719</td>
      <td>-0.500462</td>
      <td>-0.488685</td>
    </tr>
  </tbody>
</table>
</div>




```python
df["20130102":"20130104"]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-02</th>
      <td>0.563760</td>
      <td>-2.665048</td>
      <td>0.374515</td>
      <td>-1.103419</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-0.282769</td>
      <td>1.070719</td>
      <td>-0.500462</td>
      <td>-0.488685</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>-1.660303</td>
      <td>-0.086918</td>
      <td>0.551571</td>
      <td>-0.261359</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.loc[dates[0]]
```




    A    1.593420
    B    2.652392
    C    0.495006
    D   -0.735137
    Name: 2013-01-01 00:00:00, dtype: float64




```python
df.loc[:,["A","B"]] #Selection by Label
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>1.593420</td>
      <td>2.652392</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>0.563760</td>
      <td>-2.665048</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-0.282769</td>
      <td>1.070719</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>-1.660303</td>
      <td>-0.086918</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-0.407834</td>
      <td>-0.834828</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>0.222615</td>
      <td>-1.879033</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.loc["20130102":"20130104",["A","B"]]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-02</th>
      <td>0.563760</td>
      <td>-2.665048</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-0.282769</td>
      <td>1.070719</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>-1.660303</td>
      <td>-0.086918</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.loc["20130102", ["A","B"]]
```




    A    0.563760
    B   -2.665048
    Name: 2013-01-02 00:00:00, dtype: float64




```python
df.loc[dates[0],"A"]
```




    1.5934201795971803




```python
df.at[dates[0],"A"]
```




    1.5934201795971803



## Selection by position


```python
df.iloc[3]
```




    A   -1.660303
    B   -0.086918
    C    0.551571
    D   -0.261359
    Name: 2013-01-04 00:00:00, dtype: float64




```python
df.iloc[3:5,0:2]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-04</th>
      <td>-1.660303</td>
      <td>-0.086918</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-0.407834</td>
      <td>-0.834828</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.iloc[[1,2,4],[0,2]]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-02</th>
      <td>0.563760</td>
      <td>0.374515</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-0.282769</td>
      <td>-0.500462</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-0.407834</td>
      <td>-1.809880</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.iloc[1:3,:]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-02</th>
      <td>0.563760</td>
      <td>-2.665048</td>
      <td>0.374515</td>
      <td>-1.103419</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-0.282769</td>
      <td>1.070719</td>
      <td>-0.500462</td>
      <td>-0.488685</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.iloc[:,1:3]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>2.652392</td>
      <td>0.495006</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>-2.665048</td>
      <td>0.374515</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>1.070719</td>
      <td>-0.500462</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>-0.086918</td>
      <td>0.551571</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-0.834828</td>
      <td>-1.809880</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>-1.879033</td>
      <td>2.080305</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.iloc[1,1]
```




    -2.6650483125361175




```python
df.iat[1,1] #equivalent to the prior method
```




    -2.6650483125361175



## Boolean indexing


```python
df[df["A"]>0]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>1.593420</td>
      <td>2.652392</td>
      <td>0.495006</td>
      <td>-0.735137</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>0.563760</td>
      <td>-2.665048</td>
      <td>0.374515</td>
      <td>-1.103419</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>0.222615</td>
      <td>-1.879033</td>
      <td>2.080305</td>
      <td>-0.161284</td>
    </tr>
  </tbody>
</table>
</div>




```python
df[df>0]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>1.593420</td>
      <td>2.652392</td>
      <td>0.495006</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>0.563760</td>
      <td>NaN</td>
      <td>0.374515</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>NaN</td>
      <td>1.070719</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.551571</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>0.222615</td>
      <td>NaN</td>
      <td>2.080305</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2=df.copy() #make same DataFrame
df2["E"]=["one","one","two","three","four","three"]
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>1.593420</td>
      <td>2.652392</td>
      <td>0.495006</td>
      <td>-0.735137</td>
      <td>one</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>0.563760</td>
      <td>-2.665048</td>
      <td>0.374515</td>
      <td>-1.103419</td>
      <td>one</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-0.282769</td>
      <td>1.070719</td>
      <td>-0.500462</td>
      <td>-0.488685</td>
      <td>two</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>-1.660303</td>
      <td>-0.086918</td>
      <td>0.551571</td>
      <td>-0.261359</td>
      <td>three</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-0.407834</td>
      <td>-0.834828</td>
      <td>-1.809880</td>
      <td>-1.308167</td>
      <td>four</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>0.222615</td>
      <td>-1.879033</td>
      <td>2.080305</td>
      <td>-0.161284</td>
      <td>three</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2[df2["E"].isin(["two","four"])] #isin() method for filtering
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-03</th>
      <td>-0.282769</td>
      <td>1.070719</td>
      <td>-0.500462</td>
      <td>-0.488685</td>
      <td>two</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-0.407834</td>
      <td>-0.834828</td>
      <td>-1.809880</td>
      <td>-1.308167</td>
      <td>four</td>
    </tr>
  </tbody>
</table>
</div>



## Setting 


```python
s1=pd.Series([1,2,3,4,5,6],index=pd.date_range("20130102",periods=6))
s1
```




    2013-01-02    1
    2013-01-03    2
    2013-01-04    3
    2013-01-05    4
    2013-01-06    5
    2013-01-07    6
    Freq: D, dtype: int64




```python
df['F']=s1
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>-1.171673</td>
      <td>-1.282048</td>
      <td>-1.240960</td>
      <td>-1.382591</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>0.747014</td>
      <td>-0.098745</td>
      <td>-2.674977</td>
      <td>-0.766007</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>0.344874</td>
      <td>-1.071516</td>
      <td>0.138593</td>
      <td>0.563455</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>0.032506</td>
      <td>0.100209</td>
      <td>-0.258473</td>
      <td>-1.114725</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>0.141728</td>
      <td>2.327885</td>
      <td>1.172082</td>
      <td>1.085766</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>-1.335232</td>
      <td>-1.043389</td>
      <td>2.569405</td>
      <td>1.850168</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.at[dates[0],"A"]=0
```


```python
df.iat[0,1]=0
```


```python
df.loc[:,"D"]=np.array([5]*len(df))
```


```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.240960</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>0.747014</td>
      <td>-0.098745</td>
      <td>-2.674977</td>
      <td>5</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>0.344874</td>
      <td>-1.071516</td>
      <td>0.138593</td>
      <td>5</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>0.032506</td>
      <td>0.100209</td>
      <td>-0.258473</td>
      <td>5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>0.141728</td>
      <td>2.327885</td>
      <td>1.172082</td>
      <td>5</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>-1.335232</td>
      <td>-1.043389</td>
      <td>2.569405</td>
      <td>5</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2=df.copy()
df2[df2>0] =-df2
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.240960</td>
      <td>-5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>-0.747014</td>
      <td>-0.098745</td>
      <td>-2.674977</td>
      <td>-5</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-0.344874</td>
      <td>-1.071516</td>
      <td>-0.138593</td>
      <td>-5</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>-0.032506</td>
      <td>-0.100209</td>
      <td>-0.258473</td>
      <td>-5</td>
      <td>-3.0</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-0.141728</td>
      <td>-2.327885</td>
      <td>-1.172082</td>
      <td>-5</td>
      <td>-4.0</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>-1.335232</td>
      <td>-1.043389</td>
      <td>-2.569405</td>
      <td>-5</td>
      <td>-5.0</td>
    </tr>
  </tbody>
</table>
</div>



## Missing data 


```python
df1=df.reindex(index=dates[0:4],columns=list(df.columns)+["E"])
df1.loc[dates[0]:dates[1],"E"]=1
df1   #reindexing: to change,add,delete the index on a specified axis
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>F</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.240960</td>
      <td>5</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>0.747014</td>
      <td>-0.098745</td>
      <td>-2.674977</td>
      <td>5</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>0.344874</td>
      <td>-1.071516</td>
      <td>0.138593</td>
      <td>5</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>0.032506</td>
      <td>0.100209</td>
      <td>-0.258473</td>
      <td>5</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1.dropna(how="any") #drop any rows that have missing data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>F</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-02</th>
      <td>0.747014</td>
      <td>-0.098745</td>
      <td>-2.674977</td>
      <td>5</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1.fillna(value=5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>F</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.240960</td>
      <td>5</td>
      <td>5.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>0.747014</td>
      <td>-0.098745</td>
      <td>-2.674977</td>
      <td>5</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>0.344874</td>
      <td>-1.071516</td>
      <td>0.138593</td>
      <td>5</td>
      <td>2.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>0.032506</td>
      <td>0.100209</td>
      <td>-0.258473</td>
      <td>5</td>
      <td>3.0</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.isna(df1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>F</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>



## Operations


```python
df.mean() #stats
```




    A   -0.011518
    B    0.035741
    C   -0.049055
    D    5.000000
    F    3.000000
    dtype: float64




```python
df.mean(1) #axis=1,row
```




    2013-01-01    0.939760
    2013-01-02    0.794659
    2013-01-03    1.282390
    2013-01-04    1.574848
    2013-01-05    2.528339
    2013-01-06    2.038157
    Freq: D, dtype: float64




```python
df.mean(0) #axis=0,columns
```




    A   -0.011518
    B    0.035741
    C   -0.049055
    D    5.000000
    F    3.000000
    dtype: float64




```python
s=pd.Series([1,3,5,np.nan,6,8],index=dates).shift(2) #shft: move forward 2
s
```




    2013-01-01    NaN
    2013-01-02    NaN
    2013-01-03    1.0
    2013-01-04    3.0
    2013-01-05    5.0
    2013-01-06    NaN
    Freq: D, dtype: float64




```python
df.sub(s,axis="index")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-0.655126</td>
      <td>-2.071516</td>
      <td>-0.861407</td>
      <td>4.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>-2.967494</td>
      <td>-2.899791</td>
      <td>-3.258473</td>
      <td>2.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-4.858272</td>
      <td>-2.672115</td>
      <td>-3.827918</td>
      <td>0.0</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.240960</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>0.747014</td>
      <td>-0.098745</td>
      <td>-2.674977</td>
      <td>5</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>0.344874</td>
      <td>-1.071516</td>
      <td>0.138593</td>
      <td>5</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>0.032506</td>
      <td>0.100209</td>
      <td>-0.258473</td>
      <td>5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>0.141728</td>
      <td>2.327885</td>
      <td>1.172082</td>
      <td>5</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>-1.335232</td>
      <td>-1.043389</td>
      <td>2.569405</td>
      <td>5</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.apply(np.cumsum) #cumulative
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.240960</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>0.747014</td>
      <td>-0.098745</td>
      <td>-3.915937</td>
      <td>10</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>1.091887</td>
      <td>-1.170260</td>
      <td>-3.777344</td>
      <td>15</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>1.124393</td>
      <td>-1.070051</td>
      <td>-4.035818</td>
      <td>20</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>1.266121</td>
      <td>1.257834</td>
      <td>-2.863735</td>
      <td>25</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>-0.069110</td>
      <td>0.214444</td>
      <td>-0.294330</td>
      <td>30</td>
      <td>15.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.apply(lambda x: x.max() -x.min()) #apply
```




    A    2.082246
    B    3.399400
    C    5.244382
    D    0.000000
    F    4.000000
    dtype: float64




```python
s=pd.Series(np.random.randint(0,7,size=10)) #histogramming
s
```




    0    5
    1    0
    2    5
    3    5
    4    3
    5    1
    6    4
    7    3
    8    6
    9    3
    dtype: int32




```python
s.value_counts().sort_index() #add sort_index()
```




    0    1
    1    1
    3    3
    4    1
    5    3
    6    1
    dtype: int64



## String Methods 


```python
s=pd.Series(["A","B","C","Aaba","Baca",np.nan,"CABA","dog","cat"])
s.str.lower()
```




    0       a
    1       b
    2       c
    3    aaba
    4    baca
    5     NaN
    6    caba
    7     dog
    8     cat
    dtype: object



## Merge 


```python
df=pd.DataFrame(np.random.randn(10,4)) #concat
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.025866</td>
      <td>-0.178967</td>
      <td>-0.808695</td>
      <td>0.927172</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.842495</td>
      <td>0.707233</td>
      <td>0.222576</td>
      <td>0.455422</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.328742</td>
      <td>-1.270708</td>
      <td>-0.508805</td>
      <td>-0.018087</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.272699</td>
      <td>-1.671005</td>
      <td>-1.107406</td>
      <td>0.243692</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.867842</td>
      <td>0.893841</td>
      <td>-1.515523</td>
      <td>-1.106920</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.588635</td>
      <td>-0.480732</td>
      <td>0.034501</td>
      <td>0.348179</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.270778</td>
      <td>0.133031</td>
      <td>-1.371957</td>
      <td>-2.978966</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.650808</td>
      <td>0.742551</td>
      <td>-2.189231</td>
      <td>-0.465399</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.919177</td>
      <td>1.063680</td>
      <td>-0.075367</td>
      <td>-0.147211</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-0.288339</td>
      <td>-0.125634</td>
      <td>0.758688</td>
      <td>-0.080836</td>
    </tr>
  </tbody>
</table>
</div>




```python
pieces=[df[:3],df[3:7],df[7:]]

pd.concat(pieces)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.025866</td>
      <td>-0.178967</td>
      <td>-0.808695</td>
      <td>0.927172</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.842495</td>
      <td>0.707233</td>
      <td>0.222576</td>
      <td>0.455422</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.328742</td>
      <td>-1.270708</td>
      <td>-0.508805</td>
      <td>-0.018087</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.272699</td>
      <td>-1.671005</td>
      <td>-1.107406</td>
      <td>0.243692</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.867842</td>
      <td>0.893841</td>
      <td>-1.515523</td>
      <td>-1.106920</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-0.588635</td>
      <td>-0.480732</td>
      <td>0.034501</td>
      <td>0.348179</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.270778</td>
      <td>0.133031</td>
      <td>-1.371957</td>
      <td>-2.978966</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.650808</td>
      <td>0.742551</td>
      <td>-2.189231</td>
      <td>-0.465399</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.919177</td>
      <td>1.063680</td>
      <td>-0.075367</td>
      <td>-0.147211</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-0.288339</td>
      <td>-0.125634</td>
      <td>0.758688</td>
      <td>-0.080836</td>
    </tr>
  </tbody>
</table>
</div>




```python
left=pd.DataFrame({"key": ["foo","foo"],"lval":[1,2]})
right=pd.DataFrame({"key": ["foo","foo"],"rval":[4,5]})
print(left)
print(right)
```

       key  lval
    0  foo     1
    1  foo     2
       key  rval
    0  foo     4
    1  foo     5
    


```python
pd.merge(left,right,on="key") #SQL style merge
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>lval</th>
      <th>rval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>foo</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>foo</td>
      <td>2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>




```python
left=pd.DataFrame({"key": ["foo","bar"],"lval":[1,2]})
right=pd.DataFrame({"key": ["foo","bar"],"rval":[4,5]})
print(left)
print(right)
```

       key  lval
    0  foo     1
    1  bar     2
       key  rval
    0  foo     4
    1  bar     5
    


```python
pd.merge(left,right, on="key")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>lval</th>
      <th>rval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bar</td>
      <td>2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>



## Grouping


```python
df=pd.DataFrame({"A":["foo","bar","foo","bar","foo","bar","foo","foo"],
                "B":["one","one","two","three","two","two","one","three"],
                "C": np.random.randn(8),
                "D": np.random.randn(8)
                }
               )
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>foo</td>
      <td>one</td>
      <td>1.048840</td>
      <td>-0.833822</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bar</td>
      <td>one</td>
      <td>-1.137147</td>
      <td>-2.027540</td>
    </tr>
    <tr>
      <th>2</th>
      <td>foo</td>
      <td>two</td>
      <td>-0.657997</td>
      <td>0.608757</td>
    </tr>
    <tr>
      <th>3</th>
      <td>bar</td>
      <td>three</td>
      <td>-0.413567</td>
      <td>-0.753453</td>
    </tr>
    <tr>
      <th>4</th>
      <td>foo</td>
      <td>two</td>
      <td>-0.454805</td>
      <td>-1.496538</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bar</td>
      <td>two</td>
      <td>0.493420</td>
      <td>-0.384181</td>
    </tr>
    <tr>
      <th>6</th>
      <td>foo</td>
      <td>one</td>
      <td>-0.561297</td>
      <td>1.679049</td>
    </tr>
    <tr>
      <th>7</th>
      <td>foo</td>
      <td>three</td>
      <td>1.841777</td>
      <td>0.482405</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.groupby("A").sum()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
    <tr>
      <th>A</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bar</th>
      <td>-1.057294</td>
      <td>-3.165174</td>
    </tr>
    <tr>
      <th>foo</th>
      <td>1.216518</td>
      <td>0.439850</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.groupby(["A","B"]).sum()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
    <tr>
      <th>A</th>
      <th>B</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">bar</th>
      <th>one</th>
      <td>-1.137147</td>
      <td>-2.027540</td>
    </tr>
    <tr>
      <th>three</th>
      <td>-0.413567</td>
      <td>-0.753453</td>
    </tr>
    <tr>
      <th>two</th>
      <td>0.493420</td>
      <td>-0.384181</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">foo</th>
      <th>one</th>
      <td>0.487543</td>
      <td>0.845226</td>
    </tr>
    <tr>
      <th>three</th>
      <td>1.841777</td>
      <td>0.482405</td>
    </tr>
    <tr>
      <th>two</th>
      <td>-1.112803</td>
      <td>-0.887780</td>
    </tr>
  </tbody>
</table>
</div>



## Reshaping


```python
tuples = list(
        zip(
            *[
              ["bar", "bar", "baz", "baz", "foo", "foo", "qux", "qux"],
              ["one", "two", "one", "two", "one", "two", "one", "two"],
          ]
       )
   )
index= pd.MultiIndex.from_tuples(tuples,names=["first","second"])
df=pd.DataFrame(np.random.randn(8,2),index=index,columns=["A","B"])
df2=df[:4]
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
    <tr>
      <th>first</th>
      <th>second</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">bar</th>
      <th>one</th>
      <td>0.890952</td>
      <td>-0.375587</td>
    </tr>
    <tr>
      <th>two</th>
      <td>1.001416</td>
      <td>-1.333297</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">baz</th>
      <th>one</th>
      <td>-0.562930</td>
      <td>-0.951540</td>
    </tr>
    <tr>
      <th>two</th>
      <td>0.273894</td>
      <td>-0.832586</td>
    </tr>
  </tbody>
</table>
</div>




```python
stacked=df2.stack()
stacked  #compresse a level in DataFrame's columns

```




    first  second   
    bar    one     A    0.890952
                   B   -0.375587
           two     A    1.001416
                   B   -1.333297
    baz    one     A   -0.562930
                   B   -0.951540
           two     A    0.273894
                   B   -0.832586
    dtype: float64




```python
stacked.unstack() # inverse operation of stack()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
    <tr>
      <th>first</th>
      <th>second</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">bar</th>
      <th>one</th>
      <td>0.890952</td>
      <td>-0.375587</td>
    </tr>
    <tr>
      <th>two</th>
      <td>1.001416</td>
      <td>-1.333297</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">baz</th>
      <th>one</th>
      <td>-0.562930</td>
      <td>-0.951540</td>
    </tr>
    <tr>
      <th>two</th>
      <td>0.273894</td>
      <td>-0.832586</td>
    </tr>
  </tbody>
</table>
</div>




```python
print(stacked.unstack(0))
print(stacked.unstack(1))
```

    first          bar       baz
    second                      
    one    A  0.890952 -0.562930
           B -0.375587 -0.951540
    two    A  1.001416  0.273894
           B -1.333297 -0.832586
    second        one       two
    first                      
    bar   A  0.890952  1.001416
          B -0.375587 -1.333297
    baz   A -0.562930  0.273894
          B -0.951540 -0.832586
    

## Pivot tables 


```python
df=pd.DataFrame({
    "A": ["one", "one", "two", "three"] * 3,
    "B": ["A", "B", "C"] * 4,
    "C": ["foo", "foo", "foo", "bar", "bar", "bar"] * 2,
    "D": np.random.randn(12),
    "E": np.random.randn(12),
}                
)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one</td>
      <td>A</td>
      <td>foo</td>
      <td>-0.373453</td>
      <td>-1.406135</td>
    </tr>
    <tr>
      <th>1</th>
      <td>one</td>
      <td>B</td>
      <td>foo</td>
      <td>1.264894</td>
      <td>-1.389622</td>
    </tr>
    <tr>
      <th>2</th>
      <td>two</td>
      <td>C</td>
      <td>foo</td>
      <td>-0.242048</td>
      <td>-1.593581</td>
    </tr>
    <tr>
      <th>3</th>
      <td>three</td>
      <td>A</td>
      <td>bar</td>
      <td>2.716601</td>
      <td>1.612520</td>
    </tr>
    <tr>
      <th>4</th>
      <td>one</td>
      <td>B</td>
      <td>bar</td>
      <td>-1.528681</td>
      <td>0.602288</td>
    </tr>
    <tr>
      <th>5</th>
      <td>one</td>
      <td>C</td>
      <td>bar</td>
      <td>-0.074750</td>
      <td>2.044902</td>
    </tr>
    <tr>
      <th>6</th>
      <td>two</td>
      <td>A</td>
      <td>foo</td>
      <td>0.110851</td>
      <td>-0.740685</td>
    </tr>
    <tr>
      <th>7</th>
      <td>three</td>
      <td>B</td>
      <td>foo</td>
      <td>-0.915239</td>
      <td>0.589600</td>
    </tr>
    <tr>
      <th>8</th>
      <td>one</td>
      <td>C</td>
      <td>foo</td>
      <td>0.377855</td>
      <td>-0.094179</td>
    </tr>
    <tr>
      <th>9</th>
      <td>one</td>
      <td>A</td>
      <td>bar</td>
      <td>-0.965858</td>
      <td>-1.770097</td>
    </tr>
    <tr>
      <th>10</th>
      <td>two</td>
      <td>B</td>
      <td>bar</td>
      <td>-0.943708</td>
      <td>0.623095</td>
    </tr>
    <tr>
      <th>11</th>
      <td>three</td>
      <td>C</td>
      <td>bar</td>
      <td>-0.096407</td>
      <td>-0.637673</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.pivot_table(df,values="D",index=["A","B"],columns=["C"])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>bar</th>
      <th>foo</th>
    </tr>
    <tr>
      <th>A</th>
      <th>B</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">one</th>
      <th>A</th>
      <td>-0.965858</td>
      <td>-0.373453</td>
    </tr>
    <tr>
      <th>B</th>
      <td>-1.528681</td>
      <td>1.264894</td>
    </tr>
    <tr>
      <th>C</th>
      <td>-0.074750</td>
      <td>0.377855</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">three</th>
      <th>A</th>
      <td>2.716601</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>B</th>
      <td>NaN</td>
      <td>-0.915239</td>
    </tr>
    <tr>
      <th>C</th>
      <td>-0.096407</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">two</th>
      <th>A</th>
      <td>NaN</td>
      <td>0.110851</td>
    </tr>
    <tr>
      <th>B</th>
      <td>-0.943708</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>C</th>
      <td>NaN</td>
      <td>-0.242048</td>
    </tr>
  </tbody>
</table>
</div>



## Time series


```python
rng = pd.date_range("1/1/2012", periods=100, freq="S")
ts = pd.Series(np.random.randint(0, 500, len(rng)), index=rng)
ts.resample("5Min").sum() #sum every 5 mins
```




    2012-01-01    26705
    Freq: 5T, dtype: int32




```python
ts.resample("1Min").sum() #sum every 1 min
```




    2012-01-01 00:00:00    15006
    2012-01-01 00:01:00    11699
    Freq: T, dtype: int32




```python
rng = pd.date_range("3/6/2012 00:00", periods=5, freq="D")
ts = pd.Series(np.random.randn(len(rng)), rng)
ts
```




    2012-03-06    1.385727
    2012-03-07   -1.201650
    2012-03-08   -0.135337
    2012-03-09   -0.287460
    2012-03-10    0.454925
    Freq: D, dtype: float64




```python
ts_utc = ts.tz_localize("UTC")
ts_utc
```




    2012-03-06 00:00:00+00:00    1.385727
    2012-03-07 00:00:00+00:00   -1.201650
    2012-03-08 00:00:00+00:00   -0.135337
    2012-03-09 00:00:00+00:00   -0.287460
    2012-03-10 00:00:00+00:00    0.454925
    Freq: D, dtype: float64




```python
ts_utc.tz_convert("US/Eastern") #covertion to another time zone
```




    2012-03-05 19:00:00-05:00    1.385727
    2012-03-06 19:00:00-05:00   -1.201650
    2012-03-07 19:00:00-05:00   -0.135337
    2012-03-08 19:00:00-05:00   -0.287460
    2012-03-09 19:00:00-05:00    0.454925
    Freq: D, dtype: float64




```python
rng = pd.date_range("1/1/2012", periods=5, freq="M")
ts = pd.Series(np.random.randn(len(rng)), index=rng)
ts
```




    2012-01-31    0.252942
    2012-02-29   -0.028175
    2012-03-31   -0.639577
    2012-04-30   -2.170122
    2012-05-31    0.290485
    Freq: M, dtype: float64




```python
ps=ts.to_period()
ps
```




    2012-01    0.252942
    2012-02   -0.028175
    2012-03   -0.639577
    2012-04   -2.170122
    2012-05    0.290485
    Freq: M, dtype: float64




```python
ps.to_timestamp()
```




    2012-01-01    0.252942
    2012-02-01   -0.028175
    2012-03-01   -0.639577
    2012-04-01   -2.170122
    2012-05-01    0.290485
    Freq: MS, dtype: float64




```python
prng = pd.period_range("1990Q1", "2000Q4", freq="Q-NOV")
ts = pd.Series(np.random.randn(len(prng)), prng)
ts.index = (prng.asfreq("M", "e") + 1).asfreq("H", "s") + 9
ts.head()
```




    1990-03-01 09:00    0.747117
    1990-06-01 09:00    1.203087
    1990-09-01 09:00   -0.941095
    1990-12-01 09:00   -0.126587
    1991-03-01 09:00   -1.061227
    Freq: H, dtype: float64



## Categoricals 


```python
df = pd.DataFrame(
         {"id": [1, 2, 3, 4, 5, 6], "raw_grade": ["a", "b", "b", "a", "a", "e"]} 
)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>raw_grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>b</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>b</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>a</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>a</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>e</td>
    </tr>
  </tbody>
</table>
</div>




```python
df["grade"] = df["raw_grade"].astype("category")
df["grade"]
```




    0    a
    1    b
    2    b
    3    a
    4    a
    5    e
    Name: grade, dtype: category
    Categories (3, object): ['a', 'b', 'e']




```python
df["grade"]=df["grade"].cat.set_categories(["very good", "good", "very bad"])
df["grade"] #rename the categories
```




    0    NaN
    1    NaN
    2    NaN
    3    NaN
    4    NaN
    5    NaN
    Name: grade, dtype: category
    Categories (3, object): ['very good', 'good', 'very bad']




```python
df.sort_values(by="grade")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>raw_grade</th>
      <th>grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>a</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>b</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>b</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>a</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>a</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>e</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.groupby("grade").size()
```




    grade
    very good    0
    good         0
    very bad     0
    dtype: int64



## Plotting 


```python
import matplotlib.pyplot as plt
plt.close("all") #close a figure window
```


```python
ts = pd.Series(np.random.randn(1000), index=pd.date_range("1/1/2000", periods=1000))
ts = ts.cumsum()
ts.plot();
```


    
![output_102_0](https://user-images.githubusercontent.com/88040158/132443016-7bfdb61b-d38b-43cd-8d01-601086ce8372.png)
    



```python
df=pd.DataFrame(
                np.random.randn(1000, 4), index=ts.index, columns=["A", "B", "C", "D"]
)
```


```python
df=df.cumsum()
```


```python
plt.figure();
```


    <Figure size 432x288 with 0 Axes>



```python
df.plot();
plt.legend(loc='best');
```


![output_106_0](https://user-images.githubusercontent.com/88040158/132443125-8eb84776-15c6-47ad-a8f5-ac14998a8801.png)
    


## Getting data in/out (csv)


```python
df.to_csv("foo.csv") #writing to c csv file
```


```python
pd.read_csv("foo.csv") #reading from a csv file
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000-01-01</td>
      <td>1.783768</td>
      <td>2.045073</td>
      <td>-0.507718</td>
      <td>1.123060</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000-01-02</td>
      <td>0.196039</td>
      <td>2.711749</td>
      <td>0.416838</td>
      <td>1.080363</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000-01-03</td>
      <td>1.208280</td>
      <td>1.600025</td>
      <td>0.633446</td>
      <td>1.539429</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000-01-04</td>
      <td>2.404634</td>
      <td>3.237997</td>
      <td>0.450288</td>
      <td>0.621748</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000-01-05</td>
      <td>1.188598</td>
      <td>3.202251</td>
      <td>1.098251</td>
      <td>1.717754</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>2002-09-22</td>
      <td>-9.342127</td>
      <td>24.392143</td>
      <td>10.564637</td>
      <td>-10.164637</td>
    </tr>
    <tr>
      <th>996</th>
      <td>2002-09-23</td>
      <td>-8.419079</td>
      <td>26.097426</td>
      <td>8.878737</td>
      <td>-9.608197</td>
    </tr>
    <tr>
      <th>997</th>
      <td>2002-09-24</td>
      <td>-7.336001</td>
      <td>25.781776</td>
      <td>10.905896</td>
      <td>-10.742856</td>
    </tr>
    <tr>
      <th>998</th>
      <td>2002-09-25</td>
      <td>-7.736148</td>
      <td>25.178845</td>
      <td>11.460886</td>
      <td>-10.487685</td>
    </tr>
    <tr>
      <th>999</th>
      <td>2002-09-26</td>
      <td>-6.694487</td>
      <td>24.414987</td>
      <td>12.606476</td>
      <td>-9.257457</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 5 columns</p>
</div>



## HDF5


```python
df.to_hdf("foo.h5", "df")
```


    ---------------------------------------------------------------------------

    ImportError                               Traceback (most recent call last)

    ~\AppData\Local\Temp/ipykernel_12628/992960660.py in <module>
    ----> 1 df.to_hdf("foo.h5", "df")
    

    ~\miniconda3\envs\cal2020\lib\site-packages\pandas\core\generic.py in to_hdf(self, path_or_buf, key, mode, complevel, complib, append, format, index, min_itemsize, nan_rep, dropna, data_columns, errors, encoding)
       2716             data_columns=data_columns,
       2717             errors=errors,
    -> 2718             encoding=encoding,
       2719         )
       2720 
    

    ~\miniconda3\envs\cal2020\lib\site-packages\pandas\io\pytables.py in to_hdf(path_or_buf, key, value, mode, complevel, complib, append, format, index, min_itemsize, nan_rep, dropna, data_columns, errors, encoding)
        310     if isinstance(path_or_buf, str):
        311         with HDFStore(
    --> 312             path_or_buf, mode=mode, complevel=complevel, complib=complib
        313         ) as store:
        314             f(store)
    

    ~\miniconda3\envs\cal2020\lib\site-packages\pandas\io\pytables.py in __init__(self, path, mode, complevel, complib, fletcher32, **kwargs)
        570             raise ValueError("format is not a defined argument for HDFStore")
        571 
    --> 572         tables = import_optional_dependency("tables")
        573 
        574         if complib is not None and complib not in tables.filters.all_complibs:
    

    ~\miniconda3\envs\cal2020\lib\site-packages\pandas\compat\_optional.py in import_optional_dependency(name, extra, errors, min_version)
        116     except ImportError:
        117         if errors == "raise":
    --> 118             raise ImportError(msg) from None
        119         else:
        120             return None
    

    ImportError: Missing optional dependency 'tables'.  Use pip or conda to install tables.



```python
pd.read_hdf("foo.h5", "df")
```

## Excel


```python
df.to_excel("foo.xlsx", sheet_name="Sheet1")
```


```python
pd.read_excel("foo.xlsx", "Sheet1", index_col=None, na_values=["NA"])
```

## Gotchas 


```python
if pd.Series([False, True, False]):
    print("I was True")
```


    ---------------------------------------------------------------------------

    ValueError                                Traceback (most recent call last)

    ~\AppData\Local\Temp/ipykernel_12628/2697453150.py in <module>
    ----> 1 if pd.Series([False, True, False]):
          2     print("I was True")
    

    ~\miniconda3\envs\cal2020\lib\site-packages\pandas\core\generic.py in __nonzero__(self)
       1536     def __nonzero__(self):
       1537         raise ValueError(
    -> 1538             f"The truth value of a {type(self).__name__} is ambiguous. "
       1539             "Use a.empty, a.bool(), a.item(), a.any() or a.all()."
       1540         )
    

    ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().



```python
if pd.Series([False, True, False]) is not None:
    print("I was True")
```

    I was True
    


```python
if pd.Series([False, False, False]) is not None:
    print("I was True")  ##None is not definition
```

    I was True
    

### Reference: https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html 
